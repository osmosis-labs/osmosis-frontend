(self.webpackChunk_keplr_wallet_extension=self.webpackChunk_keplr_wallet_extension||[]).push([[132],{78822:(e,t)=>{"use strict";t.Ar=t.yM=void 0,t.yM=class{logEvent(){}setUserId(){}setUserProperties(){}},t.Ar=class{constructor(e,t={}){this.analyticsClient=e,this.middleware=t}setUserId(e){this.analyticsClient.setUserId(e)}setUserProperties(e){this.analyticsClient.setUserProperties(e)}logEvent(e,t){if(this.middleware.logEvent){const i=this.middleware.logEvent(e,t);e=i.eventName,t=i.eventProperties}this.analyticsClient.logEvent(e,t)}}},75219:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEPLR_EXT_ANALYTICS_API_AUTH_TOKEN=t.KEPLR_EXT_ANALYTICS_API_URL=t.ROUTE=void 0,t.ROUTE="analytics",t.KEPLR_EXT_ANALYTICS_API_URL="https://analytics.keplr.app",t.KEPLR_EXT_ANALYTICS_API_AUTH_TOKEN="D7THUjkEo3f_u!3eBfi"},4143:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(81872);t.getHandler=e=>(t,i)=>{switch(i.constructor){case r.GetAnalyticsIdMsg:return n(e)(t,i);case r.SetDisableAnalyticsMsg:return s(e)(t,i);case r.LogAnalyticsEventMsg:return o(e)(t,i);default:throw new Error("Unknown msg type")}};const n=e=>(t,i)=>e.getAnalyticsIdOnlyIfPrivileged(t,i.origin),s=e=>(t,i)=>e.setDisabled(i.disabled),o=e=>(t,i)=>e.logEventIgnoreError(i.event,i.params)},68520:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(89704),t),n(i(81872),t)},29333:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(81872),n=i(75219),s=i(4143);t.init=function(e,t){e.registerMessage(r.GetAnalyticsIdMsg),e.registerMessage(r.SetDisableAnalyticsMsg),e.registerMessage(r.LogAnalyticsEventMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},81237:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(89704),t),n(i(29333),t)},81872:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogAnalyticsEventMsg=t.SetDisableAnalyticsMsg=t.GetAnalyticsIdMsg=void 0;const r=i(47235),n=i(75219);class s extends r.Message{static type(){return"get-analytics-id"}constructor(){super()}validateBasic(){}approveExternal(){return!0}route(){return n.ROUTE}type(){return s.type()}}t.GetAnalyticsIdMsg=s;class o extends r.Message{static type(){return"set-disable-analytics"}constructor(e){super(),this.disabled=e}validateBasic(){}route(){return n.ROUTE}type(){return o.type()}}t.SetDisableAnalyticsMsg=o;class a extends r.Message{static type(){return"log-analytics-event"}constructor(e,t){super(),this.event=e,this.params=t}validateBasic(){if(!this.event)throw new Error("Empty event")}route(){return n.ROUTE}type(){return a.type()}}t.LogAnalyticsEventMsg=a},89704:function(e,t,i){"use strict";var r=i(48834).Buffer,n=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsService=void 0;const o=i(75219),a=i(96618),c=i(80075);class u{constructor(e,t){this.kvStore=e,this.privilegedOrigins=t,this.analyticsId="",this.disabled=!1,(0,c.makeObservable)(this)}init(){return s(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("analyticsDisabled");(0,c.runInAction)((()=>{this.disabled=!!e})),(0,c.autorun)((()=>{this.kvStore.set("analyticsDisabled",this.disabled)}));const t=yield this.kvStore.get("analyticsId");if(t)return void(this.analyticsId=t);const i=new Uint8Array(20);crypto.getRandomValues(i);const r=Array.from(i).map((e=>{let t=e.toString(16);return 1===t.length&&(t="0"+t),t})).join("");this.analyticsId=r,yield this.kvStore.set("analyticsId",r)}))}getAnalyticsIdOnlyIfPrivileged(e,t){if(!e.isInternalMsg&&!this.privilegedOrigins.includes(t))throw new Error("Rejected");return this.analyticsId}logEvent(e,t){return s(this,void 0,void 0,(function*(){if(!o.KEPLR_EXT_ANALYTICS_API_URL||!o.KEPLR_EXT_ANALYTICS_API_AUTH_TOKEN)return;if("function"==typeof browser.runtime.getBrowserInfo&&"Firefox"===(yield browser.runtime.getBrowserInfo()).name)return;if(this.disabled)return;const i=r.from(JSON.stringify(Object.assign(Object.assign({},t),{event:e,analyticsId:this.analyticsId,v2:!0}))).toString("base64");yield(0,a.simpleFetch)(o.KEPLR_EXT_ANALYTICS_API_URL,`/log?msg=${encodeURIComponent(i)}`,{headers:{Authorization:o.KEPLR_EXT_ANALYTICS_API_AUTH_TOKEN}})}))}logEventIgnoreError(e,t){this.logEvent(e,t).catch((e=>console.log(e)))}setDisabled(e){return this.disabled=e,this.disabled}}n([c.observable],u.prototype,"disabled",void 0),n([c.action],u.prototype,"setDisabled",null),t.AnalyticsService=u},8418:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="auto-lock-account"},63802:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(47235),n=i(17602);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.GetAutoLockAccountDurationMsg:return s(e)(t,i);case n.UpdateAutoLockAccountDurationMsg:return o(e)(t,i);case n.StartAutoLockMonitoringMsg:return a(e)(t,i);case n.GetLockOnSleepMsg:return c(e)(t,i);case n.SetLockOnSleepMsg:return u(e)(t,i);case n.GetAutoLockStateMsg:return d(e)(t,i);default:throw new r.KeplrError("auto-lock-account",100,"Unknown msg type")}};const s=e=>()=>e.getAutoLockDuration(),o=e=>(t,i)=>{if(!e.keyRingIsUnlocked)throw new Error("Keyring is not unlocked");return e.setDuration(i.duration)},a=e=>()=>e.startAppStateCheckTimer(),c=e=>()=>e.getLockOnSleep(),u=e=>(t,i)=>e.setLockOnSleep(i.lockOnSleep),d=e=>()=>({duration:e.getAutoLockDuration(),lockOnSleep:e.getLockOnSleep()})},81030:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(39085),t),n(i(17602),t)},82382:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(17602),n=i(8418),s=i(63802);t.init=function(e,t){e.registerMessage(r.GetAutoLockAccountDurationMsg),e.registerMessage(r.UpdateAutoLockAccountDurationMsg),e.registerMessage(r.StartAutoLockMonitoringMsg),e.registerMessage(r.GetLockOnSleepMsg),e.registerMessage(r.SetLockOnSleepMsg),e.registerMessage(r.GetAutoLockStateMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},56509:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(39085),t),n(i(82382),t)},17602:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetAutoLockStateMsg=t.SetLockOnSleepMsg=t.GetLockOnSleepMsg=t.StartAutoLockMonitoringMsg=t.UpdateAutoLockAccountDurationMsg=t.GetAutoLockAccountDurationMsg=void 0;const r=i(47235),n=i(8418);class s extends r.Message{static type(){return"get-auto-lock-account-duration"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.GetAutoLockAccountDurationMsg=s;class o extends r.Message{static type(){return"update-auto-lock-account-duration"}constructor(e){super(),this.duration=e}validateBasic(){if(this.duration<0)throw new r.KeplrError("auto-lock-account",101,"duration cannot be set to a negative number.")}route(){return n.ROUTE}type(){return o.type()}}t.UpdateAutoLockAccountDurationMsg=o;class a extends r.Message{static type(){return"start-auto-lock-monitoring"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return a.type()}}t.StartAutoLockMonitoringMsg=a;class c extends r.Message{static type(){return"get-lock-on-sleep"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return c.type()}}t.GetLockOnSleepMsg=c;class u extends r.Message{static type(){return"set-lock-on-sleep"}constructor(e){super(),this.lockOnSleep=e}validateBasic(){}route(){return n.ROUTE}type(){return u.type()}}t.SetLockOnSleepMsg=u;class d extends r.Message{static type(){return"get-auto-lock-state"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return d.type()}}t.GetAutoLockStateMsg=d},39085:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoLockAccountService=void 0;const s=i(80075);class o{constructor(e,t){this.kvStore=e,this.keyRingService=t,this.autoLockDuration=0,this.lockOnSleep=!1,this.autoLockTimer=null,(0,s.makeObservable)(this)}init(){return n(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("autoLockDuration");(0,s.runInAction)((()=>{null==e||Number.isNaN(e)?this.autoLockDuration=0:this.autoLockDuration=e})),(0,s.autorun)((()=>{this.kvStore.set("autoLockDuration",this.autoLockDuration)}));const t=yield this.kvStore.get("lockOnSleep");(0,s.runInAction)((()=>{this.lockOnSleep=!!t})),(0,s.autorun)((()=>{this.kvStore.set("lockOnSleep",this.lockOnSleep)})),browser.idle.onStateChanged.addListener((e=>{this.stateChangedHandler(e)}))}))}stateChangedHandler(e){"locked"===e&&(this.autoLockDuration>0?(this.stopAutoLockTimer(),this.lock()):this.lockOnSleep&&this.lock())}startAppStateCheckTimer(){this.stopAutoLockTimer(),this.startAutoLockTimer()}startAutoLockTimer(){if(!this.keyRingIsUnlocked)throw new Error("Keyring is not unlocked");this.autoLockDuration<=0||(this.autoLockTimer=setTimeout((()=>{this.stopAutoLockTimer(),this.lock()}),this.autoLockDuration))}stopAutoLockTimer(){null!=this.autoLockTimer&&(clearTimeout(this.autoLockTimer),this.autoLockTimer=null)}lock(){this.keyRingIsUnlocked&&this.keyRingService.lockKeyRing()}get keyRingIsUnlocked(){return"unlocked"===this.keyRingService.keyRingStatus}getAutoLockDuration(){return this.autoLockDuration}setDuration(e){this.autoLockDuration=e,e<=0&&this.stopAutoLockTimer()}getLockOnSleep(){return this.lockOnSleep}setLockOnSleep(e){this.lockOnSleep=e}}r([s.observable],o.prototype,"autoLockDuration",void 0),r([s.observable],o.prototype,"lockOnSleep",void 0),r([s.action],o.prototype,"setDuration",null),r([s.action],o.prototype,"setLockOnSleep",null),t.AutoLockAccountService=o},30820:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="chains-ui"},36796:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(47235),n=i(67315);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.GetEnabledChainIdentifiersMsg:return s(e)(t,i);case n.ToggleChainsMsg:return o(e)(t,i);case n.EnableChainsMsg:return a(e)(t,i);case n.DisableChainsMsg:return c(e)(t,i);case n.GetVaultsByEnabledChainMsg:return u(e)(t,i);default:throw new r.KeplrError("chains",110,"Unknown msg type")}};const s=e=>(t,i)=>e.enabledChainIdentifiersForVault(i.vaultId),o=e=>(t,i)=>(e.toggleChain(i.vaultId,...i.chainIds),e.enabledChainIdentifiersForVault(i.vaultId)),a=e=>(t,i)=>(e.enableChain(i.vaultId,...i.chainIds),e.enabledChainIdentifiersForVault(i.vaultId)),c=e=>(t,i)=>(e.disableChain(i.vaultId,...i.chainIds),e.enabledChainIdentifiersForVault(i.vaultId)),u=e=>(t,i)=>e.getVaultsByEnabledChain(i.chainId)},77052:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(17413),t),n(i(67315),t)},61287:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(67315),n=i(30820),s=i(36796);t.init=function(e,t){e.registerMessage(r.GetEnabledChainIdentifiersMsg),e.registerMessage(r.ToggleChainsMsg),e.registerMessage(r.EnableChainsMsg),e.registerMessage(r.DisableChainsMsg),e.registerMessage(r.GetVaultsByEnabledChainMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},37329:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(17413),t),n(i(61287),t)},67315:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetVaultsByEnabledChainMsg=t.DisableChainsMsg=t.EnableChainsMsg=t.ToggleChainsMsg=t.GetEnabledChainIdentifiersMsg=void 0;const r=i(47235),n=i(30820);class s extends r.Message{static type(){return"get-enabled-chain-identifiers"}constructor(e){super(),this.vaultId=e}validateBasic(){if(!this.vaultId)throw new Error("vaultId is not set")}route(){return n.ROUTE}type(){return s.type()}}t.GetEnabledChainIdentifiersMsg=s;class o extends r.Message{static type(){return"chains-ui-toggle-chains"}constructor(e,t){super(),this.vaultId=e,this.chainIds=t}validateBasic(){if(!this.vaultId)throw new Error("vaultId is not set");if(!this.chainIds||0===this.chainIds.length)throw new Error("chainIds are not set");const e=new Map;for(const t of this.chainIds){if(e.get(t))throw new Error(`chainId ${t} is duplicated`);e.set(t,!0)}}route(){return n.ROUTE}type(){return o.type()}}t.ToggleChainsMsg=o;class a extends r.Message{static type(){return"chains-ui-enable-chains"}constructor(e,t){super(),this.vaultId=e,this.chainIds=t}validateBasic(){if(!this.vaultId)throw new Error("vaultId is not set");if(!this.chainIds||0===this.chainIds.length)throw new Error("chainIds are not set");const e=new Map;for(const t of this.chainIds){if(e.get(t))throw new Error(`chainId ${t} is duplicated`);e.set(t,!0)}}route(){return n.ROUTE}type(){return a.type()}}t.EnableChainsMsg=a;class c extends r.Message{static type(){return"chains-ui-disable-chains"}constructor(e,t){super(),this.vaultId=e,this.chainIds=t}validateBasic(){if(!this.vaultId)throw new Error("vaultId is not set");if(!this.chainIds||0===this.chainIds.length)throw new Error("chainIds are not set");const e=new Map;for(const t of this.chainIds){if(e.get(t))throw new Error(`chainId ${t} is duplicated`);e.set(t,!0)}}route(){return n.ROUTE}type(){return c.type()}}t.DisableChainsMsg=c;class u extends r.Message{static type(){return"chains-ui-get-vaults-by-enabled-chain"}constructor(e){super(),this.chainId=e}validateBasic(){if(!this.chainId)throw new Error("chainId is not set")}route(){return n.ROUTE}type(){return u.type()}}t.GetVaultsByEnabledChainMsg=u},17413:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChainsUIService=void 0;const s=i(80075),o=i(75263),a=i(58242);class c{constructor(e,t,i){this.kvStore=e,this.chainsService=t,this.vaultService=i,this.enabledChainIdentifiersMap=new Map,this.onChainUIEnabledChangedHandlers=[],this.enabledChainIdentifiersForVault=(0,a.computedFn)((e=>{var t;const i=(null!==(t=this.enabledChainIdentifiersMap.get(e))&&void 0!==t?t:[]).filter((e=>this.chainsService.hasChainInfo(e)));return 0===i.length?[o.ChainIdHelper.parse(this.chainsService.getChainInfos()[0].chainId).identifier]:i}),{keepAlive:!0}),this.enabledChainIdentifierMapForVault=(0,a.computedFn)((e=>{const t=this.enabledChainIdentifiersForVault(e),i=new Map;for(const e of t)i.set(e,!0);return i}),{keepAlive:!0}),this.isEnabled=(0,a.computedFn)(((e,t)=>{const i=o.ChainIdHelper.parse(t).identifier;return!0===this.enabledChainIdentifierMapForVault(e).get(i)}),{keepAlive:!0}),this.getVaultsByEnabledChain=(0,a.computedFn)((e=>{const t=o.ChainIdHelper.parse(e).identifier,i=this.enabledChainIdentifiersMap.keys(),r=[];for(const e of i)this.enabledChainIdentifierMapForVault(e).get(t)&&r.push(e);return r}),{keepAlive:!0}),this.onChainRemoved=e=>{(0,s.runInAction)((()=>{const t=o.ChainIdHelper.parse(e.chainId).identifier,i=this.enabledChainIdentifiersMap.keys();for(const e of i)if(this.enabledChainIdentifierMapForVault(e).get(t)){const i=this.enabledChainIdentifiersForVault(e).slice(),r=i.findIndex((e=>e===t));r>=0&&i.splice(r,1),this.enabledChainIdentifiersMap.set(e,i)}}))},this.onVaultRemoved=(e,t)=>{(0,s.runInAction)((()=>{"keyRing"===e&&this.enabledChainIdentifiersMap.delete(t)}))},(0,s.makeObservable)(this)}init(){return n(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("enabledChainIdentifiesMap");e&&(0,s.runInAction)((()=>{for(const[t,i]of Object.entries(e))this.enabledChainIdentifiersMap.set(t,i)})),(0,s.autorun)((()=>{const e=(0,s.toJS)(this.enabledChainIdentifiersMap),t=Object.fromEntries(e);this.kvStore.set("enabledChainIdentifiesMap",t)})),this.chainsService.addChainRemovedHandler(this.onChainRemoved),this.vaultService.addVaultRemovedHandler(this.onVaultRemoved)}))}toggleChain(e,...t){if(!this.vaultService.getVault("keyRing",e))throw new Error("Vault is null");const i=(t=Array.from(new Set([...t]))).map((e=>o.ChainIdHelper.parse(e).identifier)).filter((e=>this.chainsService.hasChainInfo(e))),r=this.enabledChainIdentifierMapForVault(e);for(const t of i)r.get(t)?this.disableChain(e,t):this.enableChain(e,t)}enableChain(e,...t){if(!this.vaultService.getVault("keyRing",e))throw new Error("Vault is null");const i=(t=Array.from(new Set([...t]))).map((e=>o.ChainIdHelper.parse(e).identifier)).filter((e=>this.chainsService.hasChainInfo(e))),r=this.enabledChainIdentifiersForVault(e).slice(),n=this.enabledChainIdentifierMapForVault(e);for(const e of i)n.get(e)||r.push(e);this.enabledChainIdentifiersMap.set(e,r);for(const t of this.onChainUIEnabledChangedHandlers)t(e,this.enabledChainIdentifiersForVault(e))}disableChain(e,...t){if(!this.vaultService.getVault("keyRing",e))throw new Error("Vault is null");const i=(t=Array.from(new Set([...t]))).map((e=>o.ChainIdHelper.parse(e).identifier)).filter((e=>this.chainsService.hasChainInfo(e))),r=this.enabledChainIdentifiersForVault(e).slice(),n=this.enabledChainIdentifierMapForVault(e);for(const e of i)if(n.get(e)){const t=r.findIndex((t=>t===e));t>=0&&r.splice(t,1)}this.enabledChainIdentifiersMap.set(e,r);for(const t of this.onChainUIEnabledChangedHandlers)t(e,this.enabledChainIdentifiersForVault(e))}get allEnabledChainIdentifiers(){const e=new Set;for(const t of this.enabledChainIdentifiersMap.values())for(const i of t)e.add(i);return Array.from(e).filter((e=>this.chainsService.hasChainInfo(e)))}addChainUIEnabledChangedHandler(e){this.onChainUIEnabledChangedHandlers.push(e)}}r([s.observable.shallow],c.prototype,"enabledChainIdentifiersMap",void 0),r([s.action],c.prototype,"toggleChain",null),r([s.action],c.prototype,"enableChain",null),r([s.action],c.prototype,"disableChain",null),r([s.computed],c.prototype,"allEnabledChainIdentifiers",null),t.ChainsUIService=c},33230:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="chains-update"},72087:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(44375);t.getHandler=e=>(t,i)=>{if(i.constructor===s.TryUpdateEnabledChainInfosMsg)return o(e)(t,i);throw new n.KeplrError("chains-update",110,"Unknown msg type")};const o=e=>()=>r(void 0,void 0,void 0,(function*(){return yield e.tryUpdateEnabledChainInfos()}))},27950:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(30714),t),n(i(44375),t)},3683:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(44375),n=i(33230),s=i(72087);t.init=function(e,t){e.registerMessage(r.TryUpdateEnabledChainInfosMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},9785:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(30714),t),n(i(3683),t)},44375:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TryUpdateEnabledChainInfosMsg=void 0;const r=i(47235),n=i(33230);class s extends r.Message{static type(){return"TryUpdateEnabledChainInfosMsg"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.TryUpdateEnabledChainInfosMsg=s},30714:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChainsUpdateService=void 0;const n=i(75263);t.ChainsUpdateService=class{constructor(e,t,i){this.kvStore=e,this.chainsService=t,this.chainsUIService=i,this.lastUpdateStartTimeMap=new Map}init(){return r(this,void 0,void 0,(function*(){this.startUpdateLoop(),this.chainsService.addChainSuggestedHandler((e=>{this.updateChainInfo(e.chainId).catch((e=>{console.log(e)}))})),this.chainsService.addChainRemovedHandler((e=>{this.updateChainInfo(e.chainId).catch((e=>{console.log(e)}))}))}))}startUpdateLoop(){this.startUpdateChainInfosLoop(),this.startUpdateEnabledChainInfosLoop()}startUpdateChainInfosLoop(){return r(this,void 0,void 0,(function*(){for(;;){const e=this.chainsService.getChainInfos();for(const t of e)this.updateChainInfo(t.chainId).catch((e=>{console.log(e)}));yield new Promise((e=>{setTimeout(e,216e5)}))}}))}startUpdateEnabledChainInfosLoop(){return r(this,void 0,void 0,(function*(){for(;;){yield new Promise((e=>{setTimeout(e,36e5)}));const e=this.chainsUIService.allEnabledChainIdentifiers;for(const t of e)this.updateChainInfo(t).catch((e=>{console.log(e)}))}}))}tryUpdateEnabledChainInfos(){return r(this,void 0,void 0,(function*(){let e=!1;const t=[],i=this.chainsUIService.allEnabledChainIdentifiers;for(const n of i)t.push((()=>r(this,void 0,void 0,(function*(){(yield this.updateChainInfo(n))&&(e=!0)})))());return yield Promise.allSettled(t),e}))}updateChainInfo(e){return r(this,void 0,void 0,(function*(){const t=n.ChainIdHelper.parse(e).identifier,i=this.lastUpdateStartTimeMap.get(t);if(i&&Math.abs(Date.now()-i)<3e5)return!1;this.lastUpdateStartTimeMap.set(t,Date.now());const r=this.chainsService.getChainInfoWithCoreTypes(t);if(!r)return!1;let s=!1;if(!r.updateFromRepoDisabled)try{s=yield this.chainsService.tryUpdateChainInfoFromRepo(t)}catch(e){console.log(e)}const o=yield this.chainsService.tryUpdateChainInfoFromRpcOrRest(t);return s||o}))}}},95999:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="chains"},46619:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(71398),o=i(39310);t.getHandler=(e,t,i)=>(r,o)=>{switch(o.constructor){case s.GetChainInfosWithCoreTypesMsg:return a(e)(r,o);case s.GetChainInfosWithoutEndpointsMsg:return c(e,i)(r,o);case s.SuggestChainInfoMsg:return u(e,t)(r,o);case s.RemoveSuggestedChainInfoMsg:return d(e)(r,o);case s.SetChainEndpointsMsg:return l(e)(r,o);case s.ClearChainEndpointsMsg:return h(e)(r,o);case s.GetChainOriginalEndpointsMsg:return g(e)(r,o);case s.ClearAllSuggestedChainInfosMsg:return f(e)(r,o);case s.ClearAllChainEndpointsMsg:return p(e)(r,o);default:throw new n.KeplrError("chains",110,"Unknown msg type")}};const a=e=>()=>({chainInfos:e.getChainInfosWithCoreTypes()}),c=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.checkOrGrantGetChainInfosWithoutEndpointsPermission(i,n.origin),{chainInfos:e.getChainInfosWithoutEndpoints()}})),u=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){if(null!=e.getChainInfo(n.chainInfo.chainId))return;const r=n.chainInfo;r.beta=!0,yield e.suggestChainInfo(i,r,n.origin),t.addPermission([r.chainId],(0,o.getBasicAccessPermissionType)(),[n.origin])})),d=e=>(t,i)=>(e.removeSuggestedChainInfo(i.chainId),e.getChainInfosWithCoreTypes()),l=e=>(t,i)=>(e.setEndpoint(i.chainId,{rpc:i.rpc,rest:i.rest}),e.getChainInfosWithCoreTypes()),h=e=>(t,i)=>(e.clearEndpoint(i.chainId),e.getChainInfosWithCoreTypes()),g=e=>(t,i)=>e.getOriginalEndpoint(i.chainId),f=e=>()=>e.clearAllSuggestedChainInfos(),p=e=>()=>e.clearAllEndpoints()},2954:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(9916),t),n(i(71398),t),n(i(59903),t)},43276:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(71398),n=i(95999),s=i(46619);t.init=function(e,t,i,o){e.registerMessage(r.GetChainInfosWithCoreTypesMsg),e.registerMessage(r.GetChainInfosWithoutEndpointsMsg),e.registerMessage(r.SuggestChainInfoMsg),e.registerMessage(r.RemoveSuggestedChainInfoMsg),e.registerMessage(r.SetChainEndpointsMsg),e.registerMessage(r.ClearChainEndpointsMsg),e.registerMessage(r.GetChainOriginalEndpointsMsg),e.registerMessage(r.ClearAllSuggestedChainInfosMsg),e.registerMessage(r.ClearAllChainEndpointsMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t,i,o))}},25799:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(9916),t),n(i(43276),t)},71398:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClearAllChainEndpointsMsg=t.ClearAllSuggestedChainInfosMsg=t.GetChainOriginalEndpointsMsg=t.ClearChainEndpointsMsg=t.SetChainEndpointsMsg=t.RemoveSuggestedChainInfoMsg=t.SuggestChainInfoMsg=t.GetChainInfosWithoutEndpointsMsg=t.GetChainInfosWithCoreTypesMsg=void 0;const r=i(47235),n=i(95999);class s extends r.Message{static type(){return"get-chain-infos-with-core-types"}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.GetChainInfosWithCoreTypesMsg=s;class o extends r.Message{static type(){return"get-chain-infos-without-endpoints"}validateBasic(){}approveExternal(){return!0}route(){return n.ROUTE}type(){return o.type()}}t.GetChainInfosWithoutEndpointsMsg=o;class a extends r.Message{static type(){return"suggest-chain-info"}constructor(e){super(),this.chainInfo=e}validateBasic(){if(!this.chainInfo)throw new r.KeplrError("chains",100,"Chain info not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return a.type()}}t.SuggestChainInfoMsg=a;class c extends r.Message{static type(){return"remove-suggested-chain-info"}constructor(e){super(),this.chainId=e}validateBasic(){if(!this.chainId)throw new r.KeplrError("chains",101,"Chain id not set")}route(){return n.ROUTE}type(){return c.type()}}t.RemoveSuggestedChainInfoMsg=c;class u extends r.Message{static type(){return"set-chain-endpoints"}constructor(e,t,i){super(),this.chainId=e,this.rpc=t,this.rest=i}validateBasic(){if(!this.chainId)throw new Error("Empty chain id");if(this.rpc){const e=new URL(this.rpc);if("http:"!==e.protocol&&"https:"!==e.protocol)throw new Error(`RPC has invalid protocol: ${e.protocol}`)}if(this.rest){const e=new URL(this.rest);if("http:"!==e.protocol&&"https:"!==e.protocol)throw new Error(`LCD has invalid protocol: ${e.protocol}`)}}route(){return n.ROUTE}type(){return u.type()}}t.SetChainEndpointsMsg=u;class d extends r.Message{static type(){return"clear-chain-endpoints"}constructor(e){super(),this.chainId=e}validateBasic(){if(!this.chainId)throw new Error("Empty chain id")}route(){return n.ROUTE}type(){return d.type()}}t.ClearChainEndpointsMsg=d;class l extends r.Message{static type(){return"get-chain-original-endpoints"}constructor(e){super(),this.chainId=e}validateBasic(){if(!this.chainId)throw new Error("Empty chain id")}route(){return n.ROUTE}type(){return l.type()}}t.GetChainOriginalEndpointsMsg=l;class h extends r.Message{static type(){return"clear-all-suggested-chain-infos"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return h.type()}}t.ClearAllSuggestedChainInfosMsg=h;class g extends r.Message{static type(){return"clear-all-chain-endpoints"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return g.type()}}t.ClearAllChainEndpointsMsg=g},9916:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChainsService=void 0;const s=i(45137),o=i(80075),a=i(75263),c=i(58242),u=i(10843),d=i(96618),l=i(71398);class h{constructor(e,t,i,r,n,u){this.kvStore=e,this.migrationKVStore=t,this.embedChainInfos=i,this.communityChainInfoRepo=r,this.interactionService=n,this.afterInitFn=u,this.updatedChainInfos=[],this.suggestedChainInfos=[],this.repoChainInfos=[],this.endpoints=[],this.onChainRemovedHandlers=[],this.onChainSuggestedHandlers=[],this.getChainInfos=(0,c.computedFn)((()=>this.mergeChainInfosWithDynamics(this.embedChainInfos.concat(this.suggestedChainInfos))),{keepAlive:!0}),this.getChainInfosWithoutEndpoints=(0,c.computedFn)((()=>this.mergeChainInfosWithDynamics(this.embedChainInfos.concat(this.suggestedChainInfos)).map((e=>Object.assign(Object.assign({},e),{rpc:void 0,rest:void 0,nodeProvider:void 0,updateFromRepoDisabled:void 0,embedded:void 0})))),{keepAlive:!0}),this.getChainInfo=(0,c.computedFn)((e=>this.chainInfoMap.get(a.ChainIdHelper.parse(e).identifier)),{keepAlive:!0}),this.getChainInfosWithCoreTypes=(0,c.computedFn)((()=>this.mergeChainInfosWithDynamics(this.embedChainInfos.map((e=>Object.assign(Object.assign({},e),{embedded:!0}))).concat(this.suggestedChainInfos.map((e=>Object.assign(Object.assign({},e),{beta:!0,embedded:!1})))))),{keepAlive:!0}),this.getChainInfoWithCoreTypes=(0,c.computedFn)((e=>this.chainInfoMapWithCoreTypes.get(a.ChainIdHelper.parse(e).identifier)),{keepAlive:!0}),this.getOriginalEndpoint=(0,c.computedFn)((e=>{const t=a.ChainIdHelper.parse(e).identifier,i=this.embedChainInfos.concat(this.suggestedChainInfos).find((e=>a.ChainIdHelper.parse(e.chainId).identifier===t));if(i)return{rpc:i.rpc,rest:i.rest};throw new Error(`Unknown chain: ${e}`)}),{keepAlive:!0}),this.updatedChainInfoKVStore=new s.PrefixKVStore(e,"updatedChainInfo"),this.suggestedChainInfoKVStore=new s.PrefixKVStore(e,"suggestedChainInfo"),this.repoChainInfoKVStore=new s.PrefixKVStore(e,"repoChainInfo"),this.endpointsKVStore=new s.PrefixKVStore(e,"endpoints"),(0,o.makeObservable)(this)}init(){return n(this,void 0,void 0,(function*(){if(!(yield this.kvStore.get("migration/v1"))){const e=yield this.migrationKVStore.kvStore.get("chain-infos");if(e){const t=e.filter((e=>!this.embedChainInfos.some((t=>a.ChainIdHelper.parse(t.chainId).identifier===a.ChainIdHelper.parse(e.chainId).identifier))));for(const e of t)yield this.addSuggestedChainInfo(e,!0);const i=this.embedChainInfos.concat(t);for(const e of i){const t=a.ChainIdHelper.parse(e.chainId).identifier,i=yield this.migrationKVStore.updaterKVStore.get("updated-chain-info/"+t);if(i)try{const e=yield(0,u.validateBasicChainInfoType)(i);(0,o.runInAction)((()=>{this.repoChainInfos=[...this.repoChainInfos,e]}))}catch(e){console.log(e)}const r=yield this.migrationKVStore.updaterKVStore.get(t);r&&this.setUpdatedChainInfo(e.chainId,{chainId:r.chainId,features:r.features});const n=yield this.migrationKVStore.updaterKVStore.get("chain-info-endpoints/"+t);n&&this.setEndpoint(e.chainId,n)}}yield this.kvStore.set("migration/v1",!0)}{const e=yield this.updatedChainInfoKVStore.get("chainInfos");e&&(0,o.runInAction)((()=>{this.updatedChainInfos=e})),(0,o.autorun)((()=>{this.updatedChainInfoKVStore.set("chainInfos",this.updatedChainInfos)}))}{const e=yield this.suggestedChainInfoKVStore.get("chainInfos");e&&(0,o.runInAction)((()=>{this.suggestedChainInfos=e.filter((e=>!this.embedChainInfos.some((t=>a.ChainIdHelper.parse(e.chainId).identifier===a.ChainIdHelper.parse(t.chainId).identifier))))})),(0,o.autorun)((()=>{this.suggestedChainInfoKVStore.set("chainInfos",this.suggestedChainInfos)}))}{const e=yield this.repoChainInfoKVStore.get("chainInfos");e&&(0,o.runInAction)((()=>{this.repoChainInfos=e})),(0,o.autorun)((()=>{this.repoChainInfoKVStore.set("chainInfos",this.repoChainInfos)}))}{const e=yield this.endpointsKVStore.get("endpoints");e&&(0,o.runInAction)((()=>{this.endpoints=e})),(0,o.autorun)((()=>{this.endpointsKVStore.set("endpoints",this.endpoints)}))}}))}afterInit(){return n(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("last_embed_chain_infos");this.afterInitFn&&(yield this.afterInitFn(this,null!=e?e:[])),yield this.kvStore.set("last_embed_chain_infos",(0,o.toJS)(this.embedChainInfos))}))}hasChainInfo(e){return null!=this.getChainInfo(e)}getChainInfoOrThrow(e){const t=this.getChainInfo(e);if(!t)throw new Error(`There is no chain info for ${e}`);return t}tryUpdateChainInfoFromRepo(e){return n(this,void 0,void 0,(function*(){if(!this.hasChainInfo(e))throw new Error(`${e} is not registered`);if(this.getChainInfoOrThrow(e).updateFromRepoDisabled)return!1;const t=a.ChainIdHelper.parse(e).identifier;let i=(yield(0,d.simpleFetch)(this.communityChainInfoRepo.alternativeURL?this.communityChainInfoRepo.alternativeURL.replace("{chain_identifier}",t):`https://raw.githubusercontent.com/${this.communityChainInfoRepo.organizationName}/${this.communityChainInfoRepo.repoName}/${this.communityChainInfoRepo.branchName}/cosmos/${t}.json`)).data;const r=a.ChainIdHelper.parse(i.chainId).identifier;if(t!==r)throw new Error(`The chainId is not valid.(${e} -> ${r})`);if(i=yield(0,u.validateBasicChainInfoType)(i),!this.hasChainInfo(e))throw new Error(`${e} became unregistered after fetching`);const n=this.getRepoChainInfo(e);if(!n||(0,s.sortedJsonByKeyStringify)(n)!==(0,s.sortedJsonByKeyStringify)(i)){const e=this.repoChainInfos.findIndex((e=>a.ChainIdHelper.parse(e.chainId).identifier===t));return(0,o.runInAction)((()=>{if(e>=0){const t=this.repoChainInfos.slice();t[e]=i,this.repoChainInfos=t}else{const e=this.repoChainInfos.slice();e.push(i),this.repoChainInfos=e}})),!0}return!1}))}tryUpdateChainInfoFromRpcOrRest(e){var t;return n(this,void 0,void 0,(function*(){if(!this.hasChainInfo(e))throw new Error(`${e} is not registered`);const i=a.ChainIdHelper.parse(e).identifier,r=this.getChainInfoOrThrow(e);let n=!1;const s=yield(0,d.simpleFetch)(r.rpc,"/status"),o=("result"in s.data?s.data.result:s.data).node_info.network;if(a.ChainIdHelper.parse(o).identifier!==i)throw new Error(`Chain id is different from rpc: (expected: ${e}, actual: ${o})`);if(r.chainId!==o){if(n=!0,!this.hasChainInfo(e))throw new Error(`${e} became unregistered after fetching`);this.setUpdatedChainInfo(e,{chainId:o})}const c=yield(0,u.checkChainFeatures)(r),l=0!==c.length;if(l){if(!this.hasChainInfo(e))throw new Error(`${e} became unregistered after fetching`);const i=[...new Set([...c,...null!==(t=r.features)&&void 0!==t?t:[]])];this.setUpdatedChainInfo(e,{features:i})}return n||l}))}setUpdatedChainInfo(e,t){if(!this.hasChainInfo(e))throw new Error(`${e} is not registered`);const i=a.ChainIdHelper.parse(e).identifier,r=this.updatedChainInfos.findIndex((e=>a.ChainIdHelper.parse(e.chainId).identifier===i));if(r>=0){const e=this.updatedChainInfos[r],i=this.updatedChainInfos.slice();i[r]=Object.assign(Object.assign({},e),t),this.updatedChainInfos=i}else{const i=this.getChainInfoOrThrow(e),r=this.updatedChainInfos.slice();r.push({chainId:t.chainId||i.chainId,features:t.features||i.features}),this.updatedChainInfos=r}}suggestChainInfo(e,t,i){return n(this,void 0,void 0,(function*(){t=yield(0,u.validateBasicChainInfoType)(t),yield this.interactionService.waitApproveV2(e,"/suggest-chain",l.SuggestChainInfoMsg.type(),{chainInfo:t,origin:i},(e=>n(this,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},yield(0,u.validateBasicChainInfoType)(e)),{beta:t.beta,updateFromRepoDisabled:e.updateFromRepoDisabled});i.updateFromRepoDisabled?console.log(`Chain ${i.chainName}(${i.chainId}) added with updateFromRepoDisabled`):console.log(`Chain ${i.chainName}(${i.chainId}) added`),yield this.addSuggestedChainInfo(i)}))))}))}addSuggestedChainInfo(e,t){return n(this,void 0,void 0,(function*(){if(!(this.suggestedChainInfos.findIndex((t=>a.ChainIdHelper.parse(t.chainId).identifier===a.ChainIdHelper.parse(e.chainId).identifier))<0))throw new Error(`There is already chain info for ${e.chainId}`);{const i=this.suggestedChainInfos.slice();if(i.push(e),(0,o.runInAction)((()=>{this.suggestedChainInfos=i})),!t){const t=this.mergeChainInfosWithDynamics([e])[0];for(const e of this.onChainSuggestedHandlers)yield e(t)}}}))}removeSuggestedChainInfo(e){const t=this.suggestedChainInfos.findIndex((t=>a.ChainIdHelper.parse(t.chainId).identifier===a.ChainIdHelper.parse(e).identifier));if(!(t>=0))throw new Error(`There is no chain info for ${e}`);{const e=this.suggestedChainInfos[t],i=this.suggestedChainInfos.slice();i.splice(t,1),this.suggestedChainInfos=i,this.onChainRemoved(e)}}clearAllSuggestedChainInfos(){const e=this.suggestedChainInfos.slice();this.suggestedChainInfos=[];for(const t of e)this.onChainRemoved(t)}get chainInfoMap(){const e=new Map;for(const t of this.getChainInfos())e.set(a.ChainIdHelper.parse(t.chainId).identifier,t);return e}get chainInfoMapWithCoreTypes(){const e=new Map;for(const t of this.getChainInfosWithCoreTypes())e.set(a.ChainIdHelper.parse(t.chainId).identifier,t);return e}get updatedChainInfoMap(){const e=new Map;for(const t of this.updatedChainInfos)e.set(a.ChainIdHelper.parse(t.chainId).identifier,t);return e}getUpdatedChainInfo(e){return this.updatedChainInfoMap.get(a.ChainIdHelper.parse(e).identifier)}get repoChainInfoMap(){const e=new Map;for(const t of this.repoChainInfos)e.set(a.ChainIdHelper.parse(t.chainId).identifier,t);return e}getRepoChainInfo(e){return this.repoChainInfoMap.get(a.ChainIdHelper.parse(e).identifier)}setEndpoint(e,t){const i=Object.assign({},t);i.rpc||delete i.rpc,i.rest||delete i.rest;const r=a.ChainIdHelper.parse(e).identifier,n=this.endpoints.findIndex((e=>a.ChainIdHelper.parse(e.chainId).identifier===r));if(n>=0){const t=this.endpoints.slice();t[n]=Object.assign({chainId:e},i),this.endpoints=t}else{const t=this.endpoints.slice();t.push(Object.assign({chainId:e},i)),this.endpoints=t}}clearEndpoint(e){const t=a.ChainIdHelper.parse(e).identifier,i=this.endpoints.findIndex((e=>a.ChainIdHelper.parse(e.chainId).identifier===t));if(i>=0){const e=this.endpoints.slice();e.splice(i,1),this.endpoints=e}}clearAllEndpoints(){this.endpoints=[]}getEndpoint(e){return this.endpointMap.get(a.ChainIdHelper.parse(e).identifier)}get endpointMap(){const e=new Map;for(const t of this.endpoints)e.set(a.ChainIdHelper.parse(t.chainId).identifier,t);return e}mergeChainInfosWithDynamics(e){return e.map((e=>{var t,i,r,n;let s=Object.assign({},e);if(!e.updateFromRepoDisabled){const r=this.getRepoChainInfo(e.chainId);r&&(s=Object.assign(Object.assign(Object.assign({},s),r),{stakeCurrency:r.stakeCurrency?r.stakeCurrency:void 0,walletUrlForStaking:r.walletUrlForStaking||s.walletUrlForStaking,features:[...new Set([...null!==(t=r.features)&&void 0!==t?t:[],...null!==(i=s.features)&&void 0!==i?i:[]])],beta:s.beta}))}const o=this.getUpdatedChainInfo(e.chainId);o&&(s=Object.assign(Object.assign({},s),{chainId:o.chainId,features:[...new Set([...null!==(r=o.features)&&void 0!==r?r:[],...null!==(n=s.features)&&void 0!==n?n:[]])]}));const a=this.getEndpoint(e.chainId);return a&&(s=Object.assign(Object.assign({},s),{rpc:a.rpc||s.rpc,rest:a.rest||s.rest})),118!==s.bip44.coinType&&60!==s.bip44.coinType&&(s=Object.assign(Object.assign({},s),{alternativeBIP44s:(()=>{var e;let t=null!==(e=s.alternativeBIP44s)&&void 0!==e?e:[];return t.find((e=>118===e.coinType))||(t=[...t,{coinType:118}]),t})()})),s}))}onChainRemoved(e){const t=a.ChainIdHelper.parse(e.chainId).identifier,i=this.mergeChainInfosWithDynamics([e])[0];{const e=this.updatedChainInfos.slice();e.filter((e=>a.ChainIdHelper.parse(e.chainId).identifier!==t)),this.updatedChainInfos=e}{const e=this.suggestedChainInfos.slice();e.filter((e=>a.ChainIdHelper.parse(e.chainId).identifier!==t)),this.suggestedChainInfos=e}{const e=this.repoChainInfos.slice();e.filter((e=>a.ChainIdHelper.parse(e.chainId).identifier!==t)),this.repoChainInfos=e}{const e=this.endpoints.slice();e.filter((e=>a.ChainIdHelper.parse(e.chainId).identifier!==t)),this.endpoints=e}for(const e of this.onChainRemovedHandlers)e(i)}addChainRemovedHandler(e){this.onChainRemovedHandlers.push(e)}addChainSuggestedHandler(e){this.onChainSuggestedHandlers.push(e)}}r([o.observable.ref],h.prototype,"updatedChainInfos",void 0),r([o.observable.ref],h.prototype,"suggestedChainInfos",void 0),r([o.observable.ref],h.prototype,"repoChainInfos",void 0),r([o.observable.ref],h.prototype,"endpoints",void 0),r([o.action],h.prototype,"setUpdatedChainInfo",null),r([o.action],h.prototype,"removeSuggestedChainInfo",null),r([o.action],h.prototype,"clearAllSuggestedChainInfos",null),r([(0,o.computed)({keepAlive:!0})],h.prototype,"chainInfoMap",null),r([(0,o.computed)({keepAlive:!0})],h.prototype,"chainInfoMapWithCoreTypes",null),r([(0,o.computed)({keepAlive:!0})],h.prototype,"updatedChainInfoMap",null),r([(0,o.computed)({keepAlive:!0})],h.prototype,"repoChainInfoMap",null),r([o.action],h.prototype,"setEndpoint",null),r([o.action],h.prototype,"clearEndpoint",null),r([o.action],h.prototype,"clearAllEndpoints",null),r([(0,o.computed)({keepAlive:!0})],h.prototype,"endpointMap",null),r([o.action],h.prototype,"onChainRemoved",null),t.ChainsService=h},59903:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},50320:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)},a=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const c=s(i(25799)),u=s(i(37329)),d=s(i(9785)),l=s(i(42134)),h=s(i(59715)),g=s(i(25079)),f=s(i(3015)),p=s(i(29307)),y=s(i(20982)),v=s(i(53213)),m=s(i(18351)),w=s(i(56509)),b=s(i(81237)),I=s(i(22433)),S=s(i(35421)),M=s(i(57264)),k=s(i(88956)),_=s(i(35441)),O=s(i(73416)),E=s(i(16008)),C=s(i(63754)),P=s(i(81316)),R=s(i(9932)),A=s(i(20684));o(i(2954),t),o(i(77052),t),o(i(27950),t),o(i(49145),t),o(i(75851),t),o(i(5268),t),o(i(81984),t),o(i(40331),t),o(i(39310),t),o(i(72978),t),o(i(81030),t),o(i(68520),t),o(i(18583),t),o(i(51890),t),o(i(2554),t),o(i(60604),t),o(i(17280),t),o(i(56046),t),o(i(32197),t),o(i(48247),t),t.init=function(e,t,i,r,n,s,o,x,T,j,B,K){const D=new y.InteractionService(i),U=new c.ChainsService(t("chains-v2"),{kvStore:t("chains"),updaterKVStore:t("updator")},r,x,D,K),N=new f.TokenCW20Service(t("tokens"),U,D),H=new p.TokenERC20Service(t("tokens-erc20"),U,D),V=new v.PermissionService(t("permission"),n,D,U),F=new h.BackgroundTxService(U,T),L=new g.BackgroundTxEthereumService(U,T),q=new m.PhishingListService({blockListUrl:"https://raw.githubusercontent.com/chainapsis/phishing-block-list/main/block-list.txt",twitterListUrl:"https://raw.githubusercontent.com/chainapsis/phishing-block-list/main/twitter-scammer-list.txt",fetchingIntervalMs:108e5,retryIntervalMs:6e5,allowTimeoutMs:6e5},j),G=new b.AnalyticsService(t("background.analytics"),s),$=new I.VaultService(t("vault")),W=new u.ChainsUIService(t("chains-ui"),U,$),z=new S.KeyRingService(t("keyring-v2"),{kvStore:t("keyring"),commonCrypto:B.commonCrypto,getDisabledChainIdentifiers:B.getDisabledChainIdentifiers,chainsUIService:W},U,D,$,G,[new M.KeyRingMnemonicService($),new k.KeyRingLedgerService,new O.KeyRingPrivateKeyService($),new _.KeyRingKeystoneService]),J=new E.KeyRingCosmosService(U,z,D,W,G,o),X=new C.KeyRingEthereumService(U,z,J,D,G),Y=new w.AutoLockAccountService(t("auto-lock-account"),z),Z=new P.PermissionInteractiveService(V,z),Q=new d.ChainsUpdateService(t("chains-update"),U,W),ee=new l.SecretWasmService(t("secretwasm"),U,J),te=new R.TokenScanService(t("token-scan"),U,W,$,z,J),ie=new A.RecentSendHistoryService(t("recent-send-history"),U,F,T);return y.init(e,D),v.init(e,V),c.init(e,U,V,Z),h.init(e,F,Z),g.init(e,L,Z),m.init(e,q),w.init(e,Y),b.init(e,G),S.init(e,z),E.init(e,J,Z),C.init(e,X,Z),P.init(e,Z),u.init(e,W),d.init(e,Q),f.init(e,N,Z,J),p.init(e,H,Z),l.init(e,ee,Z),R.init(e,te),A.init(e,ie),{initFn:()=>a(this,void 0,void 0,(function*(){yield G.init(),yield U.init(),yield $.init(),yield W.init(),yield Q.init(),yield z.init(),yield J.init(),yield X.init(),yield V.init(),yield N.init(),yield H.init(),yield F.init(),yield L.init(),yield q.init(),yield Y.init(),yield Z.init(),yield ee.init(),yield te.init(),yield ie.init(),yield U.afterInit()})),keyRingService:z}}},97434:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="interaction"},95965:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="interaction-foreground"},26191:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(47235),n=i(5868);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.PushInteractionDataMsg:return s(e)(t,i);case n.PushEventDataMsg:return o(e)(t,i);default:throw new r.KeplrError("interaction",110,"Unknown msg type")}};const s=e=>(t,i)=>e.pushData(i.data),o=e=>(t,i)=>e.pushEvent(i.data)},84545:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(81687),t),n(i(5868),t),n(i(78664),t),n(i(57436),t)},57436:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interactionForegroundInit=void 0;const r=i(5868),n=i(95965),s=i(26191);t.interactionForegroundInit=function(e,t){e.registerMessage(r.PushInteractionDataMsg),e.registerMessage(r.PushEventDataMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},5868:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PushEventDataMsg=t.PushInteractionDataMsg=void 0;const r=i(47235),n=i(95965);class s extends r.Message{static type(){return"push-interaction-data"}constructor(e){super(),this.data=e}validateBasic(){if(!this.data.type)throw new r.KeplrError("interaction",101,"Type should not be empty")}route(){return n.ROUTE}type(){return s.type()}}t.PushInteractionDataMsg=s;class o extends r.Message{static type(){return"push-event-data"}constructor(e){super(),this.data=e}validateBasic(){if(!this.data.type)throw new r.KeplrError("interaction",101,"Type should not be empty")}route(){return n.ROUTE}type(){return o.type()}}t.PushEventDataMsg=o},81687:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionForegroundService=void 0,t.InteractionForegroundService=class{constructor(e){this.handler=e}pushData(e){this.handler.onInteractionDataReceived(e)}pushEvent(e){this.handler.onEventDataReceived(e)}}},78664:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},58615:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(47235),n=i(12196);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.ApproveInteractionMsg:return s(e)(t,i);case n.RejectInteractionMsg:return a(e)(t,i);case n.ApproveInteractionV2Msg:return o(e)(t,i);case n.RejectInteractionV2Msg:return c(e)(t,i);default:throw new r.KeplrError("interaction",100,"Unknown msg type")}};const s=e=>(t,i)=>e.approve(i.id,i.result),o=e=>(t,i)=>e.approveV2(i.id,i.result),a=e=>(t,i)=>e.reject(i.id),c=e=>(t,i)=>e.rejectV2(i.id)},40331:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(16477),t),n(i(12196),t),n(i(90505),t),n(i(84545),t)},92692:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(12196),n=i(97434),s=i(58615);t.init=function(e,t){e.registerMessage(r.ApproveInteractionMsg),e.registerMessage(r.RejectInteractionMsg),e.registerMessage(r.ApproveInteractionV2Msg),e.registerMessage(r.RejectInteractionV2Msg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},20982:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(16477),t),n(i(92692),t)},12196:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RejectInteractionV2Msg=t.RejectInteractionMsg=t.ApproveInteractionV2Msg=t.ApproveInteractionMsg=void 0;const r=i(47235),n=i(97434);class s extends r.Message{static type(){return"approve-interaction"}constructor(e,t){super(),this.id=e,this.result=t}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.ApproveInteractionMsg=s;class o extends r.Message{static type(){return"approve-interaction-v2"}constructor(e,t){super(),this.id=e,this.result=t}validateBasic(){}route(){return n.ROUTE}type(){return o.type()}}t.ApproveInteractionV2Msg=o;class a extends r.Message{static type(){return"reject-interaction"}constructor(e){super(),this.id=e}validateBasic(){}route(){return n.ROUTE}type(){return a.type()}}t.RejectInteractionMsg=a;class c extends r.Message{static type(){return"reject-interaction-v2"}constructor(e){super(),this.id=e}validateBasic(){}route(){return n.ROUTE}type(){return c.type()}}t.RejectInteractionV2Msg=c},16477:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionService=void 0;const n=i(47235),s=i(84545),o=i(48834);t.InteractionService=class{constructor(e){this.eventMsgRequester=e,this.waitingMap=new Map,this.resolverMap=new Map,this.resolverV2Map=new Map}init(){}dispatchEvent(e,t,i){if(!t)throw new n.KeplrError("interaction",101,"Type should not be empty");const r=new s.PushEventDataMsg({type:t,data:i});this.eventMsgRequester.sendMessage(e,r).catch((t=>{console.log(`Failed to send the event to ${e}: ${t.message}`)}))}waitApprove(e,t,i,o,a){return r(this,void 0,void 0,(function*(){if(!i)throw new n.KeplrError("interaction",101,"Type should not be empty");const r=this.addDataToMap(i,e.isInternalMsg,o),c=new s.PushInteractionDataMsg(r);return yield this.wait(e,t,c,a)}))}waitApproveV2(e,t,i,o,a,c){return r(this,void 0,void 0,(function*(){if(!i)throw new n.KeplrError("interaction",101,"Type should not be empty");const r=this.addDataToMap(i,e.isInternalMsg,o),u=new s.PushInteractionDataMsg(r);try{const i=yield this.wait(e,t,u,c);return a(i)}finally{const e=this.resolverV2Map.get(r.id);if(e)for(const t of e)t.resolver();this.resolverV2Map.delete(r.id)}}))}wait(e,t,i,s){return r(this,void 0,void 0,(function*(){const r=i.data.id;if(this.resolverMap.has(r))throw new n.KeplrError("interaction",100,"Id is aleady in use");return new Promise(((n,o)=>{this.resolverMap.set(r,{onApprove:n,onReject:o}),e.requestInteraction(t,i,Object.assign(Object.assign({},s),{unstableOnClose:()=>{this.reject(r)}}))}))}))}approve(e,t){this.resolverMap.has(e)&&(this.resolverMap.get(e).onApprove(t),this.resolverMap.delete(e)),this.removeDataFromMap(e)}approveV2(e,t){return new Promise((i=>{const r=this.resolverV2Map.get(e)||[];r.push({resolver:i}),this.resolverV2Map.set(e,r),this.resolverMap.has(e)&&(this.resolverMap.get(e).onApprove(t),this.resolverMap.delete(e)),this.removeDataFromMap(e)}))}reject(e){this.resolverMap.has(e)&&(this.resolverMap.get(e).onReject(new Error("Request rejected")),this.resolverMap.delete(e)),this.removeDataFromMap(e)}rejectV2(e){return new Promise((t=>{const i=this.resolverV2Map.get(e)||[];i.push({resolver:t}),this.resolverV2Map.set(e,i),this.resolverMap.has(e)&&(this.resolverMap.get(e).onReject(new Error("Request rejected")),this.resolverMap.delete(e)),this.removeDataFromMap(e)}))}addDataToMap(e,t,i){const r=new Uint8Array(12);crypto.getRandomValues(r);const s=o.Buffer.from(r).toString("hex"),a={id:s,type:e,isInternal:t,data:i};if(this.waitingMap.has(s))throw new n.KeplrError("interaction",100,"Id is aleady in use");return this.waitingMap.set(s,a),a}removeDataFromMap(e){this.waitingMap.delete(e)}}},90505:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1800:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.trimAminoSignDoc=void 0;const n=r(i(72903)),s=n.default.object({chain_id:n.default.string().allow(""),account_number:n.default.string().allow(""),sequence:n.default.string().allow(""),fee:n.default.object({amount:n.default.array().items(n.default.object({denom:n.default.string().allow(""),amount:n.default.string().allow("")})),gas:n.default.string().allow(""),payer:n.default.string().allow(""),granter:n.default.string().allow(""),feePayer:n.default.string().allow("")}),msgs:n.default.array().items(n.default.any()),memo:n.default.string().allow(""),timeout_height:n.default.string().allow("")});t.trimAminoSignDoc=function(e){const t=s.validate(e,{stripUnknown:!0});if(t.error)throw t.error;return t.value}},30876:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="keyring-cosmos"},47178:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.messageHash=t.domainHash=t.EIP712MessageValidator=t.EIP712DomainTypeValidator=t.EIP712PropertyFieldValidator=void 0;const n=r(i(72903)),s=i(49022);t.EIP712PropertyFieldValidator=n.default.object({name:n.default.string().min(1).required(),type:n.default.string().min(1).required()}),t.EIP712DomainTypeValidator=n.default.array().items(n.default.object({name:n.default.string().valid("name").required(),type:n.default.string().valid("string").required()}),n.default.object({name:n.default.string().valid("version").required(),type:n.default.string().valid("string").required()}),n.default.object({name:n.default.string().valid("chainId").required(),type:n.default.string().valid("uint256").required()}),n.default.object({name:n.default.string().valid("verifyingContract").required(),type:n.default.string().valid("address","string").required()}),n.default.object({name:n.default.string().valid("salt").required(),type:n.default.string().valid("bytes32","string").required()})).unique().min(1).custom((e=>{const t=["name","version","chainId","verifyingContract","salt"];return e.sort(((e,i)=>t.indexOf(e.name)-t.indexOf(i.name)))})),t.EIP712MessageValidator=n.default.object({types:n.default.object({EIP712Domain:t.EIP712DomainTypeValidator.required()}).unknown(!0).required(),primaryType:n.default.string().min(1).required(),domain:n.default.object().required(),message:n.default.object().required()}),t.domainHash=e=>s._TypedDataEncoder.hashStruct("EIP712Domain",{EIP712Domain:e.types.EIP712Domain},e.domain),t.messageHash=e=>s._TypedDataEncoder.from((()=>{const t=Object.assign({},e.types);delete t.EIP712Domain;const i=t[e.primaryType];if(!i)throw new Error(`No matched primary type: ${e.primaryType}`);return delete t[e.primaryType],Object.assign({[e.primaryType]:i},t)})()).hash(e.message)},97589:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(23217),o=i(12136);t.getHandler=(e,t)=>(i,r)=>{switch(r.constructor){case s.GetCosmosKeyMsg:return a(e,t)(i,r);case s.GetCosmosKeysSettledMsg:return c(e,t)(i,r);case s.RequestCosmosSignAminoMsg:return u(e,t)(i,r);case s.RequestCosmosSignDirectMsg:return d(e,t)(i,r);case s.RequestCosmosSignAminoADR36Msg:return l(e,t)(i,r);case s.VerifyCosmosSignAminoADR36Msg:return h(e,t)(i,r);case s.ComputeNotFinalizedKeyAddressesMsg:return g(e)(i,r);case s.PrivilegeCosmosSignAminoWithdrawRewardsMsg:return f(e)(i,r);case s.PrivilegeCosmosSignAminoDelegateMsg:return p(e)(i,r);case s.GetCosmosKeysForEachVaultSettledMsg:return y(e)(i,r);case s.RequestSignEIP712CosmosTxMsg_v0:return v(e,t)(i,r);case s.RequestICNSAdr36SignaturesMsg:return m(e,t)(i,r);case s.EnableVaultsWithCosmosAddressMsg:return w(e)(i,r);case s.RequestCosmosSignDirectAuxMsg:return b(e,t)(i,r);default:throw new n.KeplrError("keyring",221,"Unknown msg type")}};const a=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.getKeySelected(n.chainId)})),c=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,n.chainIds,n.origin),yield Promise.allSettled(n.chainIds.map((t=>e.getKeySelected(t))))})),u=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.signAminoSelected(i,n.origin,n.chainId,n.signer,n.signDoc,n.signOptions)})),d=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){yield t.ensureEnabled(i,[n.chainId],n.origin);const r=o.SignDoc.fromPartial({bodyBytes:n.signDoc.bodyBytes,authInfoBytes:n.signDoc.authInfoBytes,chainId:n.signDoc.chainId,accountNumber:n.signDoc.accountNumber}),s=yield e.signDirectSelected(i,n.origin,n.chainId,n.signer,r,n.signOptions);return{signed:{bodyBytes:s.signed.bodyBytes,authInfoBytes:s.signed.authInfoBytes,chainId:s.signed.chainId,accountNumber:s.signed.accountNumber.toString()},signature:s.signature}})),l=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),(yield e.signAminoADR36Selected(i,n.origin,n.chainId,n.signer,n.data,n.signOptions)).signature})),h=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.verifyAminoADR36Selected(n.chainId,n.signer,n.data,n.signature)})),g=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.computeNotFinalizedKeyAddresses(i.id,i.chainId)})),f=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.privilegeSignAminoWithdrawRewards(t,i.origin,i.chainId,i.signer,i.signDoc)})),p=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.privilegeSignAminoDelegate(t,i.origin,i.chainId,i.signer,i.signDoc)})),y=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield Promise.allSettled(i.vaultIds.map((t=>r(void 0,void 0,void 0,(function*(){const r=yield e.getKey(t,i.chainId);return Object.assign({vaultId:t},r)})))))})),v=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.requestSignEIP712CosmosTx_v0_selected(i,n.origin,n.chainId,n.signer,n.eip712,n.signDoc,n.signOptions)})),m=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.requestICNSAdr36SignaturesSelected(i,n.origin,n.chainId,n.contractAddress,n.owner,n.username,n.addressChainIds)})),w=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.enableVaultsWithCosmosAddress(i.chainId,i.bech32Address)})),b=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){yield t.ensureEnabled(i,[n.chainId],n.origin);const r=o.SignDocDirectAux.fromPartial({bodyBytes:n.signDoc.bodyBytes,publicKey:n.signDoc.publicKey,chainId:n.signDoc.chainId,accountNumber:n.signDoc.accountNumber,sequence:n.signDoc.sequence}),s=yield e.signDirectAuxSelected(i,n.origin,n.chainId,n.signer,r,n.signOptions);return{signed:{bodyBytes:s.signed.bodyBytes,publicKey:s.signed.publicKey,chainId:s.signed.chainId,accountNumber:s.signed.accountNumber.toString(),sequence:s.signed.sequence.toString()},signature:s.signature}}))},60604:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(23217),t),n(i(39301),t),n(i(47178),t)},76890:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(23217),n=i(30876),s=i(97589);t.init=function(e,t,i){e.registerMessage(r.GetCosmosKeyMsg),e.registerMessage(r.GetCosmosKeysSettledMsg),e.registerMessage(r.RequestCosmosSignAminoMsg),e.registerMessage(r.RequestCosmosSignAminoADR36Msg),e.registerMessage(r.RequestCosmosSignDirectMsg),e.registerMessage(r.VerifyCosmosSignAminoADR36Msg),e.registerMessage(r.ComputeNotFinalizedKeyAddressesMsg),e.registerMessage(r.PrivilegeCosmosSignAminoWithdrawRewardsMsg),e.registerMessage(r.PrivilegeCosmosSignAminoDelegateMsg),e.registerMessage(r.GetCosmosKeysForEachVaultSettledMsg),e.registerMessage(r.RequestSignEIP712CosmosTxMsg_v0),e.registerMessage(r.RequestICNSAdr36SignaturesMsg),e.registerMessage(r.EnableVaultsWithCosmosAddressMsg),e.registerMessage(r.RequestCosmosSignDirectAuxMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t,i))}},16008:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(39301),t),n(i(76890),t)},23217:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnableVaultsWithCosmosAddressMsg=t.RequestICNSAdr36SignaturesMsg=t.RequestSignEIP712CosmosTxMsg_v0=t.GetCosmosKeysForEachVaultSettledMsg=t.ComputeNotFinalizedKeyAddressesMsg=t.VerifyCosmosSignAminoADR36Msg=t.RequestCosmosSignAminoADR36Msg=t.PrivilegeCosmosSignAminoDelegateMsg=t.PrivilegeCosmosSignAminoWithdrawRewardsMsg=t.RequestCosmosSignDirectAuxMsg=t.RequestCosmosSignDirectMsg=t.RequestCosmosSignAminoMsg=t.GetCosmosKeysSettledMsg=t.GetCosmosKeyMsg=void 0;const n=i(47235),s=i(30876),o=i(75263),a=i(12136),c=i(16261),u=r(i(48166));class d extends n.Message{static type(){return"get-cosmos-key"}constructor(e){super(),this.chainId=e}validateBasic(){if(!this.chainId)throw new Error("chainId is not set")}approveExternal(){return!0}route(){return s.ROUTE}type(){return d.type()}}t.GetCosmosKeyMsg=d;class l extends n.Message{static type(){return"get-cosmos-keys-settled"}constructor(e){super(),this.chainIds=e}validateBasic(){if(!this.chainIds||0===this.chainIds.length)throw new Error("chainIds are not set");const e=new Map;for(const t of this.chainIds){if(e.get(t))throw new Error(`chainId ${t} is duplicated`);e.set(t,!0)}}approveExternal(){return!0}route(){return s.ROUTE}type(){return l.type()}}t.GetCosmosKeysSettledMsg=l;class h extends n.Message{static type(){return"request-cosmos-sign-amino"}constructor(e,t,i,r){super(),this.chainId=e,this.signer=t,this.signDoc=i,this.signOptions=r}validateBasic(){if(!this.chainId)throw new n.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new n.KeplrError("keyring",230,"signer not set");if(o.Bech32Address.validate(this.signer),(0,o.checkAndValidateADR36AminoSignDoc)(this.signDoc)){if(this.signDoc.msgs[0].value.signer!==this.signer)throw new n.KeplrError("keyring",233,"Unmatched signer in sign doc")}else if(this.signDoc.chain_id!==this.chainId)throw new n.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id");if(!this.signOptions)throw new n.KeplrError("keyring",235,"Sign options are null")}approveExternal(){return!0}route(){return s.ROUTE}type(){return h.type()}}t.RequestCosmosSignAminoMsg=h;class g extends n.Message{static type(){return"request-cosmos-sign-direct"}constructor(e,t,i,r={}){super(),this.chainId=e,this.signer=t,this.signDoc=i,this.signOptions=r}validateBasic(){if(!this.chainId)throw new n.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new n.KeplrError("keyring",230,"signer not set");if(o.Bech32Address.validate(this.signer),a.SignDoc.fromPartial({bodyBytes:this.signDoc.bodyBytes,authInfoBytes:this.signDoc.authInfoBytes,chainId:this.signDoc.chainId,accountNumber:this.signDoc.accountNumber}).chainId!==this.chainId)throw new n.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id");if(!this.signOptions)throw new n.KeplrError("keyring",235,"Sign options are null")}approveExternal(){return!0}route(){return s.ROUTE}type(){return g.type()}}t.RequestCosmosSignDirectMsg=g;class f extends n.Message{static type(){return"request-cosmos-sign-direct-aux"}constructor(e,t,i,r={}){super(),this.chainId=e,this.signer=t,this.signDoc=i,this.signOptions=r}validateBasic(){if(!this.chainId)throw new n.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new n.KeplrError("keyring",230,"signer not set");if(o.Bech32Address.validate(this.signer),a.SignDocDirectAux.fromPartial({bodyBytes:this.signDoc.bodyBytes,publicKey:this.signDoc.publicKey,chainId:this.signDoc.chainId,accountNumber:this.signDoc.accountNumber,sequence:this.signDoc.sequence}).chainId!==this.chainId)throw new n.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id");if(!this.signOptions)throw new n.KeplrError("keyring",235,"Sign options are null")}approveExternal(){return!0}route(){return s.ROUTE}type(){return f.type()}}t.RequestCosmosSignDirectAuxMsg=f;class p extends n.Message{static type(){return"PrivilegeCosmosSignAminoWithdrawRewards"}constructor(e,t,i){super(),this.chainId=e,this.signer=t,this.signDoc=i}validateBasic(){if(!this.chainId)throw new n.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new n.KeplrError("keyring",230,"signer not set");if(o.Bech32Address.validate(this.signer),(0,o.checkAndValidateADR36AminoSignDoc)(this.signDoc))throw new Error("Can't use ADR-36 sign doc");if(this.signDoc.chain_id!==this.chainId)throw new n.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id")}approveExternal(){return!0}route(){return s.ROUTE}type(){return p.type()}}t.PrivilegeCosmosSignAminoWithdrawRewardsMsg=p;class y extends n.Message{static type(){return"PrivilegeCosmosSignAminoDelegate"}constructor(e,t,i){super(),this.chainId=e,this.signer=t,this.signDoc=i}validateBasic(){if(!this.chainId)throw new n.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new n.KeplrError("keyring",230,"signer not set");if(o.Bech32Address.validate(this.signer),(0,o.checkAndValidateADR36AminoSignDoc)(this.signDoc))throw new Error("Can't use ADR-36 sign doc");if(this.signDoc.chain_id!==this.chainId)throw new n.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id")}approveExternal(){return!0}route(){return s.ROUTE}type(){return y.type()}}t.PrivilegeCosmosSignAminoDelegateMsg=y;class v extends n.Message{static type(){return"request-cosmos-sign-amino-adr-36"}constructor(e,t,i,r){super(),this.chainId=e,this.signer=t,this.data=i,this.signOptions=r}validateBasic(){if(!this.chainId)throw new n.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new n.KeplrError("keyring",230,"signer not set");if(!this.signOptions)throw new n.KeplrError("keyring",235,"Sign options are null")}approveExternal(){return!0}route(){return s.ROUTE}type(){return v.type()}}t.RequestCosmosSignAminoADR36Msg=v;class m extends n.Message{static type(){return"verify-cosmos-sign-amino-adr-36"}constructor(e,t,i,r){super(),this.chainId=e,this.signer=t,this.data=i,this.signature=r}validateBasic(){if(!this.chainId)throw new n.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new n.KeplrError("keyring",230,"signer not set");if(!this.signature)throw new n.KeplrError("keyring",271,"Signature not set");o.Bech32Address.validate(this.signer)}approveExternal(){return!0}route(){return s.ROUTE}type(){return m.type()}}t.VerifyCosmosSignAminoADR36Msg=m;class w extends n.Message{static type(){return"compute-not-finalized-key-addresses"}constructor(e,t){super(),this.id=e,this.chainId=t}validateBasic(){if(!this.id)throw new Error("id not set");if(!this.chainId)throw new Error("chain id not set")}route(){return s.ROUTE}type(){return w.type()}}t.ComputeNotFinalizedKeyAddressesMsg=w;class b extends n.Message{static type(){return"GetCosmosKeysForEachVaultSettledMsg"}constructor(e,t){super(),this.chainId=e,this.vaultIds=t}validateBasic(){if(!this.chainId)throw new Error("chain id not set");if(!this.vaultIds||0===this.vaultIds.length)throw new Error("vaultIds are not set");const e=new Map;for(const t of this.vaultIds){if(e.get(t))throw new Error(`vaultId ${t} is duplicated`);e.set(t,!0)}}route(){return s.ROUTE}type(){return b.type()}}t.GetCosmosKeysForEachVaultSettledMsg=b;class I extends n.Message{static type(){return"request-sign-eip-712-cosmos-tx-v0"}constructor(e,t,i,r,n){super(),this.chainId=e,this.signer=t,this.eip712=i,this.signDoc=r,this.signOptions=n}validateBasic(){if(!this.chainId)throw new n.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new n.KeplrError("keyring",230,"signer not set");if(o.Bech32Address.validate(this.signer),(0,o.checkAndValidateADR36AminoSignDoc)(this.signDoc))throw new Error("Can't sign ADR-36 with EIP-712");{if(this.signDoc.chain_id!==this.chainId)throw new n.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id");const{ethChainId:e}=o.EthermintChainIdHelper.parse(this.chainId);if(!(()=>{const e=this.eip712.domain.chainId;return"string"==typeof e&&e.startsWith("0x")?new c.Int((0,u.default)(e.replace("0x",""),16).toString()):new c.Int(e)})().equals(new c.Int(e)))throw new Error(`Unmatched chain id for eth (expected: ${e}, actual: ${this.eip712.domain.chainId})`)}if(!this.signOptions)throw new n.KeplrError("keyring",235,"Sign options are null")}approveExternal(){return!0}route(){return s.ROUTE}type(){return I.type()}}t.RequestSignEIP712CosmosTxMsg_v0=I;class S extends n.Message{static type(){return"request-icns-adr-36-signatures-v2"}constructor(e,t,i,r,n){super(),this.chainId=e,this.contractAddress=t,this.owner=i,this.username=r,this.addressChainIds=n}validateBasic(){if(!this.chainId)throw new Error("chain id not set");if(!this.contractAddress)throw new Error("contract address not set");if(o.Bech32Address.validate(this.contractAddress),!this.owner)throw new Error("signer not set");if(o.Bech32Address.validate(this.owner),!this.username)throw new Error("username not set");if(!this.addressChainIds||0===this.addressChainIds.length)throw new Error("address chain ids not set")}approveExternal(){return!0}route(){return s.ROUTE}type(){return S.type()}}t.RequestICNSAdr36SignaturesMsg=S;class M extends n.Message{static type(){return"EnableVaultsWithCosmosAddressMsg"}constructor(e,t){super(),this.chainId=e,this.bech32Address=t}validateBasic(){if(!this.chainId)throw new Error("chainId is not set");if(!this.bech32Address)throw new Error("bech32Address is not set")}route(){return s.ROUTE}type(){return M.type()}}t.EnableVaultsWithCosmosAddressMsg=M},39301:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingCosmosService=void 0;const s=i(51890),o=i(47235),a=i(75263),c=i(45137),u=i(1800),d=i(48834),l=i(12136),h=n(i(27808)),g=i(81204);class f{constructor(e,t,i,r,n,s){this.chainsService=e,this.keyRingService=t,this.interactionService=i,this.chainsUIService=r,this.analyticsService=n,this.msgPrivilegedOrigins=s}init(){return r(this,void 0,void 0,(function*(){this.chainsService.addChainSuggestedHandler(this.onChainSuggested.bind(this))}))}onChainSuggested(e){return r(this,void 0,void 0,(function*(){if("unlocked"===this.keyRingService.keyRingStatus)try{const t=this.keyRingService.selectedVaultId;if(t&&this.keyRingService.needKeyCoinTypeFinalize(t,e.chainId)){const i=yield this.computeNotFinalizedKeyAddresses(t,e.chainId);1===i.length&&this.keyRingService.finalizeKeyCoinType(t,e.chainId,i[0].coinType)}}catch(e){console.log(e)}}))}getKeySelected(e){return r(this,void 0,void 0,(function*(){return yield this.getKey(this.keyRingService.selectedVaultId,e)}))}getKey(e,t){return r(this,void 0,void 0,(function*(){const i=this.chainsService.getChainInfoOrThrow(t),r=yield this.keyRingService.getPubKey(t,e),n=s.KeyRingService.isEthermintLike(i),o=this.keyRingService.getKeyInfo(e);if(!o)throw new Error("Null key info");n&&"ledger"===o.type&&f.throwErrorIfEthermintWithLedgerButNotSupported(t);const c=n?r.getEthAddress():r.getCosmosAddress(),u=new a.Bech32Address(c);return{name:this.keyRingService.getKeyRingName(e),algo:n?"ethsecp256k1":"secp256k1",pubKey:r.toBytes(),address:c,bech32Address:u.toBech32(i.bech32Config.bech32PrefixAccAddr),isNanoLedger:"ledger"===o.type,isKeystone:"keystone"===o.type}}))}computeNotFinalizedKeyAddresses(e,t){return r(this,void 0,void 0,(function*(){const i=this.chainsService.getChainInfoOrThrow(t),r=[i.bip44.coinType];i.alternativeBIP44s&&r.push(...i.alternativeBIP44s.map((e=>e.coinType)));const n=s.KeyRingService.isEthermintLike(i),o=[];for(const s of r){let r;try{r=yield this.keyRingService.getPubKeyWithNotFinalizedCoinType(t,e,s)}catch(e){console.log(e);continue}const c=n?r.getEthAddress():r.getCosmosAddress(),u=new a.Bech32Address(c);o.push({coinType:s,bech32Address:u.toBech32(i.bech32Config.bech32PrefixAccAddr)})}return o}))}signAminoSelected(e,t,i,n,s,o){return r(this,void 0,void 0,(function*(){return yield this.signAmino(e,t,this.keyRingService.selectedVaultId,i,n,s,o)}))}signAmino(e,t,i,n,o,l,h){return r(this,void 0,void 0,(function*(){const g=this.chainsService.getChainInfoOrThrow(n);if(g.hideInUI)throw new Error("Can't sign for hidden chain");const p=s.KeyRingService.isEthermintLike(g),y=this.keyRingService.getKeyInfo(i);if(!y)throw new Error("Null key info");p&&"ledger"===y.type&&f.throwErrorIfEthermintWithLedgerButNotSupported(n),l=Object.assign(Object.assign({},l),{memo:(0,c.escapeHTML)(l.memo)}),l=(0,u.trimAminoSignDoc)(l),l=(0,c.sortObjectByKey)(l);const v=yield this.getKey(i,n),m=this.chainsService.getChainInfoOrThrow(n).bech32Config.bech32PrefixAccAddr,w=new a.Bech32Address(v.address).toBech32(m);if(o!==w)throw new Error("Signer mismatched");if((0,a.checkAndValidateADR36AminoSignDoc)(l,m)){if(l.msgs[0].value.signer!==o)throw new Error("Unmatched signer in sign doc");return yield this.signAminoADR36(e,t,i,n,o,d.Buffer.from(l.msgs[0].value.data,"base64"),{isADR36WithString:!1})}return yield this.interactionService.waitApproveV2(e,"/sign-cosmos","request-sign-cosmos",{origin:t,chainId:n,mode:"amino",signDoc:l,signer:o,pubKey:v.pubKey,signOptions:h,keyType:y.type,keyInsensitive:y.insensitive},(s=>r(this,void 0,void 0,(function*(){let r,o=s.newSignDoc;if(o=Object.assign(Object.assign({},o),{memo:(0,c.escapeHTML)(o.memo)}),"ledger"===y.type||"keystone"===y.type){if(!s.signature||0===s.signature.length)throw new Error("Frontend should provide signature");r=s.signature}else{const e=yield this.keyRingService.sign(n,i,(0,a.serializeSignDoc)(o),p?"keccak256":"sha256");r=new Uint8Array([...e.r,...e.s])}const u=o.msgs.filter((e=>e.type)).map((e=>e.type));return this.analyticsService.logEventIgnoreError("tx_signed",{chainId:n,isInternal:e.isInternalMsg,origin:t,signMode:"amino",msgTypes:u,isADR36SignDoc:!1}),{signed:o,signature:(0,a.encodeSecp256k1Signature)(v.pubKey,r)}}))))}))}privilegeSignAminoWithdrawRewards(e,t,i,n,d){return r(this,void 0,void 0,(function*(){if(!e.isInternalMsg&&!this.msgPrivilegedOrigins.includes(t))throw new Error("Permission Rejected");const r=this.chainsService.getChainInfoOrThrow(i);if(r.hideInUI)throw new Error("Can't sign for hidden chain");const l=this.keyRingService.selectedVaultId,h=s.KeyRingService.isEthermintLike(r),g=this.keyRingService.getKeyInfo(l);if(!g)throw new Error("Null key info");h&&"ledger"===g.type&&f.throwErrorIfEthermintWithLedgerButNotSupported(i),d=Object.assign(Object.assign({},d),{memo:(0,c.escapeHTML)(d.memo)}),d=(0,u.trimAminoSignDoc)(d),d=(0,c.sortObjectByKey)(d);const p=yield this.getKey(l,i),y=this.chainsService.getChainInfoOrThrow(i).bech32Config.bech32PrefixAccAddr,v=new a.Bech32Address(p.address).toBech32(y);if(n!==v)throw new Error("Signer mismatched");if((0,a.checkAndValidateADR36AminoSignDoc)(d,y))throw new Error("Can't use ADR-36 sign doc");if(!d.msgs||0===d.msgs.length)throw new Error("No msgs");for(const e of d.msgs){const t=e.type.indexOf("/");if(t<0)throw new Error("Invalid msg type");if("MsgWithdrawDelegationReward"!==e.type.slice(t+1))throw new Error("Invalid msg type")}try{const r=yield this.keyRingService.sign(i,l,(0,a.serializeSignDoc)(d),h?"keccak256":"sha256"),n=new Uint8Array([...r.r,...r.s]);return this.analyticsService.logEventIgnoreError("tx_signed",{chainId:i,isInternal:e.isInternalMsg,origin:t,signMode:"amino",privileged:"withdrawRewards"}),{signed:d,signature:(0,a.encodeSecp256k1Signature)(p.pubKey,n)}}finally{this.interactionService.dispatchEvent(o.APP_PORT,"request-sign-end",{})}}))}privilegeSignAminoDelegate(e,t,i,n,d){return r(this,void 0,void 0,(function*(){if(!e.isInternalMsg&&!this.msgPrivilegedOrigins.includes(t))throw new Error("Permission Rejected");const r=this.chainsService.getChainInfoOrThrow(i);if(r.hideInUI)throw new Error("Can't sign for hidden chain");const l=this.keyRingService.selectedVaultId,h=s.KeyRingService.isEthermintLike(r),g=this.keyRingService.getKeyInfo(l);if(!g)throw new Error("Null key info");h&&"ledger"===g.type&&f.throwErrorIfEthermintWithLedgerButNotSupported(i),d=Object.assign(Object.assign({},d),{memo:(0,c.escapeHTML)(d.memo)}),d=(0,u.trimAminoSignDoc)(d),d=(0,c.sortObjectByKey)(d);const p=yield this.getKey(l,i),y=this.chainsService.getChainInfoOrThrow(i).bech32Config.bech32PrefixAccAddr,v=new a.Bech32Address(p.address).toBech32(y);if(n!==v)throw new Error("Signer mismatched");if((0,a.checkAndValidateADR36AminoSignDoc)(d,y))throw new Error("Can't use ADR-36 sign doc");if(!d.msgs||0===d.msgs.length)throw new Error("No msgs");for(const e of d.msgs){const t=e.type.indexOf("/");if(t<0)throw new Error("Invalid msg type");if("MsgDelegate"!==e.type.slice(t+1))throw new Error("Invalid msg type")}try{const r=yield this.keyRingService.sign(i,l,(0,a.serializeSignDoc)(d),h?"keccak256":"sha256"),n=new Uint8Array([...r.r,...r.s]);return this.analyticsService.logEventIgnoreError("tx_signed",{chainId:i,isInternal:e.isInternalMsg,origin:t,signMode:"amino",privileged:"delegate"}),{signed:d,signature:(0,a.encodeSecp256k1Signature)(p.pubKey,n)}}finally{this.interactionService.dispatchEvent(o.APP_PORT,"request-sign-end",{})}}))}signAminoADR36Selected(e,t,i,n,s,o){return r(this,void 0,void 0,(function*(){return yield this.signAminoADR36(e,t,this.keyRingService.selectedVaultId,i,n,s,o)}))}signAminoADR36(e,t,i,n,o,c,u){return r(this,void 0,void 0,(function*(){const d=this.chainsService.getChainInfoOrThrow(n);if(d.hideInUI)throw new Error("Can't sign for hidden chain");const l=s.KeyRingService.isEthermintLike(d),h=this.keyRingService.getKeyInfo(i);if(!h)throw new Error("Null key info");l&&"ledger"===h.type&&f.throwErrorIfEthermintWithLedgerButNotSupported(n);const g=yield this.getKey(i,n),p=this.chainsService.getChainInfoOrThrow(n).bech32Config.bech32PrefixAccAddr,y=new a.Bech32Address(g.address).toBech32(p);if(o!==y)throw new Error("Signer mismatched");const v=(0,a.makeADR36AminoSignDoc)(o,c);return yield this.interactionService.waitApproveV2(e,"/sign-cosmos-adr36","request-sign-cosmos",{origin:t,chainId:n,mode:"amino",signDoc:v,signer:o,pubKey:g.pubKey,signOptions:u,keyType:h.type,keyInsensitive:h.insensitive},(s=>r(this,void 0,void 0,(function*(){const r=s.newSignDoc;if(!(0,a.checkAndValidateADR36AminoSignDoc)(r))throw new Error("Invalid ADR36 sign doc delivered from view");let o;if("ledger"===h.type||"keystone"===h.type){if(!s.signature||0===s.signature.length)throw new Error("Frontend should provide signature");o=s.signature}else{const e=yield this.keyRingService.sign(n,i,(0,a.serializeSignDoc)(r),l?"keccak256":"sha256");o=new Uint8Array([...e.r,...e.s])}const c=r.msgs.filter((e=>e.type)).map((e=>e.type));return this.analyticsService.logEventIgnoreError("tx_signed",{chainId:n,isInternal:e.isInternalMsg,origin:t,signMode:"amino",msgTypes:c,isADR36SignDoc:!0}),{signed:r,signature:(0,a.encodeSecp256k1Signature)(g.pubKey,o)}}))))}))}signDirect(e,t,i,n,o,c,u){return r(this,void 0,void 0,(function*(){const d=this.chainsService.getChainInfoOrThrow(n);if(d.hideInUI)throw new Error("Can't sign for hidden chain");const g=s.KeyRingService.isEthermintLike(d),p=this.keyRingService.getKeyInfo(i);if(!p)throw new Error("Null key info");g&&"ledger"===p.type&&f.throwErrorIfEthermintWithLedgerButNotSupported(n);const y=yield this.getKey(i,n),v=this.chainsService.getChainInfoOrThrow(n).bech32Config.bech32PrefixAccAddr,m=new a.Bech32Address(y.address).toBech32(v);if(o!==m)throw new Error("Signer mismatched");return yield this.interactionService.waitApproveV2(e,"/sign-cosmos","request-sign-cosmos",{origin:t,chainId:n,mode:"direct",signDocBytes:l.SignDoc.encode(c).finish(),signer:o,pubKey:y.pubKey,signOptions:u,keyType:p.type,keyInsensitive:p.insensitive},(s=>r(this,void 0,void 0,(function*(){const r=s.newSignDocBytes,o=l.SignDoc.decode(r);let c;if("ledger"===p.type||"keystone"===p.type){if(!s.signature||0===s.signature.length)throw new Error("Frontend should provide signature");c=s.signature}else{const e=yield this.keyRingService.sign(n,i,r,g?"keccak256":"sha256");c=new Uint8Array([...e.r,...e.s])}const u=l.TxBody.decode(o.bodyBytes).messages.map((e=>e.typeUrl));return this.analyticsService.logEventIgnoreError("tx_signed",{chainId:n,isInternal:e.isInternalMsg,origin:t,signMode:"direct",msgTypes:u}),{signed:Object.assign(Object.assign({},o),{accountNumber:h.default.fromString(o.accountNumber)}),signature:(0,a.encodeSecp256k1Signature)(y.pubKey,c)}}))))}))}signDirectSelected(e,t,i,n,s,o){return r(this,void 0,void 0,(function*(){return yield this.signDirect(e,t,this.keyRingService.selectedVaultId,i,n,s,o)}))}signDirectAux(e,t,i,n,o,c,u){return r(this,void 0,void 0,(function*(){const d=this.chainsService.getChainInfoOrThrow(n);if(d.hideInUI)throw new Error("Can't sign for hidden chain");const g=s.KeyRingService.isEthermintLike(d),p=this.keyRingService.getKeyInfo(i);if(!p)throw new Error("Null key info");g&&"ledger"===p.type&&f.throwErrorIfEthermintWithLedgerButNotSupported(n);const y=yield this.getKey(i,n),v=this.chainsService.getChainInfoOrThrow(n).bech32Config.bech32PrefixAccAddr,m=new a.Bech32Address(y.address).toBech32(v);if(o!==m)throw new Error("Signer mismatched");return yield this.interactionService.waitApproveV2(e,"/sign-cosmos","request-sign-cosmos",{origin:t,chainId:n,mode:"direct",signDocBytes:l.SignDocDirectAux.encode(c).finish(),isDirectAux:!0,signer:o,pubKey:y.pubKey,signOptions:{preferNoSetMemo:u.preferNoSetMemo,disableBalanceCheck:!0,preferNoSetFee:!0},keyType:p.type,keyInsensitive:p.insensitive},(s=>r(this,void 0,void 0,(function*(){const r=s.newSignDocBytes,o=l.SignDocDirectAux.decode(r);let c;if("ledger"===p.type||"keystone"===p.type){if(!s.signature||0===s.signature.length)throw new Error("Frontend should provide signature");c=s.signature}else{const e=yield this.keyRingService.sign(n,i,r,g?"keccak256":"sha256");c=new Uint8Array([...e.r,...e.s])}const u=l.TxBody.decode(o.bodyBytes).messages.map((e=>e.typeUrl));return this.analyticsService.logEventIgnoreError("tx_signed",{chainId:n,isInternal:e.isInternalMsg,origin:t,signMode:"direct",isDirectAux:!0,msgTypes:u}),{signed:Object.assign(Object.assign({},o),{accountNumber:h.default.fromString(o.accountNumber),sequence:h.default.fromString(o.sequence)}),signature:(0,a.encodeSecp256k1Signature)(y.pubKey,c)}}))))}))}signDirectAuxSelected(e,t,i,n,s,o){return r(this,void 0,void 0,(function*(){return yield this.signDirectAux(e,t,this.keyRingService.selectedVaultId,i,n,s,o)}))}verifyAminoADR36Selected(e,t,i,n){return r(this,void 0,void 0,(function*(){return yield this.verifyAminoADR36(this.keyRingService.selectedVaultId,e,t,i,n)}))}verifyAminoADR36(e,t,i,n,o){return r(this,void 0,void 0,(function*(){const r=this.chainsService.getChainInfoOrThrow(t),c=s.KeyRingService.isEthermintLike(r),u=yield this.getKey(e,t),l=r.bech32Config.bech32PrefixAccAddr,h=new a.Bech32Address(u.address).toBech32(l);if(i!==h)throw new Error("Signer mismatched");if("tendermint/PubKeySecp256k1"!==o.pub_key.type)throw new Error(`Unsupported type of pub key: ${o.pub_key.type}`);if(d.Buffer.from(u.pubKey).toString("base64")!==o.pub_key.value)throw new Error("Pub key unmatched");const g=(0,a.makeADR36AminoSignDoc)(i,n);return(0,a.verifyADR36AminoSignDoc)(l,g,d.Buffer.from(o.pub_key.value,"base64"),d.Buffer.from(o.signature,"base64"),c?"ethsecp256k1":"secp256k1")}))}requestSignEIP712CosmosTx_v0_selected(e,t,i,n,s,o,a){return r(this,void 0,void 0,(function*(){return this.requestSignEIP712CosmosTx_v0(e,this.keyRingService.selectedVaultId,t,i,n,s,o,a)}))}requestSignEIP712CosmosTx_v0(e,t,i,n,o,l,h,g){return r(this,void 0,void 0,(function*(){const p=this.chainsService.getChainInfoOrThrow(n);if(p.hideInUI)throw new Error("Can't sign for hidden chain");const y=s.KeyRingService.isEthermintLike(p);if(!y)throw new Error("This feature is only usable on cosmos-sdk evm chain");const v=this.keyRingService.getKeyInfo(t);if(!v)throw new Error("Null key info");if("ledger"!==v.type)throw new Error("This feature is only usable on ledger ethereum app");y&&"ledger"===v.type&&f.throwErrorIfEthermintWithLedgerButNotSupported(n),h=Object.assign(Object.assign({},h),{memo:(0,c.escapeHTML)(h.memo)}),h=(0,u.trimAminoSignDoc)(h),h=(0,c.sortObjectByKey)(h);const m=yield this.getKey(t,n),w=this.chainsService.getChainInfoOrThrow(n).bech32Config.bech32PrefixAccAddr,b=new a.Bech32Address(m.address).toBech32(w);if(o!==b)throw new Error("Signer mismatched");return yield this.interactionService.waitApproveV2(e,"/sign-cosmos","request-sign-cosmos",{origin:i,chainId:n,mode:"amino",signDoc:h,signer:o,pubKey:m.pubKey,signOptions:g,eip712:l,keyType:v.type,keyInsensitive:v.insensitive},(t=>r(this,void 0,void 0,(function*(){let r=t.newSignDoc;if(r=Object.assign(Object.assign({},r),{memo:(0,c.escapeHTML)(r.memo)}),!t.signature||0===t.signature.length)throw new Error("Frontend should provide signature");const s=r.msgs.filter((e=>e.type)).map((e=>e.type));return this.analyticsService.logEventIgnoreError("tx_signed",{chainId:n,isInternal:e.isInternalMsg,origin:i,ethSignType:"eip-712",msgTypes:s}),{signed:r,signature:{pub_key:(0,a.encodeSecp256k1Pubkey)(m.pubKey),signature:d.Buffer.from(t.signature).toString("base64")}}}))))}))}requestICNSAdr36SignaturesSelected(e,t,i,n,s,o,a){return r(this,void 0,void 0,(function*(){return yield this.requestICNSAdr36Signatures(e,t,this.keyRingService.selectedVaultId,i,n,s,o,a)}))}requestICNSAdr36Signatures(e,t,i,n,o,c,u,d){return r(this,void 0,void 0,(function*(){const l={chainId:n,owner:c,username:u,origin:t,accountInfos:[]};{const e=this.chainsService.getChainInfoOrThrow(n);if(e.hideInUI)throw new Error("Can't sign for hidden chain");a.Bech32Address.validate(o,e.bech32Config.bech32PrefixAccAddr);const t=yield this.getKey(i,n),r=new a.Bech32Address(t.address).toBech32(e.bech32Config.bech32PrefixAccAddr);if(r!==c)throw new Error(`Unmatched owner: (expected: ${r}, actual: ${c})`)}const h=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);for(const e of d){const t=this.chainsService.getChainInfoOrThrow(e),r=yield this.getKey(i,e),n=new a.Bech32Address(r.address).toBech32(t.bech32Config.bech32PrefixAccAddr);l.accountInfos.push({chainId:t.chainId,bech32Prefix:t.bech32Config.bech32PrefixAccAddr,bech32Address:n,pubKey:r.pubKey})}return yield this.interactionService.waitApproveV2(e,"/sign-cosmos-icns","request-sign-icns-adr36",l,(()=>r(this,void 0,void 0,(function*(){const e=[],t=a.Bech32Address.fromBech32(c);for(const r of l.accountInfos){const d=s.KeyRingService.isEthermintLike(this.chainsService.getChainInfoOrThrow(r.chainId));if(t.toHex(!1)!==a.Bech32Address.fromBech32(r.bech32Address).toHex(!1)){const t=`The following is the information for ICNS registration for ${u}.${r.bech32Prefix}.\n\nChain id: ${n}\nContract Address: ${o}\nOwner: ${c}\nSalt: ${h}`,s=(0,a.makeADR36AminoSignDoc)(r.bech32Address,t),l=yield this.keyRingService.sign(r.chainId,i,(0,a.serializeSignDoc)(s),d?"keccak256":"sha256"),f=new Uint8Array([...l.r,...l.s]);e.push({chainId:r.chainId,bech32Prefix:r.bech32Prefix,bech32Address:r.bech32Address,addressHash:d?"ethereum":"cosmos",pubKey:new g.PubKeySecp256k1(r.pubKey).toBytes(d),signatureSalt:h,signature:f})}else e.push({chainId:r.chainId,bech32Prefix:r.bech32Prefix,bech32Address:r.bech32Address,addressHash:d?"ethereum":"cosmos",pubKey:new g.PubKeySecp256k1(r.pubKey).toBytes(d),signatureSalt:0,signature:new Uint8Array(0)})}return e}))))}))}legacySignArbitraryInternal(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.keyRingService.sign(e,this.keyRingService.selectedVaultId,d.Buffer.from(JSON.stringify({account_number:0,chain_id:e,fee:[],memo:t,msgs:[],sequence:0})),"sha256");return new Uint8Array([...i.r,...i.s])}))}enableVaultsWithCosmosAddress(e,t){var i;return r(this,void 0,void 0,(function*(){const r=this.chainsService.getChainInfo(e);if(!r)throw new Error("ChainInfo not found");if(!t)throw new Error("Bech32Address is empty");a.Bech32Address.validate(t,r.bech32Config.bech32PrefixAccAddr);const n=new Set,s=this.keyRingService.getKeyInfos();for(const o of s)if(!(this.chainsUIService.isEnabled(o.id,e)||this.keyRingService.needKeyCoinTypeFinalize(o.id,e)&&0!==(null!==(i=r.alternativeBIP44s)&&void 0!==i?i:[]).length)){let i;try{i=yield this.getKey(o.id,e)}catch(e){console.log(e);continue}i.bech32Address===t&&(this.keyRingService.needKeyCoinTypeFinalize(o.id,e)&&this.keyRingService.finalizeKeyCoinType(o.id,e,r.bip44.coinType),this.chainsUIService.enableChain(o.id,e),n.add(o.id))}const o=[];for(const e of n)o.push({vaultId:e,newEnabledChains:this.chainsUIService.enabledChainIdentifiersForVault(e)});return o}))}static throwErrorIfEthermintWithLedgerButNotSupported(e){if(!e.startsWith("evmos_")&&!e.startsWith("injective")&&!e.startsWith("dymension_"))throw new o.KeplrError("keyring",152,"Ledger is unsupported for this chain")}}t.KeyRingCosmosService=f},56142:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="keyring-ethereum"},77680:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(54137);t.getHandler=(e,t)=>(i,r)=>{if(r.constructor===s.RequestSignEthereumMsg)return o(e,t)(i,r);throw new n.KeplrError("keyring",221,"Unknown msg type")};const o=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.signEthereumSelected(i,n.origin,n.chainId,n.signer,n.message,n.signType)}))},17280:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(54137),t),n(i(26508),t)},91040:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(54137),n=i(56142),s=i(77680);t.init=function(e,t,i){e.registerMessage(r.RequestSignEthereumMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t,i))}},63754:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(26508),t),n(i(91040),t)},54137:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestSignEthereumMsg=void 0;const r=i(75263),n=i(47235),s=i(56142);class o extends n.Message{static type(){return"request-sign-ethereum"}constructor(e,t,i,r){super(),this.chainId=e,this.signer=t,this.message=i,this.signType=r}validateBasic(){if(!this.chainId)throw new Error("chain id not set");if(!this.signer)throw new Error("signer not set");if(!this.signType)throw new Error("sign type not set");try{r.Bech32Address.validate(this.signer)}catch(e){const t="0x"===this.signer.substring(0,2)?this.signer:"0x"+this.signer;if(!t.match(/^0x[0-9A-Fa-f]*$/)||42!==t.length)throw new Error("Signer is not valid hex address")}}approveExternal(){return!0}route(){return s.ROUTE}type(){return o.type()}}t.RequestSignEthereumMsg=o},26508:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingEthereumService=void 0;const n=i(51890),s=i(34046),o=i(75263),a=i(48834),c=i(60604),u=i(75960);class d{constructor(e,t,i,r,n){this.chainsService=e,this.keyRingService=t,this.keyRingCosmosService=i,this.interactionService=r,this.analyticsService=n}init(){return r(this,void 0,void 0,(function*(){}))}signEthereumSelected(e,t,i,n,s,o){return r(this,void 0,void 0,(function*(){return yield this.signEthereum(e,t,this.keyRingService.selectedVaultId,i,n,s,o)}))}signEthereum(e,t,i,l,h,g,f){return r(this,void 0,void 0,(function*(){const p=this.chainsService.getChainInfoOrThrow(l);if(p.hideInUI)throw new Error("Can't sign for hidden chain");const y=n.KeyRingService.isEthermintLike(p),v=d.evmInfo(p);if(!y&&!v)throw new Error("Not ethermint like and EVM chain");const m=this.keyRingService.getKeyInfo(i);if(!m)throw new Error("Null key info");"ledger"===m.type&&c.KeyRingCosmosService.throwErrorIfEthermintWithLedgerButNotSupported(l);try{o.Bech32Address.validate(h)}catch(e){h=("0x"===h.substring(0,2)?h:"0x"+h).toLowerCase()}const w=yield this.keyRingCosmosService.getKey(i,l),b=this.chainsService.getChainInfoOrThrow(l).bech32Config.bech32PrefixAccAddr,I=new o.Bech32Address(w.address).toBech32(b),S=o.Bech32Address.fromBech32(I,b).toHex(!1);if(h!==I&&h!==S)throw new Error("Signer mismatched");return yield this.interactionService.waitApproveV2(e,"/sign-ethereum","request-sign-ethereum",{origin:t,chainId:l,signer:h,pubKey:w.pubKey,message:g,signType:f,keyType:m.type,keyInsensitive:m.insensitive},(e=>r(this,void 0,void 0,(function*(){if("ledger"===m.type||"keystone"===m.type){if(!e.signature||0===e.signature.length)throw new Error("Frontend should provide signature");return e.signature}switch(f){case s.EthSignType.MESSAGE:{const e=yield this.keyRingService.sign(l,i,a.Buffer.concat([a.Buffer.from("Ethereum Signed Message:\n"),a.Buffer.from(g.length.toString()),g]),"keccak256");return a.Buffer.concat([e.r,e.s,e.v?a.Buffer.from("1c","hex"):a.Buffer.from("1b","hex")])}case s.EthSignType.TRANSACTION:{const e=JSON.parse(a.Buffer.from(g).toString()),t=yield this.keyRingService.sign(l,i,a.Buffer.from((0,u.serialize)(e).replace("0x",""),"hex"),"keccak256");return a.Buffer.concat([t.r,t.s,t.v?a.Buffer.from("1c","hex"):a.Buffer.from("1b","hex")])}case s.EthSignType.EIP712:{const e=yield c.EIP712MessageValidator.validateAsync(JSON.parse(a.Buffer.from(g).toString())),t=yield this.keyRingService.sign(l,i,a.Buffer.concat([a.Buffer.from("19","hex"),a.Buffer.from("01","hex"),a.Buffer.from((0,c.domainHash)(e).replace("0x",""),"hex"),a.Buffer.from((0,c.messageHash)(e).replace("0x",""),"hex")]),"keccak256");return a.Buffer.concat([t.r,t.s,t.v?a.Buffer.from("1c","hex"):a.Buffer.from("1b","hex")])}default:throw new Error(`Unknown sign type: ${f}`)}}))))}))}static evmInfo(e){return e.evm}}t.KeyRingEthereumService=d},56046:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(46389),t),n(i(35345),t)},35441:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(46389),t),n(i(35345),t)},46389:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingKeystoneService=void 0;const n=i(48834),s=i(81204),o=i(51890);t.KeyRingKeystoneService=class{init(){return r(this,void 0,void 0,(function*(){}))}supportedKeyRingType(){return"keystone"}createKeyRingVault(e){const t={};return e.keys.forEach((e=>{t[e.path]={pubKey:e.publicKey,chain:e.chain,name:e.name}})),Promise.resolve({insensitive:{xfp:e.masterFingerprint,device:e.device,deviceId:e.deviceId,keys:t},sensitive:{}})}getPubKey(e,t){let i;if(!e.insensitive.keys)throw new Error("Keystone is not initialized.");{const r=Object.keys(e.insensitive.keys).find((e=>o.KeyRingService.parseBIP44Path(e).coinType===t));if(!r)throw new Error(`CoinType ${t} is not supported.`);i=n.Buffer.from(e.insensitive.keys[r].pubKey,"hex")}return new s.PubKeySecp256k1(i)}sign(){throw new Error("Keystone can't sign message in background. You should provide the signature from frontend.")}}},35345:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},88956:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(64515),t)},64515:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingLedgerService=void 0;const n=i(48834),s=i(81204),o=i(47235),a=i(51890);t.KeyRingLedgerService=class{init(){return r(this,void 0,void 0,(function*(){}))}supportedKeyRingType(){return"ledger"}createKeyRingVault(e,t,i){return Promise.resolve({insensitive:{[t]:{pubKey:n.Buffer.from(e).toString("hex")},bip44Path:i},sensitive:{}})}getPubKey(e,t,i){let r="Cosmos";if(a.KeyRingService.isEthermintLike(i)&&(r="Ethereum",!e.insensitive[r]))throw new o.KeplrError("keyring",901,"No Ethereum public key. Initialize Ethereum app on Ledger by selecting the chain in the extension");if("Cosmos"===r&&(e.insensitive.Terra&&(r="Terra"),e.insensitive.Secret&&(r="Secret")),!e.insensitive[r])throw new Error(`Ledger is not initialized for ${r}`);const c=n.Buffer.from(e.insensitive[r].pubKey,"hex");return new s.PubKeySecp256k1(c)}sign(){throw new Error("Ledger can't sign message in background. You should provide the signature from frontend.")}}},57264:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(51292),t)},51292:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingMnemonicService=void 0;const n=i(48834),s=i(81204),o=i(36832);t.KeyRingMnemonicService=class{constructor(e){this.vaultService=e}init(){return r(this,void 0,void 0,(function*(){}))}supportedKeyRingType(){return"mnemonic"}createKeyRingVault(e,t){if(!e||"string"!=typeof e)throw new Error("Invalid arguments");try{o.mnemonicToEntropy(e)}catch(e){if("Invalid mnemonic checksum"!==e.message)throw e}const i=s.Mnemonic.generateMasterSeedFromMnemonic(e),r=n.Buffer.from(i).toString("hex");return Promise.resolve({insensitive:{bip44Path:t},sensitive:{masterSeedText:r,mnemonic:e}})}getPubKey(e,t){const i=this.getBIP44PathFromVault(e),r=`pubKey-m/44'/${t}'/${i.account}'/${i.change}/${i.addressIndex}`;if(e.insensitive[r]){const t=n.Buffer.from(e.insensitive[r],"hex");return new s.PubKeySecp256k1(t)}const o=this.getPrivKey(e,t).getPubKey(),a=n.Buffer.from(o.toBytes()).toString("hex");return this.vaultService.setAndMergeInsensitiveToVault("keyRing",e.id,{[r]:a}),o}sign(e,t,i,r){const n=this.getPrivKey(e,t);let o=new Uint8Array;switch(r){case"sha256":o=s.Hash.sha256(i);break;case"keccak256":o=s.Hash.keccak256(i);break;default:throw new Error(`Unknown digest method: ${r}`)}return n.signDigest32(o)}getPrivKey(e,t){const i=this.getBIP44PathFromVault(e),r=this.vaultService.decrypt(e.sensitive).masterSeedText;if(!r)throw new Error("masterSeedText is null");const o=n.Buffer.from(r,"hex");return new s.PrivKeySecp256k1(s.Mnemonic.generatePrivateKeyFromMasterSeed(o,`m/44'/${t}'/${i.account}'/${i.change}/${i.addressIndex}`))}getBIP44PathFromVault(e){return e.insensitive.bip44Path}}},73416:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(34241),t)},34241:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingPrivateKeyService=void 0;const n=i(48834),s=i(81204);t.KeyRingPrivateKeyService=class{constructor(e){this.vaultService=e}init(){return r(this,void 0,void 0,(function*(){}))}supportedKeyRingType(){return"private-key"}createKeyRingVault(e){if(!e||0===e.length)throw new Error("Invalid arguments");const t=n.Buffer.from(new s.PrivKeySecp256k1(e).getPubKey().toBytes()).toString("hex");return Promise.resolve({insensitive:{publicKey:t},sensitive:{privateKey:n.Buffer.from(e).toString("hex")}})}getPubKey(e){const t=n.Buffer.from(e.insensitive.publicKey,"hex");return new s.PubKeySecp256k1(t)}sign(e,t,i,r){const o=this.vaultService.decrypt(e.sensitive).privateKey,a=new s.PrivKeySecp256k1(n.Buffer.from(o,"hex"));let c=new Uint8Array;switch(r){case"sha256":c=s.Hash.sha256(i);break;case"keccak256":c=s.Hash.keccak256(i);break;default:throw new Error(`Unknown digest method: ${r}`)}return a.signDigest32(c)}}},86473:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="keyring-v2"},21792:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(71643);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.GetKeyRingStatusMsg:return o(e)(t,i);case s.GetKeyRingStatusOnlyMsg:return a(e)(t,i);case s.SelectKeyRingMsg:return c(e)(t,i);case s.LockKeyRingMsg:return u(e)(t,i);case s.UnlockKeyRingMsg:return d(e)(t,i);case s.FinalizeKeyCoinTypeMsg:return l(e)(t,i);case s.NewMnemonicKeyMsg:return h(e)(t,i);case s.NewLedgerKeyMsg:return g(e)(t,i);case s.NewKeystoneKeyMsg:return f(e)(t,i);case s.NewPrivateKeyKeyMsg:return p(e)(t,i);case s.AppendLedgerKeyAppMsg:return y(e)(t,i);case s.ChangeKeyRingNameMsg:return v(e)(t,i);case s.DeleteKeyRingMsg:return m(e)(t,i);case s.ShowSensitiveKeyRingDataMsg:return w(e)(t,i);case s.ChangeUserPasswordMsg:return b(e)(t,i);case s.ChangeKeyRingNameInteractiveMsg:return I(e)(t,i);case s.ExportKeyRingDataMsg:return S(e)(t,i);case s.CheckLegacyKeyRingPasswordMsg:return M(e)(t,i);case s.ExportKeyRingVaultsMsg:return k(e)(t,i);default:throw new n.KeplrError("keyring",221,"Unknown msg type")}};const o=e=>()=>({status:e.keyRingStatus,keyInfos:e.getKeyInfos(),needMigration:e.needMigration,isMigrating:e.isMigrating}),a=e=>()=>({status:e.keyRingStatus}),c=e=>(t,i)=>(e.selectKeyRing(i.vaultId),{status:e.keyRingStatus,keyInfos:e.getKeyInfos()}),u=e=>()=>(e.lockKeyRing(),{status:e.keyRingStatus}),d=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.unlockKeyRing(i.password),{status:e.keyRingStatus,keyInfos:e.getKeyInfos()}})),l=e=>(t,i)=>(e.finalizeKeyCoinType(i.id,i.chainId,i.coinType),{status:e.keyRingStatus,keyInfos:e.getKeyInfos()}),h=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return{vaultId:yield e.createMnemonicKeyRing(i.mnemonic,i.bip44HDPath,i.name,i.password),status:e.keyRingStatus,keyInfos:e.getKeyInfos()}})),g=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return{vaultId:yield e.createLedgerKeyRing(i.pubKey,i.app,i.bip44HDPath,i.name,i.password),status:e.keyRingStatus,keyInfos:e.getKeyInfos()}})),f=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return{vaultId:yield e.createKeystoneKeyRing(i.multiAccounts,i.name,i.password),status:e.keyRingStatus,keyInfos:e.getKeyInfos()}})),p=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return{vaultId:yield e.createPrivateKeyKeyRing(i.privateKey,i.meta,i.name,i.password),status:e.keyRingStatus,keyInfos:e.getKeyInfos()}})),y=e=>(t,i)=>(e.appendLedgerKeyRing(i.vaultId,i.pubKey,i.app),{status:e.keyRingStatus,keyInfos:e.getKeyInfos()}),v=e=>(t,i)=>(e.changeKeyRingName(i.vaultId,i.name),{status:e.keyRingStatus,keyInfos:e.getKeyInfos()}),m=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return{wasSelected:yield e.deleteKeyRing(i.vaultId,i.password),status:e.keyRingStatus,keyInfos:e.getKeyInfos()}})),w=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.showSensitiveKeyRingData(i.vaultId,i.password)})),b=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.changeUserPassword(i.prevUserPassword,i.newUserPassword)})),I=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.ensureUnlockInteractive(t),yield e.changeKeyRingNameInteractive(t,e.selectedVaultId,i.defaultName,i.editable)})),S=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.exportKeyRingData(i.password)})),M=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.checkLegacyKeyRingPassword(i.password)})),k=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.exportKeyRingVaults(i.password)}))},51890:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingLegacy=void 0,s(i(15253),t),s(i(71643),t),s(i(38860),t),t.KeyRingLegacy=o(i(45014))},84381:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(71643),n=i(86473),s=i(21792);t.init=function(e,t){e.registerMessage(r.GetKeyRingStatusMsg),e.registerMessage(r.GetKeyRingStatusOnlyMsg),e.registerMessage(r.SelectKeyRingMsg),e.registerMessage(r.FinalizeKeyCoinTypeMsg),e.registerMessage(r.NewMnemonicKeyMsg),e.registerMessage(r.NewLedgerKeyMsg),e.registerMessage(r.NewKeystoneKeyMsg),e.registerMessage(r.NewPrivateKeyKeyMsg),e.registerMessage(r.AppendLedgerKeyAppMsg),e.registerMessage(r.LockKeyRingMsg),e.registerMessage(r.UnlockKeyRingMsg),e.registerMessage(r.ChangeKeyRingNameMsg),e.registerMessage(r.DeleteKeyRingMsg),e.registerMessage(r.ShowSensitiveKeyRingDataMsg),e.registerMessage(r.ChangeUserPasswordMsg),e.registerMessage(r.ChangeKeyRingNameInteractiveMsg),e.registerMessage(r.ExportKeyRingDataMsg),e.registerMessage(r.CheckLegacyKeyRingPasswordMsg),e.registerMessage(r.ExportKeyRingVaultsMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},35421:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(38860),t),n(i(84381),t)},37340:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},o=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Crypto=void 0;const c=s(i(8202)),u=i(81204),d=a(i(30499)),l=i(48834);t.Crypto=class{static encrypt(e,t,i,r,n,s,a){return o(this,void 0,void 0,(function*(){let h=new Uint8Array(32);crypto.getRandomValues(h);const g=l.Buffer.from(h).toString("hex"),f={salt:g,dklen:32,n:131072,r:8,p:1},p=yield(()=>o(this,void 0,void 0,(function*(){switch(t){case"scrypt":return yield e.scrypt(n,f);case"sha256":return u.Hash.sha256(l.Buffer.from(`${g}/${n}`));case"pbkdf2":return new Promise(((e,t)=>{d.default.pbkdf2(n,g,4e3,32,"sha256",((i,r)=>{i?t(i):e(new Uint8Array(r))}))}));default:throw new Error("Unknown kdf")}})))(),y=l.Buffer.from(r);h=new Uint8Array(16),crypto.getRandomValues(h);const v=l.Buffer.from(h),m=new c.Counter(0);m.setBytes(v);const w=new c.default.ModeOfOperation.ctr(p,m),b=l.Buffer.from(w.encrypt(y)),I=u.Hash.sha256(l.Buffer.concat([l.Buffer.from(p.slice(p.length/2)),b]));return{version:"1.2",type:i,coinTypeForChain:{},bip44HDPath:a,meta:s,crypto:{cipher:"aes-128-ctr",cipherparams:{iv:v.toString("hex")},ciphertext:b.toString("hex"),kdf:t,kdfparams:f,mac:l.Buffer.from(I).toString("hex")}}}))}static decrypt(e,t,i){return o(this,void 0,void 0,(function*(){const r=yield(()=>o(this,void 0,void 0,(function*(){switch(t.crypto.kdf){case"scrypt":return yield e.scrypt(i,t.crypto.kdfparams);case"sha256":return u.Hash.sha256(l.Buffer.from(`${t.crypto.kdfparams.salt}/${i}`));case"pbkdf2":return new Promise(((e,r)=>{d.default.pbkdf2(i,t.crypto.kdfparams.salt,4e3,32,"sha256",((t,i)=>{t?r(t):e(new Uint8Array(i))}))}));default:throw new Error("Unknown kdf")}})))(),n=new c.Counter(0);n.setBytes(l.Buffer.from(t.crypto.cipherparams.iv,"hex"));const s=new c.default.ModeOfOperation.ctr(r,n),a=u.Hash.sha256(l.Buffer.concat([l.Buffer.from(r.slice(r.length/2)),l.Buffer.from(t.crypto.ciphertext,"hex")]));if(!l.Buffer.from(a).equals(l.Buffer.from(t.crypto.mac,"hex")))throw new Error("Unmatched mac");return l.Buffer.from(s.decrypt(l.Buffer.from(t.crypto.ciphertext,"hex")))}))}}},45014:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(37340),t),n(i(645),t)},645:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},71643:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckLegacyKeyRingPasswordMsg=t.ExportKeyRingDataMsg=t.ExportKeyRingVaultsMsg=t.ChangeUserPasswordMsg=t.ShowSensitiveKeyRingDataMsg=t.DeleteKeyRingMsg=t.ChangeKeyRingNameInteractiveMsg=t.ChangeKeyRingNameMsg=t.UnlockKeyRingMsg=t.LockKeyRingMsg=t.AppendLedgerKeyAppMsg=t.NewPrivateKeyKeyMsg=t.NewKeystoneKeyMsg=t.NewLedgerKeyMsg=t.NewMnemonicKeyMsg=t.FinalizeKeyCoinTypeMsg=t.SelectKeyRingMsg=t.GetKeyRingStatusOnlyMsg=t.GetKeyRingStatusMsg=void 0;const r=i(47235),n=i(36832),s=i(86473);class o extends r.Message{static type(){return"get-keyring-status"}constructor(){super()}validateBasic(){}route(){return s.ROUTE}type(){return o.type()}}t.GetKeyRingStatusMsg=o;class a extends r.Message{static type(){return"get-keyring-status-only"}constructor(){super()}validateBasic(){}route(){return s.ROUTE}type(){return a.type()}}t.GetKeyRingStatusOnlyMsg=a;class c extends r.Message{static type(){return"select-keyring"}constructor(e){super(),this.vaultId=e}validateBasic(){if(!this.vaultId)throw new Error("Vault id not set")}route(){return s.ROUTE}type(){return c.type()}}t.SelectKeyRingMsg=c;class u extends r.Message{static type(){return"finalize-key-coin-type"}constructor(e,t,i){super(),this.id=e,this.chainId=t,this.coinType=i}validateBasic(){if(!this.id)throw new Error("id not set");if(!this.chainId)throw new Error("chainId not set")}route(){return s.ROUTE}type(){return u.type()}}t.FinalizeKeyCoinTypeMsg=u;class d extends r.Message{static type(){return"new-mnemonic-key"}constructor(e,t,i,r){super(),this.mnemonic=e,this.bip44HDPath=t,this.name=i,this.password=r}validateBasic(){if(!this.mnemonic)throw new Error("mnemonic not set");if(!this.name)throw new Error("name not set");try{n.mnemonicToEntropy(this.mnemonic)}catch(e){if("Invalid mnemonic checksum"!==e.message)throw e}}route(){return s.ROUTE}type(){return d.type()}}t.NewMnemonicKeyMsg=d;class l extends r.Message{static type(){return"new-ledger-key"}constructor(e,t,i,r,n){super(),this.pubKey=e,this.app=t,this.bip44HDPath=i,this.name=r,this.password=n}validateBasic(){if(!this.pubKey||0===this.pubKey.length)throw new Error("pub key not set");if(!this.app)throw new Error("app not set");if(!this.name)throw new Error("name not set")}route(){return s.ROUTE}type(){return l.type()}}t.NewLedgerKeyMsg=l;class h extends r.Message{static type(){return"new-keystone-key"}constructor(e,t,i){super(),this.multiAccounts=e,this.name=t,this.password=i}validateBasic(){if(!this.multiAccounts||0===this.multiAccounts.keys.length)throw new Error("pub key not set");if(!this.multiAccounts.masterFingerprint)throw new Error("masterFingerprint not set");if(!this.name)throw new Error("name not set")}route(){return s.ROUTE}type(){return h.type()}}t.NewKeystoneKeyMsg=h;class g extends r.Message{static type(){return"new-private-key-key"}constructor(e,t,i,r){super(),this.privateKey=e,this.meta=t,this.name=i,this.password=r}validateBasic(){if(!this.privateKey||0===this.privateKey.length)throw new Error("priv key not set");if(!this.meta)throw new Error("meta not set");if(!this.name)throw new Error("name not set")}route(){return s.ROUTE}type(){return g.type()}}t.NewPrivateKeyKeyMsg=g;class f extends r.Message{static type(){return"append-ledger-key-app"}constructor(e,t,i){super(),this.vaultId=e,this.pubKey=t,this.app=i}validateBasic(){if(!this.pubKey||0===this.pubKey.length)throw new Error("pub key not set");if(!this.app)throw new Error("app not set");if(!this.vaultId)throw new Error("vault id not set")}route(){return s.ROUTE}type(){return f.type()}}t.AppendLedgerKeyAppMsg=f;class p extends r.Message{static type(){return"lock-keyring"}constructor(){super()}validateBasic(){}route(){return s.ROUTE}type(){return p.type()}}t.LockKeyRingMsg=p;class y extends r.Message{static type(){return"unlock-keyring"}constructor(e){super(),this.password=e}validateBasic(){if(!this.password)throw new Error("password not set")}route(){return s.ROUTE}type(){return y.type()}}t.UnlockKeyRingMsg=y;class v extends r.Message{static type(){return"change-keyring-name"}constructor(e,t){super(),this.vaultId=e,this.name=t}validateBasic(){if(!this.vaultId)throw new Error("vaultId not set");if(!this.name)throw new Error("name not set")}route(){return s.ROUTE}type(){return v.type()}}t.ChangeKeyRingNameMsg=v;class m extends r.Message{static type(){return"change-keyring-name-interactive"}constructor(e,t){super(),this.defaultName=e,this.editable=t}validateBasic(){}approveExternal(){return!0}route(){return s.ROUTE}type(){return m.type()}}t.ChangeKeyRingNameInteractiveMsg=m;class w extends r.Message{static type(){return"v2/delete-keyring"}constructor(e,t){super(),this.vaultId=e,this.password=t}validateBasic(){if(!this.vaultId)throw new Error("vaultId not set");if(!this.password)throw new Error("password not set")}route(){return s.ROUTE}type(){return w.type()}}t.DeleteKeyRingMsg=w;class b extends r.Message{static type(){return"show-sensitive-keyring-data"}constructor(e,t){super(),this.vaultId=e,this.password=t}validateBasic(){if(!this.vaultId)throw new Error("vaultId not set");if(!this.password)throw new Error("password not set")}route(){return s.ROUTE}type(){return b.type()}}t.ShowSensitiveKeyRingDataMsg=b;class I extends r.Message{static type(){return"ChangeUserPasswordMsg"}constructor(e,t){super(),this.prevUserPassword=e,this.newUserPassword=t}validateBasic(){if(!this.prevUserPassword)throw new Error("prevUserPassword not set");if(!this.newUserPassword)throw new Error("newUserPassword not set")}route(){return s.ROUTE}type(){return I.type()}}t.ChangeUserPasswordMsg=I;class S extends r.Message{static type(){return"export-keyring-vaults"}constructor(e){super(),this.password=e}validateBasic(){if(!this.password)throw new Error("password not set")}route(){return s.ROUTE}type(){return S.type()}}t.ExportKeyRingVaultsMsg=S;class M extends r.Message{static type(){return"export-keyring-data"}constructor(e){super(),this.password=e}validateBasic(){if(!this.password)throw new Error("password not set")}route(){return s.ROUTE}type(){return M.type()}}t.ExportKeyRingDataMsg=M;class k extends r.Message{static type(){return"CheckLegacyKeyRingPassword"}constructor(e){super(),this.password=e}validateBasic(){if(!this.password)throw new Error("password not set")}route(){return s.ROUTE}type(){return k.type()}}t.CheckLegacyKeyRingPasswordMsg=k},38860:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},a=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingService=void 0;const c=i(47235),u=i(80075),d=i(75263),l=i(48834),h=o(i(45014));class g{constructor(e,t,i,r,n,s,o){this.kvStore=e,this.migrations=t,this.chainsService=i,this.interactionService=r,this.vaultService=n,this.analyticsService=s,this.keyRings=o,this._needMigration=!1,this._isMigrating=!1,this._selectedVaultId=void 0,(0,u.makeObservable)(this)}init(){return a(this,void 0,void 0,(function*(){if(!(yield this.kvStore.get("migration/v1"))){const e=yield this.migrations.kvStore.get("key-multi-store");e&&e.length>0&&(this._needMigration=!0)}const e=yield this.kvStore.get("selectedVaultId");e&&this.vaultService.getVault("keyRing",e)&&(0,u.runInAction)((()=>{this._selectedVaultId=e})),(0,u.autorun)((()=>{this._selectedVaultId?this.kvStore.set("selectedVaultId",this._selectedVaultId):this.kvStore.set("selectedVaultId",null)})),(0,u.autorun)((()=>{const e=this.getKeyRingVaults(),t={};for(const i of e){let e=i.insensitive.keyRingType;if("private-key"===e){const t=i.insensitive.keyRingMeta;t.web3Auth&&t.web3Auth.type&&(e="web3_auth_"+t.web3Auth.type)}e&&(e="keyring_"+e+"_num",t[e]||(t[e]=0),t[e]+=1)}this.analyticsService.logEvent("user_properties",Object.assign({keyring_num:e.length},t))}))}))}lockKeyRing(){this.vaultService.lock()}ensureUnlockInteractive(e){return a(this,void 0,void 0,(function*(){this.vaultService.isLocked&&(yield this.interactionService.waitApproveV2(e,"/unlock","unlock",{},(()=>{})))}))}get needMigration(){return this._needMigration}get isMigrating(){return this._isMigrating}unlockKeyRing(e){return a(this,void 0,void 0,(function*(){this._needMigration?yield this.migrate(e):yield this.vaultService.unlock(e)}))}checkLegacyKeyRingPassword(e){return a(this,void 0,void 0,(function*(){if(!this._needMigration)throw new Error("Migration is not needed");const t=yield this.migrations.kvStore.get("key-multi-store");if(!t||0===t.length)throw new Error("No key store to migrate");yield h.Crypto.decrypt(this.migrations.commonCrypto,t[0],e)}))}migrate(e){var t,i,r,n,s,o,c,u,f,p,y,v,m,w,b,I,S,M,k,_,O,E,C;return a(this,void 0,void 0,(function*(){if(!this._needMigration)throw new Error("Migration is not needed");if(this._isMigrating)throw new Error("Migration is already in progress");this.vaultService.isSignedUp&&this.vaultService.isLocked&&(yield this.vaultService.unlock(e)),this._isMigrating=!0;try{const a=yield this.migrations.kvStore.get("key-store"),P=yield this.migrations.kvStore.get("key-multi-store");let R;if(!P||0===P.length)throw new Error("No key store to migrate");const A=new Map;for(const e of yield this.migrations.getDisabledChainIdentifiers()){if(!this.chainsService.hasChainInfo(e))continue;const t=d.ChainIdHelper.parse(e).identifier;A.set(t,!0)}const x=e=>0!==A.size&&!0===A.get(d.ChainIdHelper.parse(e).identifier);for(const A of P){const P=null===(t=A.meta)||void 0===t?void 0:t.__id__;if(!P||!(yield this.kvStore.get("migration/v1/keyStore/"+P))){if("mnemonic"===A.type){const t=l.Buffer.from(yield h.Crypto.decrypt(this.migrations.commonCrypto,A,e)).toString(),u=yield this.createMnemonicKeyRing(t,null!==(i=A.bip44HDPath)&&void 0!==i?i:{account:0,change:0,addressIndex:0},null!==(n=null===(r=A.meta)||void 0===r?void 0:r.name)&&void 0!==n?n:"Keplr Account",e);if(A.coinTypeForChain)for(const e of this.chainsService.getChainInfos()){const t=A.coinTypeForChain[d.ChainIdHelper.parse(e.chainId).identifier];if(null!=t&&this.needKeyCoinTypeFinalize(u,e.chainId))if(e.bip44.coinType===t||(null!==(s=e.alternativeBIP44s)&&void 0!==s?s:[]).find((e=>e.coinType===t)))this.finalizeKeyCoinType(u,e.chainId,t);else{const i=(yield this.kvStore.get("__migrate_skip_coin_type"))||[];i.push({chainId:e.chainId,coinType:t}),yield this.kvStore.set("__migrate_skip_coin_type",i)}}for(const e of this.chainsService.getChainInfos())x(e.chainId)||this.needKeyCoinTypeFinalize(u,e.chainId)||this.migrations.chainsUIService.enableChain(u,e.chainId);(null===(o=A.meta)||void 0===o?void 0:o.__id__)===(null===(c=null==a?void 0:a.meta)||void 0===c?void 0:c.__id__)&&(R=u)}else if("privateKey"===A.type){const t=l.Buffer.from(l.Buffer.from(yield h.Crypto.decrypt(this.migrations.commonCrypto,A,e)).toString(),"hex"),i={};if(null===(u=A.meta)||void 0===u?void 0:u.email){const e=A.meta.socialType||"google";i.web3Auth={email:A.meta.email,type:e}}const r=yield this.createPrivateKeyKeyRing(t,i,null!==(p=null===(f=A.meta)||void 0===f?void 0:f.name)&&void 0!==p?p:"Keplr Account",e);for(const e of this.chainsService.getChainInfos())x(e.chainId)||this.migrations.chainsUIService.enableChain(r,e.chainId);(null===(y=A.meta)||void 0===y?void 0:y.__id__)===(null===(v=null==a?void 0:a.meta)||void 0===v?void 0:v.__id__)&&(R=r)}else if("ledger"===A.type){const t=yield h.Crypto.decrypt(this.migrations.commonCrypto,A,e);let i=!1;try{i=l.Buffer.from(l.Buffer.from(t).toString(),"hex").toString("hex").toLowerCase()!==l.Buffer.from(t).toString().toLowerCase()}catch(e){i=!0}if(i){const i=JSON.parse(l.Buffer.from(t).toString());if(i.cosmos){const t=l.Buffer.from(i.cosmos,"hex"),r=yield this.createLedgerKeyRing(t,"Terra"===(null===(m=A.meta)||void 0===m?void 0:m.__ledger__cosmos_app_like__)?"Terra":"Cosmos",null!==(w=A.bip44HDPath)&&void 0!==w?w:{account:0,change:0,addressIndex:0},null!==(I=null===(b=A.meta)||void 0===b?void 0:b.name)&&void 0!==I?I:"Keplr Account",e);let n=!1;if(i.ethereum){const e=l.Buffer.from(i.ethereum,"hex");this.appendLedgerKeyRing(r,e,"Ethereum"),n=!0}for(const e of this.chainsService.getChainInfos())x(e.chainId)||g.isEthermintLike(e)&&!n||this.migrations.chainsUIService.enableChain(r,e.chainId);(null===(S=A.meta)||void 0===S?void 0:S.__id__)===(null===(M=null==a?void 0:a.meta)||void 0===M?void 0:M.__id__)&&(R=r)}}else{const i=l.Buffer.from(l.Buffer.from(t).toString(),"hex"),r=yield this.createLedgerKeyRing(i,"Cosmos",null!==(k=A.bip44HDPath)&&void 0!==k?k:{account:0,change:0,addressIndex:0},null!==(O=null===(_=A.meta)||void 0===_?void 0:_.name)&&void 0!==O?O:"Keplr Account",e);for(const e of this.chainsService.getChainInfos())x(e.chainId)||g.isEthermintLike(e)||this.migrations.chainsUIService.enableChain(r,e.chainId);(null===(E=A.meta)||void 0===E?void 0:E.__id__)===(null===(C=null==a?void 0:a.meta)||void 0===C?void 0:C.__id__)&&(R=r)}}else console.log("Unknown key store type",A.type);P&&(yield this.kvStore.set("migration/v1/keyStore/"+P,!0))}}R&&this.vaultService.getVault("keyRing",R)&&this.selectKeyRing(R),yield this.kvStore.set("migration/v1",!0),this._needMigration=!1}finally{this._isMigrating=!1}}))}selectKeyRing(e){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");if(!this.vaultService.getVault("keyRing",e))throw new Error("Unknown vault");this._selectedVaultId=e,this.interactionService.dispatchEvent(c.WEBPAGE_PORT,"keystore-changed",{})}get keyRingStatus(){return this._needMigration?"locked":this.vaultService.isSignedUp&&0!==this.vaultService.getVaults("keyRing").length?this.vaultService.isLocked?"locked":"unlocked":"empty"}getKeyRingVaults(){return this.vaultService.getVaults("keyRing")}getKeyInfos(){return this.getKeyRingVaults().map((e=>({id:e.id,name:e.insensitive.keyRingName,type:e.insensitive.keyRingType,isSelected:this._selectedVaultId===e.id,insensitive:e.insensitive})))}getKeyInfo(e){return this.getKeyInfos().find((t=>t.id===e))}get selectedVaultId(){if(this._selectedVaultId&&this.vaultService.getVault("keyRing",this._selectedVaultId))return this._selectedVaultId;const e=this.vaultService.getVaults("keyRing");if(0===e.length)throw new Error("Key ring is empty");return e[0].id}finalizeKeyCoinType(e,t,i){var r;if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const n=this.chainsService.getChainInfoOrThrow(t);if(n.bip44.coinType!==i&&!(null!==(r=n.alternativeBIP44s)&&void 0!==r?r:[]).find((e=>e.coinType===i)))throw new Error("Coin type is not associated to chain");const s=this.vaultService.getVault("keyRing",e);if(!s)throw new Error("Vault is null");if("mnemonic"!==s.insensitive.keyRingType&&"keystone"!==s.insensitive.keyRingType)throw new Error("Key is not needed to be finalized");const o=`keyRing-${d.ChainIdHelper.parse(t).identifier}-coinType`;if(s.insensitive[o])throw new Error("Coin type is already finalized");this.vaultService.setAndMergeInsensitiveToVault("keyRing",e,{[o]:i})}needKeyCoinTypeFinalize(e,t){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const i=this.vaultService.getVault("keyRing",e);if(!i)throw new Error("Vault is null");if("mnemonic"!==i.insensitive.keyRingType&&"keystone"!==i.insensitive.keyRingType)return!1;const r=`keyRing-${d.ChainIdHelper.parse(t).identifier}-coinType`;return!i.insensitive[r]}createMnemonicKeyRing(e,t,i,r){return a(this,void 0,void 0,(function*(){if(!this.vaultService.isSignedUp){if(!r)throw new Error("Must provide password to sign in to vault");yield this.vaultService.signUp(r)}g.validateBIP44Path(t);const n=this.getKeyRing("mnemonic"),s=yield n.createKeyRingVault(e,t),o={},a=this.chainsService.getChainInfos();for(const e of a)e.alternativeBIP44s&&0!==e.alternativeBIP44s.length||(o[`keyRing-${d.ChainIdHelper.parse(e.chainId).identifier}-coinType`]=e.bip44.coinType);const l=this.vaultService.addVault("keyRing",Object.assign(Object.assign(Object.assign({},s.insensitive),o),{keyRingName:i,keyRingType:n.supportedKeyRingType()}),s.sensitive);return(0,u.runInAction)((()=>{this._selectedVaultId=l})),this.interactionService.dispatchEvent(c.WEBPAGE_PORT,"keystore-changed",{}),l}))}createLedgerKeyRing(e,t,i,r,n){return a(this,void 0,void 0,(function*(){if(!this.vaultService.isSignedUp){if(!n)throw new Error("Must provide password to sign in to vault");yield this.vaultService.signUp(n)}g.validateBIP44Path(i);const s=this.getKeyRing("ledger"),o=yield s.createKeyRingVault(e,t,i),a=this.vaultService.addVault("keyRing",Object.assign(Object.assign({},o.insensitive),{keyRingName:r,keyRingType:s.supportedKeyRingType()}),o.sensitive);return(0,u.runInAction)((()=>{this._selectedVaultId=a})),this.interactionService.dispatchEvent(c.WEBPAGE_PORT,"keystore-changed",{}),a}))}createKeystoneKeyRing(e,t,i){return a(this,void 0,void 0,(function*(){if(!this.vaultService.isSignedUp){if(!i)throw new Error("Must provide password to sign in to vault");yield this.vaultService.signUp(i)}e.keys.forEach((e=>{const t=g.parseBIP44Path(e.path);g.validateBIP44Path(t.path)}));const r=this.getKeyRing("keystone"),n=yield r.createKeyRingVault(e),s={},o=this.chainsService.getChainInfos();for(const e of o)e.alternativeBIP44s&&0!==e.alternativeBIP44s.length||(s[`keyRing-${d.ChainIdHelper.parse(e.chainId).identifier}-coinType`]=e.bip44.coinType);const a=this.vaultService.addVault("keyRing",Object.assign(Object.assign(Object.assign({},n.insensitive),s),{keyRingName:t,keyRingType:r.supportedKeyRingType()}),n.sensitive);return(0,u.runInAction)((()=>{this._selectedVaultId=a})),this.interactionService.dispatchEvent(c.WEBPAGE_PORT,"keystore-changed",{}),a}))}createPrivateKeyKeyRing(e,t,i,r){return a(this,void 0,void 0,(function*(){if(!this.vaultService.isSignedUp){if(!r)throw new Error("Must provide password to sign in to vault");yield this.vaultService.signUp(r)}const n=this.getKeyRing("private-key"),s=yield n.createKeyRingVault(e),o=this.vaultService.addVault("keyRing",Object.assign(Object.assign({},s.insensitive),{keyRingName:i,keyRingType:n.supportedKeyRingType(),keyRingMeta:t}),s.sensitive);return(0,u.runInAction)((()=>{this._selectedVaultId=o})),this.interactionService.dispatchEvent(c.WEBPAGE_PORT,"keystore-changed",{}),o}))}appendLedgerKeyRing(e,t,i){const r=this.vaultService.getVault("keyRing",e);if(!r)throw new Error("Vault is null");if("ledger"!==r.insensitive.keyRingType)throw new Error("Key is not from ledger");if(r.insensitive[i])throw new Error("App is already appended");this.vaultService.setAndMergeInsensitiveToVault("keyRing",e,{[i]:{pubKey:l.Buffer.from(t).toString("hex")}})}getPubKeySelected(e){return this.getPubKey(e,this.selectedVaultId)}getKeyRingNameSelected(){return this.getKeyRingName(this.selectedVaultId)}getKeyRingName(e){const t=this.vaultService.getVault("keyRing",e);if(!t)throw new Error("Vault is null");return t.insensitive.keyRingName||"Keplr Account"}changeKeyRingName(e,t){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const i=this.vaultService.getVault("keyRing",e);if(!i)throw new Error("Vault is null");this.vaultService.setAndMergeInsensitiveToVault("keyRing",e,{keyRingName:t}),this.selectedVaultId===i.id&&this.interactionService.dispatchEvent(c.WEBPAGE_PORT,"keystore-changed",{})}changeKeyRingNameInteractive(e,t,i,r){return a(this,void 0,void 0,(function*(){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");if(!this.vaultService.getVault("keyRing",t))throw new Error("Vault is null");return yield this.interactionService.waitApproveV2(e,`/wallet/change-name?id=${t}`,"change-keyring-name",{defaultName:i,editable:r},(e=>(this.changeKeyRingName(t,e),e)))}))}deleteKeyRing(e,t){return a(this,void 0,void 0,(function*(){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");if(!this.vaultService.getVault("keyRing",e))throw new Error("Vault is null");yield this.vaultService.checkUserPassword(t);const i=this.selectedVaultId===e;return this.vaultService.removeVault("keyRing",e),i&&(0,u.runInAction)((()=>{const e=this.getKeyInfos();e.length>0?this._selectedVaultId=e[0].id:this._selectedVaultId=void 0})),i&&this.interactionService.dispatchEvent(c.WEBPAGE_PORT,"keystore-changed",{}),0===this.getKeyRingVaults().length&&(yield this.vaultService.clearAll(t)),i}))}signSelected(e,t,i){return this.sign(e,this.selectedVaultId,t,i)}getPubKey(e,t){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const i=this.chainsService.getChainInfoOrThrow(e),r=this.vaultService.getVault("keyRing",t);if(!r)throw new Error("Vault is null");const n=`keyRing-${d.ChainIdHelper.parse(e).identifier}-coinType`,s=r.insensitive[n]?r.insensitive[n]:i.bip44.coinType;return this.getPubKeyWithVault(r,s,i)}getPubKeyWithNotFinalizedCoinType(e,t,i){var r;if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const n=this.chainsService.getChainInfoOrThrow(e);if(n.bip44.coinType!==i&&!(null!==(r=n.alternativeBIP44s)&&void 0!==r?r:[]).find((e=>e.coinType===i)))throw new Error("Coin type is not associated to chain");const s=this.vaultService.getVault("keyRing",t);if(!s)throw new Error("Vault is null");if("mnemonic"!==s.insensitive.keyRingType&&"keystone"!==s.insensitive.keyRingType)throw new Error("Key is not needed to be finalized");const o=`keyRing-${d.ChainIdHelper.parse(e).identifier}-coinType`;if(s.insensitive[o])throw new Error("Coin type is already finalized");return this.getPubKeyWithVault(s,i,n)}sign(e,t,i,r){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const n=this.chainsService.getChainInfoOrThrow(e),s=this.vaultService.getVault("keyRing",t);if(!s)throw new Error("Vault is null");const o=`keyRing-${d.ChainIdHelper.parse(e).identifier}-coinType`,a=s.insensitive[o]?s.insensitive[o]:n.bip44.coinType,c=this.signWithVault(s,a,i,r,n);return this.needKeyCoinTypeFinalize(s.id,e)&&this.finalizeKeyCoinType(s.id,e,a),c}getPubKeyWithVault(e,t,i){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const r=this.getVaultKeyRing(e);return Promise.resolve(r.getPubKey(e,t,i))}signWithVault(e,t,i,r,n){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const s=this.getVaultKeyRing(e);return Promise.resolve(s.sign(e,t,i,r,n))}showSensitiveKeyRingData(e,t){return a(this,void 0,void 0,(function*(){if(this.vaultService.isLocked)throw new Error("KeyRing is locked");const i=this.vaultService.getVault("keyRing",e);if(!i)throw new Error("Vault is null");switch(yield this.vaultService.checkUserPassword(t),i.insensitive.keyRingType){case"mnemonic":return this.vaultService.decrypt(i.sensitive).mnemonic;case"private-key":return this.vaultService.decrypt(i.sensitive).privateKey;default:throw new Error("Unsupported keyRing type to show sensitive data")}}))}changeUserPassword(e,t){return a(this,void 0,void 0,(function*(){yield this.vaultService.changeUserPassword(e,t)}))}exportKeyRingVaults(e){return a(this,void 0,void 0,(function*(){yield this.vaultService.checkUserPassword(e);const t=[];for(const e of this.getKeyRingVaults()){if("mnemonic"===e.insensitive.keyRingType){const i=this.vaultService.decrypt(e.sensitive);t.push({type:"mnemonic",id:e.id,insensitive:e.insensitive,sensitive:i.mnemonic})}if("private-key"===e.insensitive.keyRingType){const i=this.vaultService.decrypt(e.sensitive);t.push({type:"private-key",id:e.id,insensitive:e.insensitive,sensitive:i.privateKey})}}return t}))}exportKeyRingData(e){var t;return a(this,void 0,void 0,(function*(){yield this.vaultService.checkUserPassword(e);const i=[];for(const r of this.getKeyInfos()){const n={__id__:r.id,name:r.name};switch(r.type){case"mnemonic":{const s=yield this.showSensitiveKeyRingData(r.id,e);i.push({bip44HDPath:null!==(t=r.insensitive.bip44Path)&&void 0!==t?t:{account:0,change:0,addressIndex:0},coinTypeForChain:(()=>{const e={};for(const t of this.chainsService.getChainInfos()){const i=d.ChainIdHelper.parse(t.chainId).identifier,n=`keyRing-${i}-coinType`;null!=r.insensitive[n]&&(e[i]=r.insensitive[n])}return e})(),key:s,meta:n,type:"mnemonic"});break}case"private-key":{if("object"==typeof r.insensitive&&r.insensitive.keyRingMeta&&"object"==typeof r.insensitive.keyRingMeta&&r.insensitive.keyRingMeta.web3Auth&&"object"==typeof r.insensitive.keyRingMeta.web3Auth){const e=r.insensitive.keyRingMeta.web3Auth;if("google"!==e.type&&"apple"!==e.type||!e.email)continue;n.socialType=e.type,n.email=e.email}const t=(yield this.showSensitiveKeyRingData(r.id,e)).replace("0x","");i.push({bip44HDPath:{account:0,change:0,addressIndex:0},coinTypeForChain:{},key:t,meta:n,type:"privateKey"});break}}}return i}))}getVaultKeyRing(e){for(const t of this.keyRings)if(e.insensitive.keyRingType===t.supportedKeyRingType())return t;throw new Error("Unsupported keyRing vault")}getKeyRing(e){for(const t of this.keyRings)if(e===t.supportedKeyRingType())return t;throw new Error(`Unsupported keyRing ${e}`)}static parseBIP44Path(e){const t=RegExp(/^m\/44'\/(\d+)'\/(\d+)'\/(\d+)\/(\d+)$/i).exec(e);if(!t)throw new Error("Invalid BIP44 hd path");return{coinType:+t[1],path:{account:+t[2],change:+t[3],addressIndex:+t[4]}}}static validateBIP44Path(e){if(!Number.isInteger(e.account)||e.account<0)throw new Error("Invalid account in hd path");if(!Number.isInteger(e.change)||0!==e.change&&1!==e.change)throw new Error("Invalid change in hd path");if(!Number.isInteger(e.addressIndex)||e.addressIndex<0)throw new Error("Invalid address index in hd path")}static isEthermintLike(e){var t,i;return 60===e.bip44.coinType||!!(null===(t=e.features)||void 0===t?void 0:t.includes("eth-address-gen"))||!!(null===(i=e.features)||void 0===i?void 0:i.includes("eth-key-sign"))}}s([u.observable],g.prototype,"_selectedVaultId",void 0),s([u.action],g.prototype,"selectKeyRing",null),s([u.action],g.prototype,"changeKeyRingName",null),t.KeyRingService=g},15253:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},50853:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="permission-interactive"},56113:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(31672);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.EnableAccessMsg:return s(e)(t,i);case n.DisableAccessMsg:return o(e)(t,i)}};const s=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.ensureEnabled(t,i.chainIds,i.origin)})),o=e=>(t,i)=>e.disable(i.chainIds,i.origin)},18583:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(92291),t),n(i(31672),t)},22031:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(31672),n=i(50853),s=i(56113);t.init=function(e,t){e.registerMessage(r.EnableAccessMsg),e.registerMessage(r.DisableAccessMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},81316:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(92291),t),n(i(22031),t)},31672:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisableAccessMsg=t.EnableAccessMsg=void 0;const r=i(47235),n=i(50853);class s extends r.Message{static type(){return"enable-access"}constructor(e){super(),this.chainIds=e}validateBasic(){if(!this.chainIds||0===this.chainIds.length)throw new r.KeplrError("permission",100,"chain id not set")}route(){return n.ROUTE}approveExternal(){return!0}type(){return s.type()}}t.EnableAccessMsg=s;class o extends r.Message{static type(){return"disable-access"}constructor(e){super(),this.chainIds=e}validateBasic(){if(!this.chainIds)throw new r.KeplrError("permission",100,"chain id not set")}route(){return n.ROUTE}approveExternal(){return!0}type(){return o.type()}}t.DisableAccessMsg=o},92291:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionInteractiveService=void 0,t.PermissionInteractiveService=class{constructor(e,t){this.permissionService=e,this.keyRingService=t}init(){return i(this,void 0,void 0,(function*(){}))}ensureEnabled(e,t,r){return i(this,void 0,void 0,(function*(){return yield this.keyRingService.ensureUnlockInteractive(e),yield this.permissionService.checkOrGrantBasicAccessPermission(e,t,r)}))}disable(e,t){if(e.length>0)for(const i of e)this.permissionService.removeAllTypePermissionToChainId(i,[t]);else this.permissionService.removeAllTypePermission([t]),this.permissionService.removeAllTypeGlobalPermission([t])}checkOrGrantGetChainInfosWithoutEndpointsPermission(e,t){return i(this,void 0,void 0,(function*(){return yield this.keyRingService.ensureUnlockInteractive(e),yield this.permissionService.checkOrGrantGlobalPermission(e,"get-chain-infos",t)}))}}},23894:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="permission"},71033:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(4834),n=i(47235);t.getHandler=e=>(t,i)=>{switch(i.constructor){case r.GetPermissionOriginsMsg:return s(e)(t,i);case r.GetOriginPermittedChainsMsg:return o(e)(t,i);case r.AddPermissionOrigin:return a(e)(t,i);case r.RemovePermissionOrigin:return c(e)(t,i);case r.GetGlobalPermissionOriginsMsg:return u(e)(t,i);case r.RemoveGlobalPermissionOriginMsg:return d(e)(t,i);case r.ClearOriginPermissionMsg:return l(e)(t,i);case r.ClearAllPermissionsMsg:return h(e)(t,i);case r.GetAllPermissionDataPerOriginMsg:return g(e)(t,i);default:throw new n.KeplrError("permission",120,"Unknown msg type")}};const s=e=>(t,i)=>e.getPermissionOrigins(i.chainId,i.permissionType),o=e=>(t,i)=>e.getOriginPermittedChains(i.permissionOrigin,i.permissionType),a=e=>(t,i)=>{e.addPermission([i.chainId],i.permissionType,[i.permissionOrigin])},c=e=>(t,i)=>{e.removePermission(i.chainId,i.permissionType,[i.permissionOrigin])},u=e=>(t,i)=>e.getGlobalPermissionOrigins(i.permissionType),d=e=>(t,i)=>e.removeGlobalPermission(i.permissionType,[i.permissionOrigin]),l=e=>(t,i)=>{e.removeAllTypePermission([i.permissionOrigin]),e.removeAllTypeGlobalPermission([i.permissionOrigin])},h=e=>()=>{e.clearAllPermissions()},g=e=>()=>e.getAllPermissionDataPerOrigin()},78127:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionKeyHelper=void 0;const r=i(75263);class n{static throwIfReserved(...e){for(const t of e)if(t.includes(n.splitter))throw new Error(`Has reserved word: ${t}`)}static _getPermissionKey(e,t,i){return n.throwIfReserved(e,t,i),`${r.ChainIdHelper.parse(e).identifier}${n.splitter}${t}${n.splitter}${i}`}static _getOriginFromPermissionKey(e,t,i){const s=`${r.ChainIdHelper.parse(e).identifier}${n.splitter}${t}${n.splitter}`;if(i.startsWith(s))return i.substring(s.length)}static _getTypeAndOriginFromPermissionKey(e,t){const i=`${r.ChainIdHelper.parse(e).identifier}${n.splitter}`;if(t.startsWith(i)){const e=t.substring(i.length).split(n.splitter);if(2===e.length)return{type:e[0],origin:e[1]}}}static splitPermissionKey(e){const t=e.split(n.splitter);if(3===t.length)return{chainIdentifier:t[0]===n.globalKey?void 0:t[0],type:t[1],origin:t[2]};throw new Error("Invalid permission key")}static getPermissionKey(e,t,i){const s=r.ChainIdHelper.parse(e).identifier;if(s===n.globalKey)throw new Error("Identifier is reserved for global permission key");return n._getPermissionKey(s,t,i)}static getOriginFromPermissionKey(e,t,i){const s=r.ChainIdHelper.parse(e).identifier;if(s===n.globalKey)throw new Error("Identifier is reserved for global permission key");return n._getOriginFromPermissionKey(s,t,i)}static getTypeAndOriginFromPermissionKey(e,t){const i=r.ChainIdHelper.parse(e).identifier;if(i===n.globalKey)throw new Error("Identifier is reserved for global permission key");return n._getTypeAndOriginFromPermissionKey(i,t)}static getChainIdentifierFromPermissionKey(e,t,i){const r=`${n.splitter}${e}${n.splitter}${t}`;if(!i.startsWith(n.globalKey)&&i.endsWith(r))return i.substring(0,i.length-r.length)}static getChainAndTypeFromPermissionKey(e,t){const i=`${n.splitter}${e}`;if(!t.startsWith(n.globalKey)&&t.endsWith(i)){const e=t.substring(0,t.length-i.length).split(n.splitter);if(2===e.length)return{chainIdentifier:e[0],type:e[1]}}}static getGlobalPermissionKey(e,t){return n._getPermissionKey(n.globalKey,e,t)}static getOriginFromGlobalPermissionKey(e,t){return n._getOriginFromPermissionKey(n.globalKey,e,t)}static getTypeAndOriginFromGlobalPermissionKey(e){return n._getTypeAndOriginFromPermissionKey(n.globalKey,e)}}t.PermissionKeyHelper=n,n.globalKey="_global__permission_",n.splitter="!&$"},39310:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(39108),t),n(i(96407),t),n(i(4834),t)},6062:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(4834),n=i(23894),s=i(71033);t.init=function(e,t){e.registerMessage(r.GetPermissionOriginsMsg),e.registerMessage(r.GetOriginPermittedChainsMsg),e.registerMessage(r.AddPermissionOrigin),e.registerMessage(r.RemovePermissionOrigin),e.registerMessage(r.GetGlobalPermissionOriginsMsg),e.registerMessage(r.RemoveGlobalPermissionOriginMsg),e.registerMessage(r.ClearOriginPermissionMsg),e.registerMessage(r.ClearAllPermissionsMsg),e.registerMessage(r.GetAllPermissionDataPerOriginMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},53213:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(39108),t),n(i(6062),t)},4834:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetAllPermissionDataPerOriginMsg=t.ClearAllPermissionsMsg=t.ClearOriginPermissionMsg=t.RemoveGlobalPermissionOriginMsg=t.RemovePermissionOrigin=t.AddPermissionOrigin=t.GetGlobalPermissionOriginsMsg=t.GetOriginPermittedChainsMsg=t.GetPermissionOriginsMsg=void 0;const r=i(47235),n=i(23894);class s extends r.Message{static type(){return"get-permission-origins"}constructor(e,t){super(),this.chainId=e,this.permissionType=t}validateBasic(){if(!this.chainId)throw new r.KeplrError("permission",100,"chain id not set");if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type")}route(){return n.ROUTE}type(){return s.type()}}t.GetPermissionOriginsMsg=s;class o extends r.Message{static type(){return"get-origin-permitted-chains"}constructor(e,t){super(),this.permissionOrigin=e,this.permissionType=t}validateBasic(){if(!this.permissionOrigin)throw new r.KeplrError("permission",101,"origin not set");if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type")}route(){return n.ROUTE}type(){return o.type()}}t.GetOriginPermittedChainsMsg=o;class a extends r.Message{static type(){return"get-global-permission-origins"}constructor(e){super(),this.permissionType=e}validateBasic(){if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type")}route(){return n.ROUTE}type(){return a.type()}}t.GetGlobalPermissionOriginsMsg=a;class c extends r.Message{static type(){return"add-permission-origin"}constructor(e,t,i){super(),this.chainId=e,this.permissionType=t,this.permissionOrigin=i}validateBasic(){if(!this.chainId)throw new r.KeplrError("permission",100,"chain id not set");if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type");if(!this.permissionOrigin)throw new r.KeplrError("permission",111,"empty permission origin")}route(){return n.ROUTE}type(){return c.type()}}t.AddPermissionOrigin=c;class u extends r.Message{static type(){return"remove-permission-origin"}constructor(e,t,i){super(),this.chainId=e,this.permissionType=t,this.permissionOrigin=i}validateBasic(){if(!this.chainId)throw new r.KeplrError("permission",100,"chain id not set");if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type");if(!this.permissionOrigin)throw new r.KeplrError("permission",111,"empty permission origin")}route(){return n.ROUTE}type(){return u.type()}}t.RemovePermissionOrigin=u;class d extends r.Message{static type(){return"remove-global-permission-origin"}constructor(e,t){super(),this.permissionType=e,this.permissionOrigin=t}validateBasic(){if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type");if(!this.permissionOrigin)throw new r.KeplrError("permission",111,"empty permission origin")}route(){return n.ROUTE}type(){return d.type()}}t.RemoveGlobalPermissionOriginMsg=d;class l extends r.Message{static type(){return"clear-origin-permission"}constructor(e){super(),this.permissionOrigin=e}validateBasic(){if(!this.permissionOrigin)throw new r.KeplrError("permission",111,"empty permission origin")}route(){return n.ROUTE}type(){return l.type()}}t.ClearOriginPermissionMsg=l;class h extends r.Message{static type(){return"clear-all-permissions"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return h.type()}}t.ClearAllPermissionsMsg=h;class g extends r.Message{static type(){return"get-all-permission-data-per-origin"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return g.type()}}t.GetAllPermissionDataPerOriginMsg=g},79205:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.migrate=void 0;const n=i(78127);t.migrate=function(e){return r(this,void 0,void 0,(function*(){if(!(yield e.get("permission/migrated/v1"))){const t={},i=yield e.get("permissionMap"),r=yield e.get("globalPermissionMap");if(i)for(const e of Object.keys(i)){const r=i[e];if(r)for(const i of Object.keys(r)){const s=r[i];if(s)for(const r of Object.keys(s))s[r]&&(t[n.PermissionKeyHelper.getPermissionKey(e,i,r)]=!0)}}if(r)for(const e of Object.keys(r)){const i=r[e];if(i)for(const r of Object.keys(i))i[r]&&(t[n.PermissionKeyHelper.getGlobalPermissionKey(e,r)]=!0)}return yield e.set("permission/migrated/v1",!0),t}}))}},39108:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionService=void 0;const s=i(47235),o=i(96407),a=i(80075),c=i(79205),u=i(58242),d=i(78127);class l{constructor(e,t,i,r){this.kvStore=e,this.interactionService=i,this.chainsService=r,this.permissionMap=new Map,this.privilegedOrigins=new Map,this.onChainRemoved=e=>{this.removeAllPermissions(e.chainId)},this.getPermissionOrigins=(0,u.computedFn)(((e,t)=>{const i=[];for(const r of this.permissionMap.keys()){const n=d.PermissionKeyHelper.getOriginFromPermissionKey(e,t,r);n&&i.push(n)}return i}),{keepAlive:!0}),this.getGlobalPermissionOrigins=(0,u.computedFn)((e=>{const t=[];for(const i of this.permissionMap.keys()){const r=d.PermissionKeyHelper.getOriginFromGlobalPermissionKey(e,i);r&&t.push(r)}return t}),{keepAlive:!0}),this.getOriginPermittedChains=(0,u.computedFn)(((e,t)=>{const i=[];for(const r of this.permissionMap.keys()){const n=d.PermissionKeyHelper.getChainIdentifierFromPermissionKey(t,e,r);n&&i.push(n)}return i}),{keepAlive:!0}),(0,a.makeObservable)(this);for(const e of t)this.privilegedOrigins.set(e,!0);this.chainsService.addChainRemovedHandler(this.onChainRemoved)}init(){return n(this,void 0,void 0,(function*(){const e=yield(0,c.migrate)(this.kvStore);if(e)(0,a.runInAction)((()=>{for(const t of Object.keys(e))e[t]&&this.permissionMap.set(t,!0)}));else{const e=yield this.kvStore.get("permissionMap/v1");e&&(0,a.runInAction)((()=>{for(const t of Object.keys(e))e[t]&&this.permissionMap.set(t,!0)}))}(0,a.autorun)((()=>{this.kvStore.set("permissionMap/v1",Object.fromEntries(this.permissionMap))}))}))}getAllPermissionDataPerOrigin(){const e={};for(const t of this.permissionMap.keys()){const i=d.PermissionKeyHelper.splitPermissionKey(t),r=i.origin;e[r]||(e[r]={permissions:[],globalPermissions:[]}),i.chainIdentifier?e[r].permissions.push({chainIdentifier:i.chainIdentifier,type:i.type}):e[r].globalPermissions.push({type:i.type})}return e}clearAllPermissions(){this.permissionMap.clear()}checkOrGrantBasicAccessPermission(e,t,i){return n(this,void 0,void 0,(function*(){"string"==typeof t&&(t=[t]);const r=[];for(const e of t)this.hasPermission(e,(0,o.getBasicAccessPermissionType)(),i)||r.push(e);r.length>0&&(yield this.grantBasicAccessPermission(e,r,[i])),this.checkBasicAccessPermission(e,t,i)}))}checkOrGrantPermission(e,t,i,r){return n(this,void 0,void 0,(function*(){const n=[];for(const e of t)this.hasPermission(e,i,r)||n.push(e);n.length>0&&(yield this.grantPermission(e,n,i,[r]));for(const n of t)this.checkPermission(e,n,i,r)}))}checkOrGrantGlobalPermission(e,t,i){return n(this,void 0,void 0,(function*(){this.hasGlobalPermission(t,i)||(yield this.grantGlobalPermission(e,t,[i])),this.checkGlobalPermission(e,t,i)}))}grantPermission(e,t,i,r){return n(this,void 0,void 0,(function*(){if(e.isInternalMsg)return;const n={chainIds:t,type:i,origins:r};yield this.interactionService.waitApproveV2(e,"/permission",o.INTERACTION_TYPE_PERMISSION,n,(()=>{this.addPermission(t,i,r)}))}))}grantBasicAccessPermission(e,t,i){return n(this,void 0,void 0,(function*(){for(const e of t)this.chainsService.getChainInfoOrThrow(e);yield this.grantPermission(e,t,(0,o.getBasicAccessPermissionType)(),i)}))}grantGlobalPermission(e,t,i){return n(this,void 0,void 0,(function*(){if(e.isInternalMsg)return;const r={type:t,origins:i};yield this.interactionService.waitApproveV2(e,"/permission",o.INTERACTION_TYPE_GLOBAL_PERMISSION,r,(()=>{this.addGlobalPermission(t,i)}))}))}checkPermission(e,t,i,r){if(!e.isInternalMsg&&!this.hasPermission(t,i,r))throw new s.KeplrError("permission",130,`${r} is not permitted`)}checkBasicAccessPermission(e,t,i){if(0===t.length)throw new Error("Chain ids are empty");for(const r of t)this.chainsService.getChainInfoOrThrow(r),this.checkPermission(e,r,(0,o.getBasicAccessPermissionType)(),i)}hasBasicAccessPermission(e,t,i){if(0===t.length)throw new Error("Chain ids are empty");if(e.isInternalMsg)return!0;for(const e of t)if(this.chainsService.getChainInfoOrThrow(e),!this.hasPermission(e,(0,o.getBasicAccessPermissionType)(),i))return!1;return!0}checkGlobalPermission(e,t,i){if(!e.isInternalMsg&&!this.hasGlobalPermission(t,i))throw new s.KeplrError("permission",130,`${i} is not permitted`)}hasPermission(e,t,i){var r;return!!this.privilegedOrigins.get(i)||null!==(r=this.permissionMap.get(d.PermissionKeyHelper.getPermissionKey(e,t,i)))&&void 0!==r&&r}hasGlobalPermission(e,t){var i;return!!this.privilegedOrigins.get(t)||null!==(i=this.permissionMap.get(d.PermissionKeyHelper.getGlobalPermissionKey(e,t)))&&void 0!==i&&i}addPermission(e,t,i){for(const r of e)for(const e of i)this.permissionMap.set(d.PermissionKeyHelper.getPermissionKey(r,t,e),!0)}addGlobalPermission(e,t){for(const i of t)this.permissionMap.set(d.PermissionKeyHelper.getGlobalPermissionKey(e,i),!0)}removePermission(e,t,i){for(const r of i)this.permissionMap.delete(d.PermissionKeyHelper.getPermissionKey(e,t,r))}removeAllTypePermission(e){const t=[];for(const i of this.permissionMap.keys())for(const r of e)d.PermissionKeyHelper.getChainAndTypeFromPermissionKey(r,i)&&t.push(i);for(const e of t)this.permissionMap.delete(e)}removeAllTypePermissionToChainId(e,t){const i=[];for(const r of this.permissionMap.keys()){const n=d.PermissionKeyHelper.getTypeAndOriginFromPermissionKey(e,r);n&&t.includes(n.origin)&&i.push(r)}for(const e of i)this.permissionMap.delete(e)}removeGlobalPermission(e,t){const i=[];for(const r of this.permissionMap.keys()){const n=d.PermissionKeyHelper.getTypeAndOriginFromGlobalPermissionKey(r);n&&n.type===e&&t.includes(n.origin)&&i.push(r)}for(const e of i)this.permissionMap.delete(e)}removeAllTypeGlobalPermission(e){const t=[];for(const i of this.permissionMap.keys()){const r=d.PermissionKeyHelper.getTypeAndOriginFromGlobalPermissionKey(i);r&&e.includes(r.origin)&&t.push(i)}for(const e of t)this.permissionMap.delete(e)}removeAllPermissions(e){const t=[];for(const i of this.permissionMap.keys())d.PermissionKeyHelper.getTypeAndOriginFromPermissionKey(e,i)&&t.push(i);for(const e of t)this.permissionMap.delete(e)}}r([a.observable],l.prototype,"permissionMap",void 0),r([a.action],l.prototype,"clearAllPermissions",null),r([a.action],l.prototype,"addPermission",null),r([a.action],l.prototype,"addGlobalPermission",null),r([a.action],l.prototype,"removePermission",null),r([a.action],l.prototype,"removeAllTypePermission",null),r([a.action],l.prototype,"removeAllTypePermissionToChainId",null),r([a.action],l.prototype,"removeGlobalPermission",null),r([a.action],l.prototype,"removeAllTypeGlobalPermission",null),r([a.action],l.prototype,"removeAllPermissions",null),t.PermissionService=l},96407:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBasicAccessPermissionType=t.getBasicAccessPermissionType=t.INTERACTION_TYPE_GLOBAL_PERMISSION=t.INTERACTION_TYPE_PERMISSION=void 0,t.INTERACTION_TYPE_PERMISSION="permission",t.INTERACTION_TYPE_GLOBAL_PERMISSION="global_permission",t.getBasicAccessPermissionType=function(){return"basic-access"},t.isBasicAccessPermissionType=function(e){return"basic-access"===e}},25327:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="phishing-list"},75556:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(87724);t.getHandler=e=>(t,i)=>{switch(i.constructor){case r.CheckURLIsPhishingMsg:return n(e)(t,i);case r.URLTempAllowMsg:return s(e)(t,i);case r.CheckBadTwitterIdMsg:return o(e)(t,i);default:throw new Error("Unknown msg type")}};const n=e=>(t,i)=>e.checkURLIsPhishing(i.origin),s=e=>(t,i)=>{if(new URL(i.origin).origin!==new URL(e.blocklistPageURL).origin)throw new Error("Permission rejected");e.allowUrlTemp(i.url)},o=e=>(t,i)=>e.checkBadTwitterId(i.id)},72978:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(67235),t),n(i(87724),t)},17666:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(25327),n=i(75556),s=i(87724);t.init=function(e,t){e.registerMessage(s.CheckURLIsPhishingMsg),e.registerMessage(s.URLTempAllowMsg),e.registerMessage(s.CheckBadTwitterIdMsg),e.addHandler(r.ROUTE,(0,n.getHandler)(t))}},18351:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(67235),t),n(i(17666),t)},87724:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBadTwitterIdMsg=t.URLTempAllowMsg=t.CheckURLIsPhishingMsg=void 0;const r=i(47235),n=i(25327),s=i(14626);class o extends r.Message{static type(){return"check-url-is-phishing"}constructor(){super()}validateBasic(){const e=new URL(this.origin);(0,s.parseDomain)(e.origin)}approveExternal(){return!0}route(){return n.ROUTE}type(){return o.type()}}t.CheckURLIsPhishingMsg=o;class a extends r.Message{static type(){return"url-temp-allow"}constructor(e){super(),this.url=e}validateBasic(){const e=new URL(this.url);(0,s.parseDomain)(e.origin)}approveExternal(){return!0}route(){return n.ROUTE}type(){return a.type()}}t.URLTempAllowMsg=a;class c extends r.Message{static type(){return"check-bad-twitter-id"}constructor(e){super(),this.id=e}validateBasic(){}approveExternal(){return!0}route(){return n.ROUTE}type(){return c.type()}}t.CheckBadTwitterIdMsg=c},67235:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PhishingListService=void 0;const n=i(14626),s=i(96618);class o{constructor(e,t){this.opts=e,this.handler=t,this._hasInited=!1,this._hasStopped=!1}get hasInited(){return this._hasInited}start(){this.fetch()}stop(){null!=this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this._hasStopped=!0}fetch(){return r(this,void 0,void 0,(function*(){if(null!=this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this._hasStopped)return;let e=!1;try{const e=yield(0,s.simpleFetch)(this.opts.url,"");this.handler(e),this._hasInited=!0}catch(t){e=!0,console.log(t)}this._hasStopped||(this.timeoutId=setTimeout((()=>{this.fetch()}),e?this.opts.retryIntervalMs:this.opts.fetchingIntervalMs))}))}}t.PhishingListService=class{constructor(e,t){this.opts=e,this.blocklistPageURL=t,this.urlMap=new Map,this.allowedUrlMap=new Map,this.twitterMap=new Map,this.urlFetcher=new o(Object.assign(Object.assign({},this.opts),{url:this.opts.blockListUrl}),(e=>{const t=e.data.split(/(\r?\n)|,|;|\s|\t/).filter((e=>null!=e)).map((e=>e.trim())).filter((e=>e.length>0)),i=new Map;for(const e of t)try{i.set((0,n.parseDomain)(e).join("."),!0)}catch(e){console.log(e)}this.urlMap=i})),this.opts.twitterListUrl&&(this.twitterFetcher=new o(Object.assign(Object.assign({},this.opts),{url:this.opts.twitterListUrl}),(e=>{const t=e.data.split(/(\r?\n)|,|;|\s|\t/).filter((e=>null!=e)).map((e=>e.trim())).filter((e=>e.length>0)),i=new Map;for(const e of t)i.set(e.replace("@","").toLowerCase(),!0);this.twitterMap=i})))}init(){return r(this,void 0,void 0,(function*(){this.urlFetcher.start(),this.twitterFetcher&&this.twitterFetcher.start()}))}get hasInited(){return this.urlFetcher.hasInited&&(!this.twitterFetcher||this.twitterFetcher.hasInited)}stop(){this.urlFetcher.stop(),this.twitterFetcher&&this.twitterFetcher.stop()}checkURLIsPhishing(e){const t=new URL(e).origin,i=(0,n.parseDomain)(t);for(;i.length>=2;){const e=i.join(".");if(!0===this.urlMap.get(e)){const e=this.allowedUrlMap.get((0,n.parseDomain)(t).join("."));if(!(e&&e+this.opts.allowTimeoutMs>=(new Date).getTime()))return!0}i.shift()}return!1}allowUrlTemp(e){const t=new URL(e);this.allowedUrlMap.set((0,n.parseDomain)(t.origin).join("."),(new Date).getTime())}checkBadTwitterId(e){return!0===this.twitterMap.get(e.replace("@","").toLowerCase())}}},14626:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDomain=void 0,t.parseDomain=function(e){let t=e;t.match(/^[a-zA-Z0-9-]+:\/\/.+$/)&&(t=t.replace(/^[a-zA-Z0-9-]+:\/\//,""));const i=t.indexOf("/");i>=0&&(t=t.slice(0,i));const r=t.indexOf("?");r>=0&&(t=t.slice(0,r));const n=t.split(".").map((e=>e.trim())).filter((e=>e.length>0));if(n.length<2)throw new Error(`Invalid domain: ${e}`);const s=n[n.length-1].indexOf(":");return s>=0&&(n[n.length-1]=n[n.length-1].slice(0,s)),n}},75384:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="recent-send-history"},153:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(35806);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.GetRecentSendHistoriesMsg:return o(e)(t,i);case s.SendTxAndRecordMsg:return a(e)(t,i);case s.SendTxAndRecordWithIBCPacketForwardingMsg:return c(e)(t,i);case s.SendTxAndRecordWithIBCSwapMsg:return u(e)(t,i);case s.GetIBCHistoriesMsg:return d(e)(t,i);case s.RemoveIBCHistoryMsg:return l(e)(t,i);case s.ClearAllIBCHistoryMsg:return h(e)(t,i);default:throw new n.KeplrError("tx",110,"Unknown msg type")}};const o=e=>(t,i)=>e.getRecentSendHistories(i.chainId,i.historyType),a=e=>(t,i)=>e.sendTxAndRecord(i.historyType,i.sourceChainId,i.destinationChainId,i.tx,i.mode,i.silent,i.sender,i.recipient,i.amount,i.memo,void 0,{currencies:[]}),c=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.sendTxAndRecord(i.historyType,i.sourceChainId,i.destinationChainId,i.tx,i.mode,i.silent,i.sender,i.recipient,i.amount,i.memo,i.channels,i.notificationInfo)})),u=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.sendTxAndRecordIBCSwap(i.swapType,i.sourceChainId,i.destinationChainId,i.tx,i.mode,i.silent,i.sender,i.amount,i.memo,i.channels,i.destinationAsset,i.swapChannelIndex,i.swapReceiver,i.notificationInfo)})),d=e=>(t,i)=>e.getRecentIBCHistories(),l=e=>(t,i)=>(e.removeRecentIBCHistory(i.id),e.getRecentIBCHistories()),h=e=>()=>{e.clearAllRecentIBCHistory()}},48247:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(48344),t),n(i(35806),t),n(i(44105),t)},66441:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(35806),n=i(75384),s=i(153);t.init=function(e,t){e.registerMessage(r.GetRecentSendHistoriesMsg),e.registerMessage(r.SendTxAndRecordMsg),e.registerMessage(r.SendTxAndRecordWithIBCPacketForwardingMsg),e.registerMessage(r.SendTxAndRecordWithIBCSwapMsg),e.registerMessage(r.GetIBCHistoriesMsg),e.registerMessage(r.RemoveIBCHistoryMsg),e.registerMessage(r.ClearAllIBCHistoryMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},20684:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(48344),t),n(i(66441),t)},35806:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClearAllIBCHistoryMsg=t.RemoveIBCHistoryMsg=t.GetIBCHistoriesMsg=t.SendTxAndRecordWithIBCSwapMsg=t.SendTxAndRecordWithIBCPacketForwardingMsg=t.SendTxAndRecordMsg=t.GetRecentSendHistoriesMsg=void 0;const r=i(47235),n=i(75384);class s extends r.Message{static type(){return"get-recent-send-histories"}constructor(e,t){super(),this.chainId=e,this.historyType=t}validateBasic(){if(!this.chainId)throw new Error("chain id is empty");if(!this.historyType)throw new Error("type is empty")}route(){return n.ROUTE}type(){return s.type()}}t.GetRecentSendHistoriesMsg=s;class o extends r.Message{static type(){return"send-tx-and-record"}constructor(e,t,i,r,n,s,o,a,c,u){super(),this.historyType=e,this.sourceChainId=t,this.destinationChainId=i,this.tx=r,this.mode=n,this.silent=s,this.sender=o,this.recipient=a,this.amount=c,this.memo=u}validateBasic(){if(!this.historyType)throw new Error("type is empty");if(!this.sourceChainId)throw new Error("chain id is empty");if(!this.destinationChainId)throw new Error("chain id is empty");if(!this.tx)throw new Error("tx is empty");if(!this.mode||"sync"!==this.mode&&"async"!==this.mode&&"block"!==this.mode)throw new Error("invalid mode");if(!this.sender)throw new Error("sender is empty");if(!this.recipient)throw new Error("recipient is empty")}route(){return n.ROUTE}type(){return o.type()}withIBCPacketForwarding(e,t){return new a(this.historyType,this.sourceChainId,this.destinationChainId,this.tx,e,this.mode,this.silent,this.sender,this.recipient,this.amount,this.memo,t)}}t.SendTxAndRecordMsg=o;class a extends r.Message{static type(){return"send-tx-and-record-with-ibc-packet-forwarding"}constructor(e,t,i,r,n,s,o,a,c,u,d,l){super(),this.historyType=e,this.sourceChainId=t,this.destinationChainId=i,this.tx=r,this.channels=n,this.mode=s,this.silent=o,this.sender=a,this.recipient=c,this.amount=u,this.memo=d,this.notificationInfo=l}validateBasic(){if(!this.historyType)throw new Error("type is empty");if(!this.sourceChainId)throw new Error("chain id is empty");if(!this.destinationChainId)throw new Error("chain id is empty");if(!this.tx)throw new Error("tx is empty");if(0===this.channels.length)throw new Error("channels is empty");if(!this.mode||"sync"!==this.mode&&"async"!==this.mode&&"block"!==this.mode)throw new Error("invalid mode");if(!this.sender)throw new Error("sender is empty");if(!this.recipient)throw new Error("recipient is empty")}route(){return n.ROUTE}type(){return a.type()}}t.SendTxAndRecordWithIBCPacketForwardingMsg=a;class c extends r.Message{static type(){return"send-tx-and-record-with-ibc-swap"}constructor(e,t,i,r,n,s,o,a,c,u,d,l,h,g){super(),this.swapType=e,this.sourceChainId=t,this.destinationChainId=i,this.tx=r,this.channels=n,this.destinationAsset=s,this.swapChannelIndex=o,this.swapReceiver=a,this.mode=c,this.silent=u,this.sender=d,this.amount=l,this.memo=h,this.notificationInfo=g}validateBasic(){if(!this.swapType)throw new Error("type is empty");if(!this.sourceChainId)throw new Error("chain id is empty");if(!this.destinationChainId)throw new Error("chain id is empty");if(!this.tx)throw new Error("tx is empty");if(!this.mode||"sync"!==this.mode&&"async"!==this.mode&&"block"!==this.mode)throw new Error("invalid mode");if(!this.sender)throw new Error("sender is empty")}route(){return n.ROUTE}type(){return c.type()}}t.SendTxAndRecordWithIBCSwapMsg=c;class u extends r.Message{static type(){return"get-ibc-histories"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return u.type()}}t.GetIBCHistoriesMsg=u;class d extends r.Message{static type(){return"remove-ibc-histories"}constructor(e){super(),this.id=e}validateBasic(){if(!this.id)throw new Error("id is empty")}route(){return n.ROUTE}type(){return d.type()}}t.RemoveIBCHistoryMsg=d;class l extends r.Message{static type(){return"clear-all-ibc-histories"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return l.type()}}t.ClearAllIBCHistoryMsg=l},48344:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RecentSendHistoryService=void 0;const s=i(75263),o=i(80075),a=i(45137),c=i(48834),u=i(16261);class d{constructor(e,t,i,r){this.kvStore=e,this.chainsService=t,this.txService=i,this.notification=r,this.recentSendHistoryMap=new Map,this.recentIBCHistorySeq=0,this.recentIBCHistoryMap=new Map,this.trackIBCPacketForwardingRecursiveInternal=(e,t,i,r)=>{const n=this.getRecentIBCHistory(e);if(n)if(n.txFulfilled&&0!==n.ibcHistory.length&&null!=n.ibcHistory.find((e=>null!=e.error))){if(n.ibcHistory.find((e=>e.rewoundButNextRewindingBlocked)))return void t();const a=n.packetTimeout||!1,c=n.ibcHistory.findIndex((e=>{if(e.rewound)return!0})),u=(()=>{if(c>=0){if(0===c)return;return n.ibcHistory[c-1]}return n.ibcHistory.find((e=>null!=e.error))})(),d=u&&"swapChannelIndex"in n&&n.ibcHistory.indexOf(u)===n.swapChannelIndex+1;if(u&&u.sequence){const c=(()=>{const e=n.ibcHistory.findIndex((e=>e===u));if(!(e<0))return 0===e?this.chainsService.getChainInfo(n.chainId):this.chainsService.getChainInfo(n.ibcHistory[e-1].counterpartyChainId)})();if(c){const l=new s.TendermintTxTracer(c.rpc,"/websocket");l.addEventListener("close",i),l.addEventListener("error",r),l.traceTx(a?{"timeout_packet.packet_src_channel":u.channelId,"timeout_packet.packet_sequence":u.sequence}:{"acknowledge_packet.packet_src_channel":u.channelId,"acknowledge_packet.packet_sequence":u.sequence}).then((i=>{l.close(),i&&((0,o.runInAction)((()=>{if(d){const e=i.txs?i.txs.map((e=>e.tx_result||e)):[i.tx_result||i];if(e&&Array.isArray(e))for(const t of e)if(u.sequence&&"swapReceiver"in n){const e=a?this.getIBCTimeoutPacketIndexFromTx(t,u.portId,u.channelId,u.sequence):this.getIBCAcknowledgementPacketIndexFromTx(t,u.portId,u.channelId,u.sequence);if(e>=0){const i=a?this.getIBCSwapResAmountFromTx(t,n.swapReceiver[n.swapChannelIndex+1],(()=>{const i=this.getLastIBCTimeoutPacketBeforeIndexFromTx(t,e);return i<0?0:i})(),e):this.getIBCSwapResAmountFromTx(t,n.swapReceiver[n.swapChannelIndex+1],e);n.swapRefundInfo={chainId:c.chainId,amount:i},u.rewoundButNextRewindingBlocked=!0;break}}}u.rewound=!0})),t(),this.trackIBCPacketForwardingRecursive(e))}))}}}else if(n.txFulfilled){if(n.ibcHistory.length>0){const a=n.ibcHistory.findIndex((e=>!e.completed)),d=a>=0?n.ibcHistory[a]:void 0,l=a>=0&&a+1<n.ibcHistory.length?n.ibcHistory[a+1]:void 0;if(d&&d.sequence){const h=[];let g=!1;const f=()=>{g||(g=!0,h.forEach((e=>{e.readyState!==s.WsReadyState.OPEN&&e.readyState!==s.WsReadyState.CONNECTING||e.close()})),t())};let p=!1;const y=()=>{p||(p=!0,h.forEach((e=>{e.readyState!==s.WsReadyState.OPEN&&e.readyState!==s.WsReadyState.CONNECTING||e.close()})),i())};let v=!1;const m=()=>{v||(v=!0,h.forEach((e=>{e.readyState!==s.WsReadyState.OPEN&&e.readyState!==s.WsReadyState.CONNECTING||e.close()})),r())},w=this.chainsService.getChainInfo(d.counterpartyChainId);if(w){const t={"recv_packet.packet_dst_channel":d.dstChannelId,"recv_packet.packet_sequence":d.sequence},i=new s.TendermintTxTracer(w.rpc,"/websocket");h.push(i),i.addEventListener("close",y),i.addEventListener("error",m),i.traceTx(t).then((t=>{if(i.close(),!t)return;const r=t.txs?t.txs.map((e=>e.tx_result||e)):[t.tx_result||t];r&&Array.isArray(r)&&(0,o.runInAction)((()=>{d.completed=!0;for(const t of r)try{const i=this.getIBCWriteAcknowledgementAckFromTx(t,d.portId,d.channelId,d.sequence);if(i&&i.length>0){const t=c.Buffer.from(i);try{if(JSON.parse(t.toString()).error){d.error="Packet processing failed",f(),this.trackIBCPacketForwardingRecursive(e);break}}catch(e){console.log(e)}}const r=this.getIBCRecvPacketIndexFromTx(t,d.portId,d.channelId,d.sequence);if(r>=0){if("swapReceiver"in n){const e=this.getIBCSwapResAmountFromTx(t,n.swapReceiver[a+1],r);n.resAmount.push(e)}if(l){l.sequence=this.getIBCPacketSequenceFromTx(t,l.portId,l.channelId,r),l.dstChannelId=this.getDstChannelIdFromTx(t,l.portId,l.channelId,r),f(),this.trackIBCPacketForwardingRecursive(e);break}if(n.notificationInfo&&!n.notified){(0,o.runInAction)((()=>{n.notified=!0}));const e=this.chainsService.getChainInfo(n.destinationChainId);if(e)if("swapType"in n){if(n.resAmount.length>0){const t=n.resAmount[n.resAmount.length-1].filter((e=>n.notificationInfo.currencies.find((t=>t.coinMinimalDenom===e.denom)))).map((e=>{const t=n.notificationInfo.currencies.find((t=>t.coinMinimalDenom===e.denom));return new u.CoinPretty(t,e.amount).hideIBCMetadata(!0).shrink(!0).maxDecimals(6).inequalitySymbol(!0).trim(!0).toString()}));t.length>0&&this.notification.create({iconRelativeUrl:"assets/logo-256.png",title:"IBC Swap Succeeded",message:`${t.join(", ")} received on ${e.chainName}`})}}else{const t=n.amount.filter((e=>n.notificationInfo.currencies.find((t=>t.coinMinimalDenom===e.denom)))).map((e=>{const t=n.notificationInfo.currencies.find((t=>t.coinMinimalDenom===e.denom));return new u.CoinPretty(t,e.amount).hideIBCMetadata(!0).shrink(!0).maxDecimals(6).inequalitySymbol(!0).trim(!0).toString()}));t.length>0&&this.notification.create({iconRelativeUrl:"assets/logo-256.png",title:"IBC Transfer Succeeded",message:`${t.join(", ")} sent to ${e.chainName}`})}}f();break}}catch(e){}}))}))}let b="";if(b=a>0?n.ibcHistory[a-1].counterpartyChainId:n.chainId,b){const t=this.chainsService.getChainInfo(b);if(t){const i={"timeout_packet.packet_src_channel":d.channelId,"timeout_packet.packet_sequence":d.sequence},r=new s.TendermintTxTracer(t.rpc,"/websocket");h.push(r),r.addEventListener("close",y),r.addEventListener("error",m),r.traceTx(i).then((t=>{r.close(),t&&(0,o.runInAction)((()=>{d.error="Packet timeout",n.packetTimeout=!0,f(),this.trackIBCPacketForwardingRecursive(e)}))}))}}}}}else{const a=n.chainId,u=this.chainsService.getChainInfo(a),d=c.Buffer.from(n.txHash,"hex");if(u){const a=new s.TendermintTxTracer(u.rpc,"/websocket");a.addEventListener("close",i),a.addEventListener("error",r),a.traceTx(d).then((i=>{a.close(),(0,o.runInAction)((()=>{if(n.txFulfilled=!0,null!=i.code&&0!==i.code)n.txError=i.log||i.raw_log||"Unknown error",this.removeRecentIBCHistory(e);else{if("swapReceiver"in n){const e=this.getIBCSwapResAmountFromTx(i,n.swapReceiver[0]);n.resAmount.push(e)}if(n.ibcHistory.length>0){const r=n.ibcHistory[0];r.sequence=this.getIBCPacketSequenceFromTx(i,r.portId,r.channelId),r.dstChannelId=this.getDstChannelIdFromTx(i,r.portId,r.channelId),t(),this.trackIBCPacketForwardingRecursive(e)}}}))}))}}else t()},this.onChainRemoved=e=>{const t=s.ChainIdHelper.parse(e.chainId).identifier;(0,o.runInAction)((()=>{const e=[];for(const i of this.recentIBCHistoryMap.values())s.ChainIdHelper.parse(i.chainId).identifier!==t&&s.ChainIdHelper.parse(i.destinationChainId).identifier!==t?i.ibcHistory.some((e=>s.ChainIdHelper.parse(e.counterpartyChainId).identifier===t))&&e.push(i.id):e.push(i.id);for(const t of e)this.recentIBCHistoryMap.delete(t)}))},(0,o.makeObservable)(this)}init(){return n(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("recentSendHistoryMap");e&&(0,o.runInAction)((()=>{for(const[t,i]of Object.entries(e))this.recentSendHistoryMap.set(t,i)})),(0,o.autorun)((()=>{const e=(0,o.toJS)(this.recentSendHistoryMap),t=Object.fromEntries(e);this.kvStore.set("recentSendHistoryMap",t)}));const t=yield this.kvStore.get("recentIBCTransferHistorySeq");t&&(0,o.runInAction)((()=>{this.recentIBCHistorySeq=t})),(0,o.autorun)((()=>{const e=(0,o.toJS)(this.recentIBCHistorySeq);this.kvStore.set("recentIBCTransferHistorySeq",e)}));const i=yield this.kvStore.get("recentIBCTransferHistoryMap");i&&(0,o.runInAction)((()=>{let e=Object.entries(i);e=e.sort((([,e],[,t])=>parseInt(e.id)-parseInt(t.id)));for(const[t,i]of e)this.recentIBCHistoryMap.set(t,i)})),(0,o.autorun)((()=>{const e=(0,o.toJS)(this.recentIBCHistoryMap),t=Object.fromEntries(e);this.kvStore.set("recentIBCTransferHistoryMap",t)}));for(const e of this.getRecentIBCHistories())this.trackIBCPacketForwardingRecursive(e.id);this.chainsService.addChainRemovedHandler(this.onChainRemoved)}))}sendTxAndRecord(e,t,i,r,o,a,c,u,d,l,h,g){return n(this,void 0,void 0,(function*(){const n=this.chainsService.getChainInfoOrThrow(t);s.Bech32Address.validate(c,n.bech32Config.bech32PrefixAccAddr);const f=this.chainsService.getChainInfoOrThrow(i);s.Bech32Address.validate(u,f.bech32Config.bech32PrefixAccAddr);const p=yield this.txService.sendTx(t,r,o,{silent:a,onFulfill:t=>{null!=t.code&&0!==t.code||this.addRecentSendHistory(i,e,{sender:c,recipient:u,amount:d,memo:l,ibcChannels:h})}});if(h&&h.length>0){const e=this.addRecentIBCTransferHistory(t,i,c,u,d,l,h,g,p);this.trackIBCPacketForwardingRecursive(e)}return p}))}sendTxAndRecordIBCSwap(e,t,i,r,o,a,c,u,d,l,h,g,f,p){return n(this,void 0,void 0,(function*(){const n=this.chainsService.getChainInfoOrThrow(t);s.Bech32Address.validate(c,n.bech32Config.bech32PrefixAccAddr),this.chainsService.getChainInfoOrThrow(i);const y=yield this.txService.sendTx(t,r,o,{silent:a}),v=this.addRecentIBCSwapHistory(e,t,i,c,u,d,l,h,g,f,p,y);return this.trackIBCPacketForwardingRecursive(v),y}))}trackIBCPacketForwardingRecursive(e){(0,a.retry)((()=>new Promise(((t,i)=>{this.trackIBCPacketForwardingRecursiveInternal(e,(()=>{t()}),(()=>{setTimeout((()=>{i()}),500)}),(()=>{i()}))}))),{maxRetries:10,waitMsAfterError:1e4,maxWaitMsAfterError:3e5})}getRecentSendHistories(e,t){var i;const r=`${s.ChainIdHelper.parse(e).identifier}/${t}`;return(null!==(i=this.recentSendHistoryMap.get(r))&&void 0!==i?i:[]).slice(0,20)}addRecentSendHistory(e,t,i){var r;const n=`${s.ChainIdHelper.parse(e).identifier}/${t}`;let o=null!==(r=this.recentSendHistoryMap.get(n))&&void 0!==r?r:[];o.unshift(Object.assign({timestamp:Date.now()},i)),o=o.slice(0,20),this.recentSendHistoryMap.set(n,o)}addRecentIBCTransferHistory(e,t,i,r,n,s,o,a,u){const d=(this.recentIBCHistorySeq++).toString(),l={id:d,chainId:e,destinationChainId:t,timestamp:Date.now(),sender:i,recipient:r,amount:n,memo:s,ibcHistory:o.map((e=>({portId:e.portId,channelId:e.channelId,counterpartyChainId:e.counterpartyChainId,completed:!1}))),notificationInfo:a,txHash:c.Buffer.from(u).toString("hex")};return this.recentIBCHistoryMap.set(d,l),d}addRecentIBCSwapHistory(e,t,i,r,n,s,o,a,u,d,l,h){const g=(this.recentIBCHistorySeq++).toString(),f={id:g,swapType:e,chainId:t,destinationChainId:i,timestamp:Date.now(),sender:r,amount:n,memo:s,ibcHistory:o.map((e=>({portId:e.portId,channelId:e.channelId,counterpartyChainId:e.counterpartyChainId,completed:!1}))),destinationAsset:a,swapChannelIndex:u,swapReceiver:d,resAmount:[],notificationInfo:l,txHash:c.Buffer.from(h).toString("hex")};return this.recentIBCHistoryMap.set(g,f),g}getRecentIBCHistory(e){return this.recentIBCHistoryMap.get(e)}getRecentIBCHistories(){return Array.from(this.recentIBCHistoryMap.values()).filter((e=>!!this.chainsService.hasChainInfo(e.chainId)&&!!this.chainsService.hasChainInfo(e.destinationChainId)&&!e.ibcHistory.some((e=>!this.chainsService.hasChainInfo(e.counterpartyChainId)))))}removeRecentIBCHistory(e){return this.recentIBCHistoryMap.delete(e)}clearAllRecentIBCHistory(){this.recentIBCHistoryMap.clear()}getIBCWriteAcknowledgementAckFromTx(e,t,i,r){const n=e.events;if(!n)throw new Error("Invalid tx");if(!Array.isArray(n))throw new Error("Invalid tx");const s=(e,t)=>e===t?[!0,!1]:e===c.Buffer.from(t).toString("base64")?[!0,!0]:[!1,!1],o=n.find((e=>{if("write_acknowledgement"!==e.type)return!1;const n=e.attributes.find((e=>s(e.key,"packet_src_port")[0]));if(!n)return!1;const o=e.attributes.find((e=>s(e.key,"packet_src_channel")[0]));if(!o)return!1;let a=!1;const u=e.attributes.find((e=>{const t=s(e.key,"packet_sequence");return a=t[1],t[0]}));return!!u&&(a?c.Buffer.from(n.value,"base64").toString()===t&&c.Buffer.from(o.value,"base64").toString()===i&&c.Buffer.from(u.value,"base64").toString()===r:n.value===t&&o.value===i&&u.value===r)}));if(!o)return;let a=!1;const u=o.attributes.find((e=>{const t=s(e.key,"packet_ack");return a=t[1],t[0]}));return u?a?c.Buffer.from(u.value,"base64"):c.Buffer.from(u.value):void 0}getIBCSwapResAmountFromTx(e,t,i=0,r=-1){const n=e.events.slice(i,r>=0?r:void 0),s=(e,t)=>e===t?[!0,!1]:e===c.Buffer.from(t).toString("base64")?[!0,!0]:[!1,!1],o=n.reverse().find((e=>!("coin_received"!==e.type||!e.attributes.find((e=>s(e.key,"receiver")[0]&&s(e.value,t)[0])))));if(o){let e=!1;const t=o.attributes.find((t=>{const i=s(t.key,"amount");return e=i[1],i[0]}));if(t){const i=(e?c.Buffer.from(t.value,"base64").toString():t.value).split(/^([0-9]+)(\s)*([a-zA-Z][a-zA-Z0-9/-]*)$/);if(5===i.length){const e=i[1];return[{denom:i[3],amount:e}]}}}return[]}getIBCAcknowledgementPacketIndexFromTx(e,t,i,r){const n=e.events;if(!n)throw new Error("Invalid tx");if(!Array.isArray(n))throw new Error("Invalid tx");const s=(e,t)=>e===t?[!0,!1]:e===c.Buffer.from(t).toString("base64")?[!0,!0]:[!1,!1],o=n.find((e=>{if("acknowledge_packet"!==e.type)return!1;const n=e.attributes.find((e=>s(e.key,"packet_src_port")[0]));if(!n)return!1;const o=e.attributes.find((e=>s(e.key,"packet_src_channel")[0]));if(!o)return!1;let a=!1;const u=e.attributes.find((e=>{const t=s(e.key,"packet_sequence");return a=t[1],t[0]}));return!!u&&(a?c.Buffer.from(n.value,"base64").toString()===t&&c.Buffer.from(o.value,"base64").toString()===i&&c.Buffer.from(u.value,"base64").toString()===r:n.value===t&&o.value===i&&u.value===r)}));return o?n.indexOf(o):-1}getIBCTimeoutPacketIndexFromTx(e,t,i,r){const n=e.events;if(!n)throw new Error("Invalid tx");if(!Array.isArray(n))throw new Error("Invalid tx");const s=(e,t)=>e===t?[!0,!1]:e===c.Buffer.from(t).toString("base64")?[!0,!0]:[!1,!1],o=n.find((e=>{if("timeout_packet"!==e.type)return!1;const n=e.attributes.find((e=>s(e.key,"packet_src_port")[0]));if(!n)return!1;const o=e.attributes.find((e=>s(e.key,"packet_src_channel")[0]));if(!o)return!1;let a=!1;const u=e.attributes.find((e=>{const t=s(e.key,"packet_sequence");return a=t[1],t[0]}));return!!u&&(a?c.Buffer.from(n.value,"base64").toString()===t&&c.Buffer.from(o.value,"base64").toString()===i&&c.Buffer.from(u.value,"base64").toString()===r:n.value===t&&o.value===i&&u.value===r)}));return o?n.indexOf(o):-1}getLastIBCTimeoutPacketBeforeIndexFromTx(e,t){const i=e.events;if(!i)throw new Error("Invalid tx");if(!Array.isArray(i))throw new Error("Invalid tx");const r=i.slice(0,t).reverse().findIndex((e=>{if("timeout_packet"===e.type)return!0}));return r>=0?t-r-1:-1}getIBCRecvPacketIndexFromTx(e,t,i,r){const n=e.events;if(!n)throw new Error("Invalid tx");if(!Array.isArray(n))throw new Error("Invalid tx");const s=(e,t)=>e===t?[!0,!1]:e===c.Buffer.from(t).toString("base64")?[!0,!0]:[!1,!1],o=n.find((e=>{if("recv_packet"!==e.type)return!1;const n=e.attributes.find((e=>s(e.key,"packet_src_port")[0]));if(!n)return!1;const o=e.attributes.find((e=>s(e.key,"packet_src_channel")[0]));if(!o)return!1;let a=!1;const u=e.attributes.find((e=>{const t=s(e.key,"packet_sequence");return a=t[1],t[0]}));return!!u&&(a?c.Buffer.from(n.value,"base64").toString()===t&&c.Buffer.from(o.value,"base64").toString()===i&&c.Buffer.from(u.value,"base64").toString()===r:n.value===t&&o.value===i&&u.value===r)}));return o?n.indexOf(o):-1}getIBCPacketSequenceFromTx(e,t,i,r=0){let n=e.events;if(!n)throw new Error("Invalid tx");if(!Array.isArray(n))throw new Error("Invalid tx");const s=(e,t)=>e===t?[!0,!1]:e===c.Buffer.from(t).toString("base64")?[!0,!0]:[!1,!1];n=n.slice(r);const o=n.find((e=>{if("send_packet"!==e.type)return!1;const r=e.attributes.find((e=>s(e.key,"packet_src_port")[0]));if(!r)return!1;let n=!1;const o=e.attributes.find((e=>{const t=s(e.key,"packet_src_channel");return n=t[1],t[0]}));return!!o&&(n?r.value===c.Buffer.from(t).toString("base64")&&o.value===c.Buffer.from(i).toString("base64"):r.value===t&&o.value===i)}));let a=!1;if(o){const e=o.attributes.find((e=>{const t=s(e.key,"packet_sequence");return a=t[1],t[0]}));if(!e)throw new Error("Invalid tx");return a?c.Buffer.from(e.value,"base64").toString():e.value}throw new Error("Invalid tx")}getDstChannelIdFromTx(e,t,i,r=0){let n=e.events;if(!n)throw new Error("Invalid tx");if(!Array.isArray(n))throw new Error("Invalid tx");const s=(e,t)=>e===t?[!0,!1]:e===c.Buffer.from(t).toString("base64")?[!0,!0]:[!1,!1];n=n.slice(r);const o=n.find((e=>{if("send_packet"!==e.type)return!1;const r=e.attributes.find((e=>s(e.key,"packet_src_port")[0]));if(!r)return!1;let n=!1;const o=e.attributes.find((e=>{const t=s(e.key,"packet_src_channel");return n=t[1],t[0]}));return!!o&&(n?r.value===c.Buffer.from(t).toString("base64")&&o.value===c.Buffer.from(i).toString("base64"):r.value===t&&o.value===i)}));let a=!1;if(o){const e=o.attributes.find((e=>{const t=s(e.key,"packet_dst_channel");return a=t[1],t[0]}));if(!e)throw new Error("Invalid tx");return a?c.Buffer.from(e.value,"base64").toString():e.value}throw new Error("Invalid tx")}}r([o.observable],d.prototype,"recentSendHistoryMap",void 0),r([o.observable],d.prototype,"recentIBCHistorySeq",void 0),r([o.observable],d.prototype,"recentIBCHistoryMap",void 0),r([o.action],d.prototype,"addRecentSendHistory",null),r([o.action],d.prototype,"addRecentIBCTransferHistory",null),r([o.action],d.prototype,"addRecentIBCSwapHistory",null),r([o.action],d.prototype,"removeRecentIBCHistory",null),r([o.action],d.prototype,"clearAllRecentIBCHistory",null),t.RecentSendHistoryService=d},44105:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},68199:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="secret-wasm"},68157:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},o=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EnigmaUtils=void 0;const a=i(23870),c=i(87760),u=i(96053),d=s(i(27849)),l=i(96618),h=i(48834),g=i(75263),f=new d.PolyfillCryptoProvider,p=new Uint8Array(h.Buffer.from("000000000000000000024bead8df69990852c202db0e0097c1a12ea637d7e96d","hex")),y=new Uint8Array(h.Buffer.from("79++5YOHfm0SwhlpUDClv7cuCjq9xBZlWqSjDJWkRG8=","base64"));class v{constructor(e,t,i){if(this.url=e,this.seed=t,this.chainId=i,this.consensusIoPubKey=new Uint8Array,32!==t.length)throw new Error("encryptionSeed must be a Uint8Array of length 32");const{privkey:r,pubkey:n}=v.GenerateNewKeyPairFromSeed(this.seed);this.privkey=r,this.pubkey=n,"secret"===g.ChainIdHelper.parse(i).identifier&&(this.consensusIoPubKey=y)}static secureRandom(e){const t=new Uint8Array(e);return crypto.getRandomValues(t),t}static GenerateNewKeyPairFromSeed(e){const{private:t,public:i}=(0,a.generateKeyPair)(e);return{privkey:t,pubkey:i}}getConsensusIoPubKey(){return o(this,void 0,void 0,(function*(){if(32===this.consensusIoPubKey.length)return this.consensusIoPubKey;const e=yield(0,l.simpleFetch)(this.url,"/reg/tx-key");return this.consensusIoPubKey=new Uint8Array(h.Buffer.from(e.data.result.TxKey,"base64")),this.consensusIoPubKey}))}getTxEncryptionKey(e){return o(this,void 0,void 0,(function*(){const t=yield this.getConsensusIoPubKey(),i=(0,a.sharedKey)(this.privkey,t);return(0,c.hkdf)(u.sha256,Uint8Array.from([...i,...e]),p,"",32)}))}encrypt(e,t){return o(this,void 0,void 0,(function*(){const i=v.secureRandom(32),r=yield this.getTxEncryptionKey(i),n=yield d.SIV.importKey(r,"AES-SIV",f),s=(new TextEncoder).encode(e+JSON.stringify(t)),o=yield n.seal(s,[new Uint8Array]);return Uint8Array.from([...i,...this.pubkey,...o])}))}decrypt(e,t){return o(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.length))return new Uint8Array;const i=yield this.getTxEncryptionKey(t),r=yield d.SIV.importKey(i,"AES-SIV",f);return yield r.open(e,[new Uint8Array])}))}getPubkey(){return Promise.resolve(this.pubkey)}}t.EnigmaUtils=v},48113:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(50489);t.getHandler=(e,t)=>(i,r)=>{switch(r.constructor){case s.GetPubkeyMsg:return o(e,t)(i,r);case s.ReqeustEncryptMsg:return a(e,t)(i,r);case s.RequestDecryptMsg:return c(e,t)(i,r);case s.GetTxEncryptionKeyMsg:return u(e,t)(i,r);default:throw new n.KeplrError("secret-wasm",120,"Unknown msg type")}};const o=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.getPubkey(n.chainId)})),a=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.encrypt(n.chainId,n.contractCodeHash,n.msg)})),c=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.decrypt(n.chainId,n.cipherText,n.nonce)})),u=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.getTxEncryptionKey(n.chainId,n.nonce)}))},49145:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(37743),t),n(i(50489),t)},96796:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(50489),n=i(68199),s=i(48113);t.init=function(e,t,i){e.registerMessage(r.GetPubkeyMsg),e.registerMessage(r.ReqeustEncryptMsg),e.registerMessage(r.RequestDecryptMsg),e.registerMessage(r.GetTxEncryptionKeyMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t,i))}},42134:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(37743),t),n(i(96796),t)},50489:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetTxEncryptionKeyMsg=t.RequestDecryptMsg=t.ReqeustEncryptMsg=t.GetPubkeyMsg=void 0;const r=i(47235),n=i(68199);class s extends r.Message{static type(){return"get-pubkey-msg"}constructor(e){super(),this.chainId=e}validateBasic(){if(!this.chainId)throw new r.KeplrError("secret-wasm",100,"chain id not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return s.type()}}t.GetPubkeyMsg=s;class o extends r.Message{static type(){return"request-encrypt-msg"}constructor(e,t,i){super(),this.chainId=e,this.contractCodeHash=t,this.msg=i}validateBasic(){if(!this.chainId)throw new r.KeplrError("secret-wasm",100,"chain id not set");if(!this.contractCodeHash)throw new r.KeplrError("secret-wasm",103,"contract code hash not set");if(!this.msg)throw new r.KeplrError("secret-wasm",101,"msg not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return o.type()}}t.ReqeustEncryptMsg=o;class a extends r.Message{static type(){return"request-decrypt-msg"}constructor(e,t,i){super(),this.chainId=e,this.cipherText=t,this.nonce=i}validateBasic(){if(!this.chainId)throw new r.KeplrError("secret-wasm",100,"chain id not set");if(!this.cipherText||0===this.cipherText.length)throw new r.KeplrError("secret-wasm",102,"ciphertext not set");if(!this.nonce||0===this.nonce.length)throw new r.KeplrError("secret-wasm",110,"nonce not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return a.type()}}t.RequestDecryptMsg=a;class c extends r.Message{static type(){return"get-tx-encryption-key-msg"}constructor(e,t){super(),this.chainId=e,this.nonce=t}validateBasic(){if(!this.chainId)throw new r.KeplrError("secret-wasm",100,"chain id not set");if(!this.nonce)throw new r.KeplrError("secret-wasm",111,"nonce is null")}approveExternal(){return!0}route(){return n.ROUTE}type(){return c.type()}}t.GetTxEncryptionKeyMsg=c},37743:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SecretWasmService=void 0;const s=i(68157),o=i(75263),a=i(48834),c=i(81204),u=i(80075);class d{constructor(e,t,i){this.kvStore=e,this.chainsService=t,this.keyRingCosmosService=i,this.cacheEnigmaUtils=new Map,this.seedMap=new Map,this.onChainRemoved=()=>{this.cacheEnigmaUtils=new Map}}init(){return n(this,void 0,void 0,(function*(){(yield this.kvStore.get("migration/v2"))||(yield this.kvStore.set("migration/v2",!0));const e=yield this.kvStore.get("seedMap/v2");e&&(0,u.runInAction)((()=>{for(const[t,i]of Object.entries(e))i&&this.seedMap.set(t,i)})),(0,u.autorun)((()=>{const e=(0,u.toJS)(this.seedMap),t=Object.fromEntries(e);this.kvStore.set("seedMap/v2",t)})),this.chainsService.addChainRemovedHandler(this.onChainRemoved)}))}getPubkey(e){return n(this,void 0,void 0,(function*(){const t=this.chainsService.getChainInfoOrThrow(e),i=yield this.getSeed(t);return this.getEnigmaUtils(t,i).pubkey}))}getTxEncryptionKey(e,t){return n(this,void 0,void 0,(function*(){const i=yield this.chainsService.getChainInfoOrThrow(e),r=yield this.getSeed(i);return this.getEnigmaUtils(i,r).getTxEncryptionKey(t)}))}encrypt(e,t,i){return n(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainInfoOrThrow(e),n=yield this.getSeed(r),s=this.getEnigmaUtils(r,n);return yield s.encrypt(t,i)}))}decrypt(e,t,i){return n(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainInfoOrThrow(e),n=yield this.getSeed(r),s=this.getEnigmaUtils(r,n);return yield s.decrypt(t,i)}))}getEnigmaUtils(e,t){const i=`${e.chainId}-${a.Buffer.from(t).toString("hex")}`;if(this.cacheEnigmaUtils.has(i))return this.cacheEnigmaUtils.get(i);const r=new s.EnigmaUtils(e.rest,t,e.rest);return this.cacheEnigmaUtils.set(i,r),r}getSeed(e){return n(this,void 0,void 0,(function*(){const t=yield this.keyRingCosmosService.getKeySelected(e.chainId);return yield this.getSeedInner(e,t)}))}getSeedInner(e,t){return n(this,void 0,void 0,(function*(){const i=`seed-${o.ChainIdHelper.parse(e.chainId).identifier}-${t.bech32Address}`,r=this.seedMap.get(i);if(r)return a.Buffer.from(r,"hex");const s=yield(()=>n(this,void 0,void 0,(function*(){if(t.isNanoLedger||t.isKeystone){const e=new Uint8Array(32);return crypto.getRandomValues(e),e}return c.Hash.sha256(yield this.keyRingCosmosService.legacySignArbitraryInternal(e.chainId,"Create Keplr Secret encryption key. Only approve requests by Keplr."))})))();return this.seedMap.set(i,a.Buffer.from(s).toString("hex")),s}))}}r([u.observable],d.prototype,"seedMap",void 0),t.SecretWasmService=d},58388:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="token-cw20"},90017:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(32445),o=i(48834);t.getHandler=(e,t,i)=>(r,o)=>{switch(o.constructor){case s.GetAllTokenInfosMsg:return a(e)(r,o);case s.SuggestTokenMsg:return c(e,t,i)(r,o);case s.AddTokenMsg:return u(e)(r,o);case s.RemoveTokenMsg:return d(e)(r,o);case s.GetSecret20ViewingKey:return l(e,t,i)(r,o);default:throw new n.KeplrError("tokens",120,"Unknown msg type")}};const a=e=>()=>e.getAllTokenInfos(),c=(e,t,i)=>(n,s)=>r(void 0,void 0,void 0,(function*(){yield t.ensureEnabled(n,[s.chainId],s.origin);const r=yield i.getKeySelected(s.chainId),a=o.Buffer.from(r.address).toString("hex");yield e.suggestToken(n,s.chainId,s.contractAddress,a,s.viewingKey)})),u=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.setToken(i.chainId,i.currency,i.associatedAccountAddress),e.getAllTokenInfos()})),d=e=>(t,i)=>(e.removeToken(i.chainId,i.contractAddress,i.associatedAccountAddress),e.getAllTokenInfos()),l=(e,t,i)=>(n,s)=>r(void 0,void 0,void 0,(function*(){yield t.ensureEnabled(n,[s.chainId],s.origin);const r=yield i.getKeySelected(s.chainId),a=o.Buffer.from(r.address).toString("hex");return e.getSecret20ViewingKey(s.chainId,s.contractAddress,a)}))},5268:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(92953),t),n(i(32445),t),n(i(79389),t)},26881:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(32445),n=i(58388),s=i(90017);t.init=function(e,t,i,o){e.registerMessage(r.GetAllTokenInfosMsg),e.registerMessage(r.SuggestTokenMsg),e.registerMessage(r.AddTokenMsg),e.registerMessage(r.RemoveTokenMsg),e.registerMessage(r.GetSecret20ViewingKey),e.addHandler(n.ROUTE,(0,s.getHandler)(t,i,o))}},3015:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(92953),t),n(i(26881),t)},32445:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetSecret20ViewingKey=t.RemoveTokenMsg=t.AddTokenMsg=t.SuggestTokenMsg=t.GetAllTokenInfosMsg=void 0;const r=i(47235),n=i(58388);class s extends r.Message{static type(){return"GetAllTokenInfosMsg"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.GetAllTokenInfosMsg=s;class o extends r.Message{static type(){return"SuggestTokenMsg"}constructor(e,t,i){super(),this.chainId=e,this.contractAddress=t,this.viewingKey=i}approveExternal(){return!0}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty");if(!this.contractAddress)throw new r.KeplrError("tokens",101,"Contract address is empty")}route(){return n.ROUTE}type(){return o.type()}}t.SuggestTokenMsg=o;class a extends r.Message{static type(){return"AddTokenMsg"}constructor(e,t,i){super(),this.chainId=e,this.associatedAccountAddress=t,this.currency=i}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty")}route(){return n.ROUTE}type(){return a.type()}}t.AddTokenMsg=a;class c extends r.Message{static type(){return"RemoveTokenMsg"}constructor(e,t,i){super(),this.chainId=e,this.associatedAccountAddress=t,this.contractAddress=i}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty")}route(){return n.ROUTE}type(){return c.type()}}t.RemoveTokenMsg=c;class u extends r.Message{static type(){return"get-secret20-viewing-key"}constructor(e,t){super(),this.chainId=e,this.contractAddress=t}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty");if(!this.contractAddress)throw new r.KeplrError("tokens",101,"Contract address is empty")}approveExternal(){return!0}route(){return n.ROUTE}type(){return u.type()}}t.GetSecret20ViewingKey=u},92953:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TokenCW20Service=void 0;const s=i(47235),o=i(10843),a=i(75263),c=i(45137),u=i(80075),d=i(58242),l=i(48834);class h{constructor(e,t,i){this.chainsService=t,this.interactionService=i,this.tokenMap=new Map,this.onChainRemoved=e=>{const t=a.ChainIdHelper.parse(e.chainId).identifier;(0,u.runInAction)((()=>{this.tokenMap.delete(t)}))},this.getAllTokenInfos=(0,d.computedFn)((()=>{const e=(0,u.toJS)(this.tokenMap);return Object.fromEntries(e)})),this.getToken=(0,d.computedFn)(((e,t,i)=>{const r=a.ChainIdHelper.parse(e).identifier,n=this.tokenMap.get(r);if(n)return n.find((e=>(!e.associatedAccountAddress||e.associatedAccountAddress===i)&&"contractAddress"in e.currency&&e.currency.contractAddress===t))})),this.legacyKVStore=e,this.kvStore=new c.PrefixKVStore(e,"v2"),(0,u.makeObservable)(this)}init(){return n(this,void 0,void 0,(function*(){if(!(yield this.kvStore.get("migrated/v2"))){for(const e of this.chainsService.getChainInfos()){const t=a.ChainIdHelper.parse(e.chainId).identifier,i=yield this.legacyKVStore.get(t);i&&i.length>0&&this.tokenMap.set(t,i.map((e=>({currency:e}))));const r=yield this.legacyKVStore.get(`${t}-addresses`);if(r&&r.length>0)for(const e of r){const i=yield this.legacyKVStore.get(`${t}-${e}`);i&&i.length>0&&this.tokenMap.set(t,i.map((t=>({associatedAccountAddress:e,currency:t}))))}}yield this.kvStore.set("migrated/v2",!0)}{const e=yield this.kvStore.get("tokenMap");if(e)for(const[t,i]of Object.entries(e))this.tokenMap.set(t,i);(0,u.autorun)((()=>{const e=(0,u.toJS)(this.tokenMap),t=Object.fromEntries(e);this.kvStore.set("tokenMap",t)}))}this.chainsService.addChainRemovedHandler(this.onChainRemoved)}))}validateAssociatedAccountAddress(e){if(!e)throw new Error("Please provide the associated account address");if(l.Buffer.from(e,"hex").toString("hex")!==e)throw new Error("Invalid associated account address")}validateChainInfoFeatures(e){if(!e.features||!e.features.includes("cosmwasm")&&!e.features.includes("secretwasm"))throw new Error("The chain doesn't support cosmwasm")}suggestToken(e,t,i,r,s){return n(this,void 0,void 0,(function*(){this.validateAssociatedAccountAddress(r);const n=this.chainsService.getChainInfoOrThrow(t);this.validateChainInfoFeatures(n);const o=this.getToken(t,i,r);if(o)return s?void("type"in o.currency&&"secret20"===o.currency.type&&o.currency.viewingKey!==s&&(yield this.setToken(t,Object.assign(Object.assign({},o.currency),{viewingKey:s}),r))):void 0;a.Bech32Address.validate(i,n.bech32Config.bech32PrefixAccAddr);const c={chainId:t,contractAddress:i,viewingKey:s},u=yield this.interactionService.waitApprove(e,"/setting/token/add","suggest-token-cw20",c);yield this.setToken(t,u,r)}))}setToken(e,t,i){return n(this,void 0,void 0,(function*(){this.validateAssociatedAccountAddress(i);const r=this.chainsService.getChainInfoOrThrow(e);this.validateChainInfoFeatures(r);const n=a.ChainIdHelper.parse(e).identifier;this.tokenMap.has(n)||(0,u.runInAction)((()=>{this.tokenMap.set(n,[])}));const s=this.tokenMap.get(n);if(!("type"in(t=yield h.validateCurrency(r,t)))||"cw20"!==t.type&&"secret20"!==t.type)throw new Error("Unknown type of currency");if("secret20"===t.type&&!t.viewingKey)throw new Error("Viewing key must be set");const o=t.contractAddress,c="secret20"===t.type,d=s.find((e=>(!e.associatedAccountAddress||e.associatedAccountAddress===i)&&"contractAddress"in e.currency&&e.currency.contractAddress===o));(0,u.runInAction)((()=>{d?d.currency=t:s.push({associatedAccountAddress:c?i:void 0,currency:t})}))}))}removeToken(e,t,i){const r=a.ChainIdHelper.parse(e).identifier,n=this.tokenMap.get(r);if(!n)return;const s=n.findIndex((e=>(!e.associatedAccountAddress||e.associatedAccountAddress===i)&&"contractAddress"in e.currency&&e.currency.contractAddress===t));s>=0&&n.splice(s,1)}getSecret20ViewingKey(e,t,i){this.validateAssociatedAccountAddress(i);const r=this.getToken(e,t,i);if(r&&"type"in r.currency&&"secret20"===r.currency.type)return r.currency.viewingKey;throw new s.KeplrError("token-cw20",111,"There is no matched secret20")}static validateCurrency(e,t){return n(this,void 0,void 0,(function*(){if(!("type"in t))throw new Error("Unknown type of currency");switch(t.type){case"cw20":t=yield h.validateCW20Currency(e,t);break;case"secret20":t=yield h.validateSecret20Currency(e,t);break;default:throw new s.KeplrError("tokens",110,"Unknown type of currency")}return t}))}static validateCW20Currency(e,t){return n(this,void 0,void 0,(function*(){return t=yield o.CW20CurrencySchema.validateAsync(t),a.Bech32Address.validate(t.contractAddress,e.bech32Config.bech32PrefixAccAddr),t}))}static validateSecret20Currency(e,t){return n(this,void 0,void 0,(function*(){return t=yield o.Secret20CurrencySchema.validateAsync(t),a.Bech32Address.validate(t.contractAddress,e.bech32Config.bech32PrefixAccAddr),t}))}}r([u.observable],h.prototype,"tokenMap",void 0),r([u.action],h.prototype,"removeToken",null),t.TokenCW20Service=h},79389:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},71021:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="token-erc20"},73553:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(50723);t.getHandler=(e,t)=>(i,r)=>{switch(r.constructor){case s.GetAllERC20TokenInfosMsg:return o(e)(i,r);case s.SuggestERC20TokenMsg:return a(e,t)(i,r);case s.AddERC20TokenMsg:return c(e)(i,r);case s.RemoveERC20TokenMsg:return u(e)(i,r);default:throw new n.KeplrError("tokens",120,"Unknown msg type")}};const o=e=>()=>e.getAllERC20TokenInfos(),a=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.suggestERC20Token(i,n.chainId,n.contractAddress)})),c=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.setERC20Token(i.chainId,i.currency),e.getAllERC20TokenInfos()})),u=e=>(t,i)=>(e.removeERC20Token(i.chainId,i.contractAddress),e.getAllERC20TokenInfos())},81984:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(53383),t),n(i(50723),t),n(i(181),t)},11381:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(50723),n=i(71021),s=i(73553);t.init=function(e,t,i){e.registerMessage(r.GetAllERC20TokenInfosMsg),e.registerMessage(r.SuggestERC20TokenMsg),e.registerMessage(r.AddERC20TokenMsg),e.registerMessage(r.RemoveERC20TokenMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t,i))}},29307:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(53383),t),n(i(11381),t)},50723:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoveERC20TokenMsg=t.AddERC20TokenMsg=t.SuggestERC20TokenMsg=t.GetAllERC20TokenInfosMsg=void 0;const r=i(47235),n=i(71021);class s extends r.Message{static type(){return"GetAllERC20TokenInfosMsg"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.GetAllERC20TokenInfosMsg=s;class o extends r.Message{static type(){return"SuggestERC20TokenMsg"}constructor(e,t){super(),this.chainId=e,this.contractAddress=t}approveExternal(){return!0}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty");if(!this.contractAddress)throw new r.KeplrError("tokens",101,"Contract address is empty")}route(){return n.ROUTE}type(){return o.type()}}t.SuggestERC20TokenMsg=o;class a extends r.Message{static type(){return"AddERC20TokenMsg"}constructor(e,t){super(),this.chainId=e,this.currency=t}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty")}route(){return n.ROUTE}type(){return a.type()}}t.AddERC20TokenMsg=a;class c extends r.Message{static type(){return"RemoveERC20TokenMsg"}constructor(e,t){super(),this.chainId=e,this.contractAddress=t}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty")}route(){return n.ROUTE}type(){return c.type()}}t.RemoveERC20TokenMsg=c},53383:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TokenERC20Service=void 0;const s=i(47235),o=i(10843),a=i(75263),c=i(45137),u=i(80075),d=i(58242);class l{constructor(e,t,i){this.chainsService=t,this.interactionService=i,this.tokenMap=new Map,this.onChainRemoved=e=>{const t=a.ChainIdHelper.parse(e.chainId).identifier;(0,u.runInAction)((()=>{this.tokenMap.delete(t)}))},this.getAllERC20TokenInfos=(0,d.computedFn)((()=>{const e=(0,u.toJS)(this.tokenMap);return Object.fromEntries(e)})),this.getERC20Token=(0,d.computedFn)(((e,t)=>{const i=a.ChainIdHelper.parse(e).identifier,r=this.tokenMap.get(i);if(r)return r.find((e=>"contractAddress"in e.currency&&e.currency.contractAddress===t))})),this.kvStore=new c.PrefixKVStore(e,"v2"),(0,u.makeObservable)(this)}init(){return n(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("tokenMapERC20");if(e)for(const[t,i]of Object.entries(e))this.tokenMap.set(t,i);(0,u.autorun)((()=>{const e=(0,u.toJS)(this.tokenMap),t=Object.fromEntries(e);this.kvStore.set("tokenMapERC20",t)})),this.chainsService.addChainRemovedHandler(this.onChainRemoved)}))}validateChainInfo(e){if(void 0===e.evm)throw new Error("The chain doesn't support evm")}suggestERC20Token(e,t,i){return n(this,void 0,void 0,(function*(){const r=this.chainsService.getChainInfoOrThrow(t);if(this.validateChainInfo(r),this.getERC20Token(t,i))return;if(!i.match(/^0x[0-9A-Fa-f]*$/)||42!==i.length)throw new Error("Contract address is not valid hex address");const n={chainId:t,contractAddress:i},s=yield this.interactionService.waitApprove(e,"/setting/token/add","suggest-token-erc20",n);yield this.setERC20Token(t,s)}))}setERC20Token(e,t){return n(this,void 0,void 0,(function*(){const i=this.chainsService.getChainInfoOrThrow(e);this.validateChainInfo(i);const r=a.ChainIdHelper.parse(e).identifier;this.tokenMap.has(r)||(0,u.runInAction)((()=>{this.tokenMap.set(r,[])}));const n=this.tokenMap.get(r);if(!("type"in(t=yield l.validateCurrency(t)))||"erc20"!==t.type)throw new Error("Unknown type of currency");const s=t.contractAddress,o=n.find((e=>"contractAddress"in e.currency&&e.currency.contractAddress===s));(0,u.runInAction)((()=>{o?o.currency=t:n.push({currency:t})}))}))}removeERC20Token(e,t){const i=a.ChainIdHelper.parse(e).identifier,r=this.tokenMap.get(i);if(!r)return;const n=r.findIndex((e=>"contractAddress"in e.currency&&e.currency.contractAddress===t));n>=0&&r.splice(n,1)}static validateCurrency(e){return n(this,void 0,void 0,(function*(){if(!("type"in e))throw new Error("Unknown type of currency");if("erc20"!==e.type)throw new s.KeplrError("tokens",110,"Unknown type of currency");return e=yield l.validateERC20Currency(e)}))}static validateERC20Currency(e){return n(this,void 0,void 0,(function*(){return yield o.ERC20CurrencySchema.validateAsync(e),e}))}}r([u.observable],l.prototype,"tokenMap",void 0),r([u.action],l.prototype,"removeERC20Token",null),t.TokenERC20Service=l},181:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},42952:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="token-scan"},90155:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(73689);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.GetTokenScansMsg:return o(e)(t,i);case s.RevalidateTokenScansMsg:return a(e)(t,i);default:throw new n.KeplrError("tx",110,"Unknown msg type")}};const o=e=>(t,i)=>e.getTokenScans(i.vaultId),a=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.scanAll(i.vaultId),{vaultId:i.vaultId,tokenScans:e.getTokenScans(i.vaultId)}}))},32197:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(63980),t),n(i(73689),t)},40762:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(73689),n=i(42952),s=i(90155);t.init=function(e,t){e.registerMessage(r.GetTokenScansMsg),e.registerMessage(r.RevalidateTokenScansMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t))}},9932:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(63980),t),n(i(40762),t)},73689:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevalidateTokenScansMsg=t.GetTokenScansMsg=void 0;const r=i(47235),n=i(42952);class s extends r.Message{static type(){return"get-token-scans"}constructor(e){super(),this.vaultId=e}validateBasic(){if(!this.vaultId)throw new Error("Empty vault id")}route(){return n.ROUTE}type(){return s.type()}}t.GetTokenScansMsg=s;class o extends r.Message{static type(){return"revalidate-token-scans"}constructor(e){super(),this.vaultId=e}validateBasic(){if(!this.vaultId)throw new Error("Empty vault id")}route(){return n.ROUTE}type(){return o.type()}}t.RevalidateTokenScansMsg=o},63980:function(e,t,i){"use strict";var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TokenScanService=void 0;const s=i(80075),o=i(96618),a=i(16261),c=i(75263);class u{constructor(e,t,i,r,n,o){this.kvStore=e,this.chainsService=t,this.chainsUIService=i,this.vaultService=r,this.keyRingService=n,this.keyRingCosmosService=o,this.vaultToMap=new Map,(0,s.makeObservable)(this)}init(){return n(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("vaultToMap");e&&(0,s.runInAction)((()=>{for(const[t,i]of Object.entries(e))this.vaultToMap.set(t,i)})),(0,s.autorun)((()=>{const e=(0,s.toJS)(this.vaultToMap),t=Object.fromEntries(e);this.kvStore.set("vaultToMap",t)})),this.vaultService.addVaultRemovedHandler(((e,t)=>{"keyRing"===e&&this.vaultToMap.delete(t)})),this.chainsService.addChainSuggestedHandler((e=>n(this,void 0,void 0,(function*(){yield this.scanWithAllVaults(e.chainId)})))),this.chainsUIService.addChainUIEnabledChangedHandler(((e,t)=>{(0,s.runInAction)((()=>{let i=this.vaultToMap.get(e);i&&(i=i.filter((e=>!t.includes(c.ChainIdHelper.parse(e.chainId).identifier))),this.vaultToMap.set(e,i))}))}))}))}getTokenScans(e){var t;return(null!==(t=this.vaultToMap.get(e))&&void 0!==t?t:[]).filter((e=>this.chainsService.hasChainInfo(e.chainId))).sort(((e,t)=>{const i=this.chainsService.getChainInfoOrThrow(e.chainId),r=this.chainsService.getChainInfoOrThrow(t.chainId);return i.chainName.localeCompare(r.chainName)}))}scanWithAllVaults(e){return n(this,void 0,void 0,(function*(){if("unlocked"!==this.keyRingService.keyRingStatus)return;if(this.chainsService.getChainInfoOrThrow(e).hideInUI)return;const t=this.keyRingService.getKeyInfos().map((e=>e.id)).sort(((e,t)=>{const i=this.keyRingService.selectedVaultId===e,r=this.keyRingService.selectedVaultId===t;return i?-1:r?1:0}));for(const i of t)yield this.scan(i,e)}))}scan(e,t){return n(this,void 0,void 0,(function*(){if("unlocked"!==this.keyRingService.keyRingStatus)return;if(this.chainsService.getChainInfoOrThrow(t).hideInUI)return;const i=yield this.calculateTokenScan(e,t);if(i){if(this.chainsUIService.isEnabled(e,i.chainId))return;(0,s.runInAction)((()=>{var t;let r=null!==(t=this.vaultToMap.get(e))&&void 0!==t?t:[];const n=c.ChainIdHelper.parse(i.chainId).identifier;r=r.filter((e=>{const t=c.ChainIdHelper.parse(e.chainId).identifier;return n!==t})),r.push(i),this.vaultToMap.set(e,r)}))}}))}scanAll(e){return n(this,void 0,void 0,(function*(){if("unlocked"!==this.keyRingService.keyRingStatus)return;const t=this.chainsService.getChainInfos().filter((t=>!this.chainsUIService.isEnabled(e,t.chainId))),i=[],r=[];for(const s of t)r.push((()=>n(this,void 0,void 0,(function*(){const t=yield this.calculateTokenScan(e,s.chainId);t&&i.push(t)})))());yield Promise.allSettled(r),i.length>0&&(0,s.runInAction)((()=>{var t;let r=null!==(t=this.vaultToMap.get(e))&&void 0!==t?t:[];for(const e of i){const t=c.ChainIdHelper.parse(e.chainId).identifier;r=r.filter((e=>{const i=c.ChainIdHelper.parse(e.chainId).identifier;return t!==i})),r.push(e)}r=r.filter((t=>!this.chainsUIService.isEnabled(e,t.chainId))),this.vaultToMap.set(e,r)}))}))}calculateTokenScan(e,t){var i,r;return n(this,void 0,void 0,(function*(){if("unlocked"!==this.keyRingService.keyRingStatus)return;const s=this.chainsService.getChainInfoOrThrow(t);if(s.hideInUI)return;if(this.chainsUIService.isEnabled(e,t))return;const c={chainId:t,infos:[]},u=yield(()=>n(this,void 0,void 0,(function*(){return this.keyRingService.needKeyCoinTypeFinalize(e,t)?(yield this.keyRingCosmosService.computeNotFinalizedKeyAddresses(e,t)).map((e=>({value:e.bech32Address,coinType:e.coinType}))):[{value:(yield this.keyRingCosmosService.getKey(e,t)).bech32Address}]})))();for(const e of u){const t=yield(0,o.simpleFetch)(s.rest,`/cosmos/bank/v1beta1/balances/${e.value}?pagination.limit=1000`);if(200===t.status){const n=[],o=null!==(r=null===(i=t.data)||void 0===i?void 0:i.balances)&&void 0!==r?r:[];for(const e of o){const t=s.currencies.find((t=>t.coinMinimalDenom===e.denom));if(t){if("string"!=typeof e.amount)throw new Error("Invalid amount");new a.Dec(e.amount).gt(new a.Dec(0))&&n.push({currency:t,amount:e.amount})}}n.length>0&&c.infos.push({bech32Address:e.value,coinType:e.coinType,assets:n})}}return c.infos.length>0?c:void 0}))}}r([s.observable],u.prototype,"vaultToMap",void 0),t.TokenScanService=u},91380:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="background-tx-ethereum"},83472:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(78308);t.getHandler=(e,t)=>(i,r)=>{if(r.constructor===s.SendTxEthereumMsg)return o(e,t)(i,r);throw new n.KeplrError("tx",110,"Unknown msg type")};const o=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.sendEthereumTx(n.chainId,n.tx,{silent:n.silent})}))},49346:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(78308),n=i(91380),s=i(83472);t.init=function(e,t,i){e.registerMessage(r.SendTxEthereumMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t,i))}},25079:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(25490),t),n(i(49346),t)},78308:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SendTxEthereumMsg=void 0;const r=i(47235),n=i(91380);class s extends r.Message{static type(){return"send-ethereum-tx-to-background"}constructor(e,t,i){super(),this.chainId=e,this.tx=t,this.silent=i}validateBasic(){if(!this.chainId)throw new r.KeplrError("tx",100,"chain id is empty");if(!this.tx)throw new r.KeplrError("tx",101,"tx is empty")}approveExternal(){return!this.silent}route(){return n.ROUTE}type(){return s.type()}}t.SendTxEthereumMsg=s},25490:function(e,t,i){"use strict";var r=i(48834).Buffer,n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundTxEthereumService=void 0;const s=i(96618),o=i(17280),a=i(45137);class c{constructor(e,t){this.chainsService=e,this.notification=t}init(){return n(this,void 0,void 0,(function*(){}))}sendEthereumTx(e,t,i){var u;return n(this,void 0,void 0,(function*(){i.silent||this.notification.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx is pending...",message:"Wait a second"});try{const d=this.chainsService.getChainInfoOrThrow(e),l=o.KeyRingEthereumService.evmInfo(d);if(!l)throw new Error("No EVM info provided");const h=yield(0,s.simpleFetch)(l.rpc,"",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"eth_sendRawTransaction",params:[`0x${r.from(t).toString("hex")}`],id:1})}),g=h.data.result;if(h.data.error||!g)throw null!==(u=h.data.error)&&void 0!==u?u:new Error("No tx hash responded");return(0,a.retry)((()=>new Promise(((e,t)=>n(this,void 0,void 0,(function*(){var r;const n=yield(0,s.simpleFetch)(l.rpc,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"eth_getTransactionReceipt",params:[g],id:1})});n.data.error&&(console.error(n.data.error),e());const o=n.data.result;o&&(null===(r=null==i?void 0:i.onFulfill)||void 0===r||r.call(i,o),c.processTxResultNotification(this.notification),e()),t()}))))),{maxRetries:10,waitMsAfterError:500,maxWaitMsAfterError:4e3}),g}catch(e){throw console.error(e),i.silent||c.processTxErrorNotification(this.notification,e),e}}))}static processTxResultNotification(e){try{e.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx succeeds",message:"Congratulations!"})}catch(t){c.processTxErrorNotification(e,t)}}static processTxErrorNotification(e,t){const i=t.message;e.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx failed",message:i})}}t.BackgroundTxEthereumService=c},28875:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="background-tx"},55345:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(47235),s=i(94024);t.getHandler=(e,t)=>(i,r)=>{if(r.constructor===s.SendTxMsg)return o(e,t)(i,r);throw new n.KeplrError("tx",110,"Unknown msg type")};const o=(e,t)=>(i,n)=>r(void 0,void 0,void 0,(function*(){return yield t.ensureEnabled(i,[n.chainId],n.origin),yield e.sendTx(n.chainId,n.tx,n.mode,{silent:n.silent})}))},75851:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(73044),t),n(i(94024),t),n(i(77988),t)},41801:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(94024),n=i(28875),s=i(55345);t.init=function(e,t,i){e.registerMessage(r.SendTxMsg),e.addHandler(n.ROUTE,(0,s.getHandler)(t,i))}},59715:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(73044),t),n(i(41801),t)},94024:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SendTxMsg=void 0;const r=i(47235),n=i(28875);class s extends r.Message{static type(){return"send-tx-to-background"}constructor(e,t,i,r){super(),this.chainId=e,this.tx=t,this.mode=i,this.silent=r}validateBasic(){if(!this.chainId)throw new r.KeplrError("tx",100,"chain id is empty");if(!this.tx)throw new r.KeplrError("tx",101,"tx is empty");if(!this.mode||"sync"!==this.mode&&"async"!==this.mode&&"block"!==this.mode)throw new r.KeplrError("tx",120,"invalid mode")}approveExternal(){return!this.silent}route(){return n.ROUTE}type(){return s.type()}}t.SendTxMsg=s},73044:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundTxService=void 0;const n=i(75263),s=i(96618),o=i(48834),a=i(45137);class c{constructor(e,t){this.chainsService=e,this.notification=t}init(){return r(this,void 0,void 0,(function*(){}))}sendTx(e,t,i,u){return r(this,void 0,void 0,(function*(){const r=this.chainsService.getChainInfoOrThrow(e);u.silent||this.notification.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx is pending...",message:"Wait a second"});const d=o.Buffer.isBuffer(t)||t instanceof Uint8Array,l=d?{tx_bytes:o.Buffer.from(t).toString("base64"),mode:(()=>{switch(i){case"async":return"BROADCAST_MODE_ASYNC";case"block":return"BROADCAST_MODE_BLOCK";case"sync":return"BROADCAST_MODE_SYNC";default:return"BROADCAST_MODE_UNSPECIFIED"}})()}:{tx:t,mode:i};try{const e=yield(0,s.simpleFetch)(r.rest,d?"/cosmos/tx/v1beta1/txs":"/txs",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(l)}),t=d?e.data.tx_response:e.data;if(null!=t.code&&0!==t.code)throw new Error(t.raw_log);const i=o.Buffer.from(t.txhash,"hex");return(0,a.retry)((()=>new Promise(((e,t)=>{const s=new n.TendermintTxTracer(r.rpc,"/websocket");s.addEventListener("close",(()=>{setTimeout((()=>{t()}),500)})),s.addEventListener("error",(()=>{t()})),s.traceTx(i).then((t=>{s.close(),u.onFulfill&&u.onFulfill(t),u.silent||c.processTxResultNotification(this.notification,t),e()}))}))),{maxRetries:10,waitMsAfterError:1e4,maxWaitMsAfterError:3e5}),i}catch(e){throw console.log(e),u.silent||c.processTxErrorNotification(this.notification,e),e}}))}static processTxResultNotification(e,t){var i;try{if("commit"===t.mode){if(void 0!==t.checkTx.code&&0!==t.checkTx.code)throw new Error(t.checkTx.log);if(void 0!==t.deliverTx.code&&0!==t.deliverTx.code)throw new Error(t.deliverTx.log)}else if(null!=t.code&&0!==t.code){const e=null!==(i=t.log)&&void 0!==i?i:t.raw_log;throw new Error(e)}e.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx succeeds",message:"Congratulations!"})}catch(t){c.processTxErrorNotification(e,t)}}static processTxErrorNotification(e,t){console.log(t);let i=t.message;const r=/code:\s*(-?\d+),\s*message:\s*(.+),\sdata:\s(.+)/g.exec(t.message);r&&4===r.length&&(i=r[3]);try{const e=JSON.parse(t.message);(null==e?void 0:e.message)&&(i=e.message)}catch(e){}try{const e=JSON.parse(t.message);if(e&&e.length>0)for(const t of e)if(!t.success){const e=JSON.parse(t.log);if(null==e?void 0:e.message){i=e.message;break}}}catch(e){}e.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx failed",message:i})}}t.BackgroundTxService=c},77988:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2554:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(36234),t),n(i(5018),t)},22433:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(36234),t)},36234:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},a=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VaultService=void 0;const u=i(47235),d=i(80075),l=i(58242),h=i(48834),g=o(i(8202)),f=c(i(30499)),p=i(81204);class y{constructor(e){this.kvStore=e,this.vaultMap=new Map,this.onVaultRemovedHandlers=[],this._isSignedUp=!1,this.password=new Uint8Array,this.aesCounter=new Uint8Array,this.decryptedCache=new Map,this.userPasswordSalt=new Uint8Array,this.aesCounterSalt=new Uint8Array,this.getVault=(0,l.computedFn)(((e,t)=>{const i=this.vaultMap.get(e);if(i&&0!==i.length)return i.find((e=>e.id===t))}),{keepAlive:!0}),(0,d.makeObservable)(this)}init(){return a(this,void 0,void 0,(function*(){(yield this.getPasswordCryptoState())&&(this._isSignedUp=!0);const e=yield this.kvStore.get("userPasswordSalt");if(e)this.userPasswordSalt=h.Buffer.from(e,"hex");else{const e=new Uint8Array(16);crypto.getRandomValues(e),this.userPasswordSalt=e,yield this.kvStore.set("userPasswordSalt",h.Buffer.from(this.userPasswordSalt).toString("hex"))}const t=yield this.kvStore.get("aesCounterSalt");if(t)this.aesCounterSalt=h.Buffer.from(t,"hex");else{const e=new Uint8Array(16);crypto.getRandomValues(e),this.aesCounterSalt=e,yield this.kvStore.set("aesCounterSalt",h.Buffer.from(this.aesCounterSalt).toString("hex"))}const i=yield this.kvStore.get("vaultMap");i&&(0,d.runInAction)((()=>{for(const[e,t]of u.JSONUint8Array.unwrap(Object.entries(i)))this.vaultMap.set(e,t)})),(0,d.autorun)((()=>{const e=(0,d.toJS)(this.vaultMap),t=Object.fromEntries(e);this.kvStore.set("vaultMap",u.JSONUint8Array.wrap(t))}))}))}get isSignedUp(){return this._isSignedUp}signUp(e){return a(this,void 0,void 0,(function*(){if(!this.isLocked)throw new Error("Vault is already unlocked");if(0===this.userPasswordSalt.length)throw new Error("User password salt not initialized");if(0===this.aesCounterSalt.length)throw new Error("AES counter salt not initialized");if(this.isSignedUp||(yield this.getPasswordCryptoState())||(yield this.kvStore.get("aesCounterCipher")))throw new Error("Vault is already signed up");const t=yield y.generatePassword(e,this.userPasswordSalt);yield this.setPasswordCryptoState(t.cipher,t.mac);const i=new Uint8Array(16);crypto.getRandomValues(i);const r=y.aesEncrypt(t.password,this.aesCounterSalt,i);yield this.kvStore.set("aesCounterCipher",h.Buffer.from(r).toString("hex")),this._isSignedUp=!0,yield this.unlock(e)}))}checkUserPassword(e){return a(this,void 0,void 0,(function*(){if(this.isLocked)throw new Error("Vault is not unlocked");if(0===this.userPasswordSalt.length)throw new Error("User password salt not initialized");const t=yield this.getPasswordCryptoState();if(!this.isSignedUp||!t)throw new Error("Vault is not signed up");const i=yield y.decryptPassword(e,this.userPasswordSalt,t.mac,t.cipher);if(h.Buffer.from(i).toString("hex")!==h.Buffer.from(this.password).toString("hex"))throw new Error("Password unmatched")}))}changeUserPassword(e,t){return a(this,void 0,void 0,(function*(){yield this.checkUserPassword(e);const i=yield y.encryptPassword(t,this.userPasswordSalt,this.password);yield this.setPasswordCryptoState(i.cipher,i.mac)}))}lock(){this.password=new Uint8Array(0),this.decryptedCache=new Map}unlock(e){return a(this,void 0,void 0,(function*(){if(!this.isLocked)throw new Error("Vault is already unlocked");if(0===this.userPasswordSalt.length)throw new Error("User password salt not initialized");if(0===this.aesCounterSalt.length)throw new Error("AES counter salt not initialized");const t=yield this.kvStore.get("aesCounterCipher");if(!t)throw new Error("AES counter cipher not found");const i=yield this.getPasswordCryptoState();if(!i)throw new Error("Vault have not been signed in");this.password=yield y.decryptPassword(e,this.userPasswordSalt,i.mac,i.cipher),this.aesCounter=y.aesDecrypt(this.password,this.aesCounterSalt,h.Buffer.from(t,"hex"))}))}get isLocked(){return 0===this.password.length}getVaults(e){const t=this.vaultMap.get(e);return null!=t?t:[]}addVault(e,t,i){this.vaultMap.has(e)||this.vaultMap.set(e,[]);const r=this.vaultMap.get(e),n=new Uint8Array(8);crypto.getRandomValues(n);const s=h.Buffer.from(n).toString("hex");return r.push({id:s,insensitive:t,sensitive:this.encrypt(i)}),s}setAndMergeInsensitiveToVault(e,t,i){const r=this.vaultMap.get(e);if(!r||0===r.length)throw new Error(`There is no vault for ${t}`);const n=r.findIndex((e=>e.id===t));if(n<0)throw new Error(`There is no vault for ${t}`);const s=r[n];r[n]=Object.assign(Object.assign({},s),{insensitive:Object.assign(Object.assign({},s.insensitive),i)})}removeVault(e,t){const i=this.vaultMap.get(e);if(!i||0===i.length)throw new Error(`There is no vault for ${t}`);if(!i.find((e=>e.id===t)))throw new Error(`There is no vault for ${t}`);const r=i.filter((e=>e.id!==t));this.vaultMap.set(e,r);for(const i of this.onVaultRemovedHandlers)i(e,t)}encrypt(e){return this.ensureUnlockAndState(),y.aesEncrypt(this.password,this.aesCounter,h.Buffer.from(JSON.stringify(e)))}decrypt(e){this.ensureUnlockAndState();const t=h.Buffer.from(e).toString("hex"),i=this.decryptedCache.get(t);if(i)return i;const r=JSON.parse(h.Buffer.from(y.aesDecrypt(this.password,this.aesCounter,e)).toString());return this.decryptedCache.set(t,r),r}ensureUnlockAndState(){if(this.isLocked)throw new Error("Vault is not unlocked");if(0===this.userPasswordSalt.length)throw new Error("User password salt not initialized");if(0===this.aesCounter.length)throw new Error("AES counter is null")}setPasswordCryptoState(e,t){return a(this,void 0,void 0,(function*(){yield this.kvStore.set("passwordCipher",h.Buffer.from(e).toString("hex")),yield this.kvStore.set("userPasswordMac",h.Buffer.from(t).toString("hex"))}))}getPasswordCryptoState(){return a(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("passwordCipher"),t=yield this.kvStore.get("userPasswordMac");if(e&&t)return{cipher:h.Buffer.from(e,"hex"),mac:h.Buffer.from(t,"hex")}}))}clearAll(e){return a(this,void 0,void 0,(function*(){yield this.checkUserPassword(e);const t=[];for(const[e,i]of this.vaultMap.entries())for(const r of i)t.push({type:e,id:r.id});(0,d.runInAction)((()=>{this.vaultMap=new Map,this._isSignedUp=!1,this.password=new Uint8Array,this.decryptedCache=new Map,this.aesCounter=new Uint8Array})),yield Promise.all([this.kvStore.set("passwordCipher",null),this.kvStore.set("userPasswordMac",null),this.kvStore.set("aesCounterCipher",null)]);for(const e of t)for(const t of this.onVaultRemovedHandlers)t(e.type,e.id)}))}static pbkdf2(e,t){return new Promise(((i,r)=>{f.default.pbkdf2(t,e,4e3,32,"sha256",((e,t)=>{e?r(e):i(new Uint8Array(t))}))}))}static aesEncrypt(e,t,i){const r=new g.Counter(0);return r.setBytes(t),new g.default.ModeOfOperation.ctr(e,r).encrypt(i)}static aesDecrypt(e,t,i){const r=new g.Counter(0);return r.setBytes(t),new g.default.ModeOfOperation.ctr(e,r).decrypt(i)}static generatePassword(e,t){return a(this,void 0,void 0,(function*(){const i=new Uint8Array(32);return crypto.getRandomValues(i),Object.assign(Object.assign({},yield y.encryptPassword(e,t,i)),{password:i})}))}static encryptPassword(e,t,i){return a(this,void 0,void 0,(function*(){const r=yield y.pbkdf2(t,h.Buffer.from(e)),n=y.aesEncrypt(r,t,i),s=p.Hash.sha256(h.Buffer.concat([r.slice(r.length/2),n.slice(n.length/2)]));return{cipher:n,mac:s}}))}static decryptPassword(e,t,i,r){return a(this,void 0,void 0,(function*(){const n=yield y.pbkdf2(t,h.Buffer.from(e)),s=p.Hash.sha256(h.Buffer.concat([n.slice(n.length/2),r.slice(r.length/2)]));if(h.Buffer.from(s).toString("hex")!==h.Buffer.from(i).toString("hex"))throw new Error("User password mac unmatched");return y.aesDecrypt(n,t,r)}))}addVaultRemovedHandler(e){this.onVaultRemovedHandlers.push(e)}}s([d.observable],y.prototype,"vaultMap",void 0),s([d.action],y.prototype,"addVault",null),s([d.action],y.prototype,"setAndMergeInsensitiveToVault",null),s([d.action],y.prototype,"removeVault",null),t.VaultService=y},5018:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},20601:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBasicChainInfoType=void 0;const n=i(45791);t.validateBasicChainInfoType=function(e,t=!0){return r(this,void 0,void 0,(function*(){return yield n.ChainInfoSchema.validateAsync(e,{stripUnknown:t})}))}},85870:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.checkRestConnectivity=t.checkRPCConnectivity=t.DifferentChainVersionError=void 0;const n=i(75263),s=i(96618);class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,o.prototype)}}t.DifferentChainVersionError=o,t.checkRPCConnectivity=function(e,t,i){return r(this,void 0,void 0,(function*(){let r;try{r=yield(0,s.simpleFetch)(t,"/status")}catch(e){throw console.log(e),new Error("Failed to get response /status from rpc endpoint")}const a=n.ChainIdHelper.parse(e),c="result"in r.data?r.data.result:r.data,u=n.ChainIdHelper.parse(c.node_info.network);if(u.identifier!==a.identifier)throw new Error(`RPC endpoint has different chain id (expected: ${e}, actual: ${c.node_info.network})`);if(u.version!==a.version)throw new o(`RPC endpoint has different chain id (expected: ${e}, actual: ${c.node_info.network})`);let d=t;d.startsWith("http")&&(d=d.replace("http","ws")),d=d.endsWith("/")?d+"websocket":d+"/websocket";const l=i?i(d):new WebSocket(d);l.onerror=()=>{};let h=!1;for(let e=0;e<15;e++){if(0!==l.readyState){if(1===l.readyState){h=!0;break}throw new Error("Failed to connect websocket to /websocket rpc")}yield new Promise((e=>setTimeout(e,1e3)))}if(l.close(),!h)throw new Error("Failed to connect websocket to /websocket rpc")}))},t.checkRestConnectivity=function(e,t){return r(this,void 0,void 0,(function*(){let i;try{i=yield(0,s.simpleFetch)(t,"/cosmos/base/tendermint/v1beta1/node_info")}catch(e){throw console.log(e),new Error("Failed to get response /cosmos/base/tendermint/v1beta1/node_info from lcd endpoint")}const r=n.ChainIdHelper.parse(e),a=n.ChainIdHelper.parse(i.data.default_node_info.network);if(a.identifier!==r.identifier)throw new Error(`LCD endpoint has different chain id (expected: ${e}, actual: ${i.data.default_node_info.network})`);if(a.version!==r.version)throw new o(`LCD endpoint has different chain id (expected: ${e}, actual: ${i.data.default_node_info.network})`)}))}},56305:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.hasFeature=t.checkChainFeatures=t.NonRecognizableChainFeatures=t.RecognizableChainFeatures=t.RecognizableChainFeaturesMethod=t.SupportedChainFeatures=void 0;const n=i(96618);t.SupportedChainFeatures=["stargate","cosmwasm","wasmd_0.24+","secretwasm","ibc-transfer","no-legacy-stdTx","ibc-go","eth-address-gen","eth-key-sign","query:/cosmos/bank/v1beta1/spendable_balances","axelar-evm-bridge","osmosis-txfees","terra-classic-fee","ibc-go-v7-hot-fix","ibc-pfm","authz-msg-revoke-fixed","osmosis-base-fee-beta"],t.RecognizableChainFeaturesMethod=[{feature:"ibc-go",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){return 200===(yield(0,n.simpleFetch)(i,"/ibc/apps/transfer/v1/params",{validateStatus:e=>200===e||501===e})).status}))},{feature:"ibc-transfer",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){const t=e.includes("ibc-go")?"/ibc/apps/transfer/v1/params":"/ibc/applications/transfer/v1beta1/params",r=yield(0,n.simpleFetch)(i,t,{validateStatus:e=>200===e||501===e});return 200===r.status&&r.data.params.receive_enabled&&r.data.params.send_enabled}))},{feature:"ibc-pfm",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){return!(!e.includes("ibc-go")||200!==(yield(0,n.simpleFetch)(i,"/ibc/apps/router/v1/params",{validateStatus:e=>200===e||501===e})).status)}))},{feature:"wasmd_0.24+",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){return!(!e.includes("cosmwasm")||400!==(yield(0,n.simpleFetch)(i,"/cosmwasm/wasm/v1/contract/test/smart/test",{validateStatus:e=>400===e||501===e})).status)}))},{feature:"query:/cosmos/bank/v1beta1/spendable_balances",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){return 400===(yield(0,n.simpleFetch)(i,"/cosmos/bank/v1beta1/spendable_balances/test",{validateStatus:e=>400===e||501===e})).status}))}],t.RecognizableChainFeatures=t.RecognizableChainFeaturesMethod.map((e=>e.feature)),t.NonRecognizableChainFeatures=(()=>{const e={};for(const i of t.RecognizableChainFeatures)e[i]=!0;const i=[];for(const r of t.SupportedChainFeatures)e[r]||i.push(r);return i})(),t.checkChainFeatures=function(e){var i,n;return r(this,void 0,void 0,(function*(){const r=[],s=null!==(n=null===(i=e.features)||void 0===i?void 0:i.slice())&&void 0!==n?n:[];for(const i of t.RecognizableChainFeaturesMethod)if(!s.includes(i.feature))try{(yield i.fetch(s,e.rpc,e.rest))&&(r.push(i.feature),s.push(i.feature))}catch(e){console.log(`Failed to try to fetch feature (${i.feature}): ${e.message||e}`)}return r}))},t.hasFeature=function(e,i){var n,s,o;return r(this,void 0,void 0,(function*(){if(null===(n=e.features)||void 0===n?void 0:n.includes(i))return!0;const r=t.RecognizableChainFeaturesMethod.find((e=>e.feature===i));if(!r)throw new Error(`${i} not exist on RecognizableChainFeaturesMethod`);return r.fetch(null!==(o=null===(s=e.features)||void 0===s?void 0:s.slice())&&void 0!==o?o:[],e.rpc,e.rest)}))}},10843:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(45791),t),n(i(20601),t),n(i(85870),t),n(i(56305),t)},45791:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChainInfoSchema=t.SuggestingBIP44Schema=t.Bech32ConfigSchema=t.FeeCurrencySchema=t.ERC20CurrencySchema=t.Secret20CurrencySchema=t.CW20CurrencySchema=t.CurrencySchema=void 0;const n=i(56305),s=r(i(72903));t.CurrencySchema=s.default.object({coinDenom:s.default.string().required(),coinMinimalDenom:s.default.string().required(),coinDecimals:s.default.number().strict().integer().min(0).max(18).required(),coinGeckoId:s.default.string(),coinImageUrl:s.default.string().uri()}).keys({type:s.default.forbidden()}),t.CW20CurrencySchema=t.CurrencySchema.keys({type:s.default.string().equal("cw20").required(),contractAddress:s.default.string().required()}).custom((e=>e.coinMinimalDenom.startsWith(`${e.type}:${e.contractAddress}:`)?e:Object.assign(Object.assign({},e),{coinMinimalDenom:`${e.type}:${e.contractAddress}:`+e.coinMinimalDenom}))),t.Secret20CurrencySchema=t.CurrencySchema.keys({type:s.default.string().equal("secret20").required(),contractAddress:s.default.string().required(),viewingKey:s.default.string().required()}).custom((e=>e.coinMinimalDenom.startsWith(`${e.type}:${e.contractAddress}:`)?e:Object.assign(Object.assign({},e),{coinMinimalDenom:`${e.type}:${e.contractAddress}:`+e.coinMinimalDenom}))),t.ERC20CurrencySchema=t.CurrencySchema.keys({type:s.default.string().equal("erc20").required(),contractAddress:s.default.string().pattern(/^(0x)[0-9a-fA-F]{40}$/).required()}).custom((e=>e.coinMinimalDenom.startsWith(`${e.type}:${e.contractAddress}:`)?e:Object.assign(Object.assign({},e),{coinMinimalDenom:`${e.type}:${e.contractAddress}`})));const o=s.default.object({low:s.default.number().strict().required(),average:s.default.number().strict().required(),high:s.default.number().strict().required()}).custom((e=>{if(e.low>e.average)throw new Error("Low gas price step can not be greater than average");if(e.average>e.high)throw new Error("Average gas price step can not be greater than high");return e}));t.FeeCurrencySchema=t.CurrencySchema.keys({gasPriceStep:o}),t.Bech32ConfigSchema=s.default.object({bech32PrefixAccAddr:s.default.string().required(),bech32PrefixAccPub:s.default.string().required(),bech32PrefixValAddr:s.default.string().required(),bech32PrefixValPub:s.default.string().required(),bech32PrefixConsAddr:s.default.string().required(),bech32PrefixConsPub:s.default.string().required()}),t.SuggestingBIP44Schema=s.default.object({coinType:s.default.number().strict().integer().min(0).required()}).unknown(!0),t.ChainInfoSchema=s.default.object({rpc:s.default.string().uri().custom((e=>{if(e.includes("?"))throw new Error("rpc should not have query string");return e})).required(),rest:s.default.string().uri().custom((e=>{if(e.includes("?"))throw new Error("rest should not have query string");return e})).required(),evm:s.default.object({chainId:s.default.number().required(),rpc:s.default.string().custom((e=>{if(e.includes("?"))throw new Error("evm rpc should not have query string");return e})).required()}).unknown(!0),nodeProvider:s.default.object({name:s.default.string().min(1).max(30).required(),email:s.default.string().email({tlds:{allow:!1}}).required(),website:s.default.string().uri()}),chainId:s.default.string().required().min(1).max(30),chainName:s.default.string().required().min(1).max(30),stakeCurrency:t.CurrencySchema,walletUrl:s.default.string().uri(),walletUrlForStaking:s.default.string().uri(),bip44:t.SuggestingBIP44Schema.required(),alternativeBIP44s:s.default.array().items(t.SuggestingBIP44Schema).custom((e=>{const t={};for(const i of e){if(t[i.coinType])throw new Error(`coin type ${i.coinType} is duplicated`);t[i.coinType]=!0}return e})),bech32Config:t.Bech32ConfigSchema.required(),currencies:s.default.array().min(1).items(t.CurrencySchema,t.CW20CurrencySchema,t.Secret20CurrencySchema).custom((e=>{const t={};for(const i of e){if(t[i.coinMinimalDenom])throw new Error(`${i.coinMinimalDenom} is duplicated`);t[i.coinMinimalDenom]=!0}return e})).required(),feeCurrencies:s.default.array().min(1).items(t.FeeCurrencySchema).custom((e=>{const t={};for(const i of e){if(t[i.coinMinimalDenom])throw new Error(`${i.coinMinimalDenom} is duplicated`);t[i.coinMinimalDenom]=!0}return e})).required(),beta:s.default.boolean(),features:s.default.array().items(s.default.string().valid(...n.SupportedChainFeatures)).unique().custom((e=>{if(e.indexOf("cosmwasm")>=0&&e.indexOf("secretwasm")>=0)throw new Error("cosmwasm and secretwasm are not compatible");return e})),chainSymbolImageUrl:s.default.string().uri(),hideInUI:s.default.boolean()}).custom((e=>{var t;if(null===(t=e.alternativeBIP44s)||void 0===t?void 0:t.find((t=>t.coinType===e.bip44.coinType)))throw new Error(`coin type ${e.bip44.coinType} is duplicated`);if(e.stakeCurrency&&!e.currencies.find((t=>{var i;return t.coinMinimalDenom===(null===(i=e.stakeCurrency)||void 0===i?void 0:i.coinMinimalDenom)})))throw new Error(`stake currency ${e.stakeCurrency.coinMinimalDenom} is not included in currencies`);return e}))},58080:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseCoinStr=t.isValidCoinStr=void 0,t.isValidCoinStr=function(e){const t=e.split(/^([0-9]+)(\s)*([a-zA-Z][a-zA-Z0-9/-]*)$/);return 5===t.length&&t[1].length>0&&t[3].length>0&&!Number.isNaN(parseInt(t[1]))},t.parseCoinStr=function(e){const t=e.split(/^([0-9]+)(\s)*([a-zA-Z][a-zA-Z0-9/-]*)$/);if(5===t.length)return{denom:t[3],amount:t[1]};throw new Error(`Invalid coin string: ${e}`)}},92445:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DenomHelper=void 0;const r=i(48834),n=i(81204);t.DenomHelper=class{static ibcDenom(e,t){const i=[];for(const t of e)i.push(`${t.portId}/${t.channelId}`);const s=`${i.join("/")}/${t}`;return"ibc/"+r.Buffer.from(n.Hash.sha256(r.Buffer.from(s))).toString("hex").toUpperCase()}constructor(e){this._denom=e;let t=this.denom.split(/^(\w+):(\w+)$/).filter(Boolean);if(2!==t.length&&(t=this.denom.split(/^(\w+):(\w+):(.+)$/).filter(Boolean),1!==t.length&&3!==t.length))throw new Error(`Invalid denom: ${this.denom}`);this._type=t.length>=2?t[0]:"",this._contractAddress=t.length>=2?t[1]:""}get denom(){return this._denom}get type(){return this._type||"native"}get contractAddress(){return this._contractAddress}}},99471:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeHTML=t.escapeHTML=void 0,t.escapeHTML=function(e){return e.replace(/</g,"\\u003c").replace(/>/g,"\\u003e").replace(/&/g,"\\u0026")},t.unescapeHTML=function(e){return e.replace(/\\u003c/g,"<").replace(/\\u003e/g,">").replace(/\\u0026/g,"&")}},35236:(e,t)=>{"use strict";function i(e){const t=e.split(".");if(2===t.length&&t[0].length>0&&t[1].length>0)return[t[0],t[1]]}Object.defineProperty(t,"__esModule",{value:!0}),t.validateICNSName=t.parseICNSName=void 0,t.parseICNSName=i,t.validateICNSName=function(e,t){const r=i(e);return!!r&&r[1]===t}},45137:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(95920),t),n(i(92445),t),n(i(96793),t),n(i(88408),t),n(i(99471),t),n(i(75929),t),n(i(35236),t),n(i(97392),t),n(i(60194),t),n(i(49800),t),n(i(58080),t)},75929:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(28124),t)},28124:(e,t)=>{"use strict";function i(e){if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return e.map(i);const t=Object.keys(e).sort(),r={};return t.forEach((t=>{r[t]=i(e[t])})),r}Object.defineProperty(t,"__esModule",{value:!0}),t.sortedJsonByKeyStringify=t.sortObjectByKey=void 0,t.sortObjectByKey=i,t.sortedJsonByKeyStringify=function(e){return JSON.stringify(i(e))}},39988:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseKVStore=void 0,t.BaseKVStore=class{constructor(e,t){this.provider=e,this._prefix=t}get(e){return i(this,void 0,void 0,(function*(){const t=this.prefix()+"/"+e;return(yield this.provider.get(t))[t]}))}set(e,t){const i=this.prefix()+"/"+e;return this.provider.set({[i]:t})}prefix(){return this._prefix}}},7177:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionKVStore=void 0;const n=i(39988);class s extends n.BaseKVStore{constructor(e){if(s.KVStoreProvider||("undefined"==typeof browser?console.log("You should use ExtensionKVStore on the extension environment."):browser.storage&&browser.storage.local?s.KVStoreProvider={get:browser.storage.local.get,set:browser.storage.local.set,multiGet:browser.storage.local.get}:console.log("The 'browser' exists, but it doesn't seem to be an extension environment. This can happen in Safari browser.")),!s.KVStoreProvider)throw new Error("Can't initialize kv store for browser extension");super(s.KVStoreProvider,e)}multiGet(e){var t;return r(this,void 0,void 0,(function*(){e=Array.from(new Set(e));const i=null!==(t=yield s.KVStoreProvider.multiGet(e.map((e=>this.prefix()+"/"+e))))&&void 0!==t?t:{},r=Object.keys(i);for(const e of r)i[e.slice(this.prefix().length+1)]=i[e],delete i[e];return i}))}}t.ExtensionKVStore=s},95920:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(8366),t),n(i(7177),t),n(i(39988),t),n(i(97510),t),n(i(10793),t),n(i(48015),t),n(i(55844),t),n(i(66467),t)},48015:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDBKVStore=void 0,t.IndexedDBKVStore=class{constructor(e){this._prefix=e}get(e){return i(this,void 0,void 0,(function*(){const t=(yield this.getDB()).transaction([this.prefix()],"readonly").objectStore(this.prefix());return new Promise(((i,r)=>{const n=t.get(e);n.onerror=e=>{e.stopPropagation(),r(e.target)},n.onsuccess=()=>{n.result?i(n.result.data):i(void 0)}}))}))}set(e,t){return i(this,void 0,void 0,(function*(){if(null===t){const t=(yield this.getDB()).transaction([this.prefix()],"readwrite").objectStore(this.prefix());return new Promise(((i,r)=>{const n=t.delete(e);n.onerror=e=>{e.stopPropagation(),r(e.target)},n.onsuccess=()=>{i()}}))}{const i=(yield this.getDB()).transaction([this.prefix()],"readwrite").objectStore(this.prefix());return new Promise(((r,n)=>{const s=i.put({key:e,data:t});s.onerror=e=>{e.stopPropagation(),n(e.target)},s.onsuccess=()=>{r()}}))}}))}prefix(){return this._prefix}getDB(){return i(this,void 0,void 0,(function*(){return this.cachedDB?this.cachedDB:new Promise(((e,t)=>{const i=window.indexedDB.open(this.prefix());i.onerror=e=>{e.stopPropagation(),t(e.target)},i.onupgradeneeded=e=>{e.target.result.createObjectStore(this.prefix(),{keyPath:"key"})},i.onsuccess=()=>{this.cachedDB=i.result,e(i.result)}}))}))}}},8366:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},10793:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalKVStore=void 0,t.LocalKVStore=class{constructor(e){this._prefix=e}get(e){const t=this.prefix()+"/"+e,i=localStorage.getItem(t);return null===i?Promise.resolve(void 0):Promise.resolve(JSON.parse(i))}set(e,t){const i=this.prefix()+"/"+e;return null===t?Promise.resolve(localStorage.removeItem(i)):Promise.resolve(localStorage.setItem(i,JSON.stringify(t)))}prefix(){return this._prefix}}},97510:(e,t,i)=>{"use strict";i(34406),Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryKVStore=void 0;const r=i(39988);class n{constructor(){this.store={}}get(e){return Promise.resolve({[e]:this.store[e]})}set(e){return this.store=Object.assign(Object.assign({},this.store),e),Promise.resolve()}checkNotPrimitiveField(e){Object.keys(e).forEach((t=>{const i=e[t];if(null!=i&&"object"==typeof i){if(i.constructor!==Object&&i.constructor!==Array)throw new Error(`${t} may not be serializable: ${i.constructor.name}`);this.checkNotPrimitiveField(i)}}))}}class s extends r.BaseKVStore{constructor(e){super(new n,e)}}t.MemoryKVStore=s},66467:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WrapMultiGetKVStore=void 0,t.WrapMultiGetKVStore=class{constructor(e){this.kvStore=e}multiGet(e){return i(this,void 0,void 0,(function*(){e=Array.from(new Set(e));const t={},r=[];for(const n of e)r.push((()=>i(this,void 0,void 0,(function*(){t[n]=yield this.kvStore.get(n)})))());return yield Promise.all(r),t}))}}},55844:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PrefixKVStore=void 0,t.PrefixKVStore=class{constructor(e,t){this.kvStore=e,this._prefix=t}prefix(){return this._prefix}get(e){return i(this,void 0,void 0,(function*(){const t=this.prefix()+"/"+e;return yield this.kvStore.get(t)}))}set(e,t){return i(this,void 0,void 0,(function*(){const i=this.prefix()+"/"+e;return yield this.kvStore.set(i,t)}))}}},49800:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMnemonicWord=void 0,t.isMnemonicWord=function(e){return!!i[e]};const i={abandon:!0,ability:!0,able:!0,about:!0,above:!0,absent:!0,absorb:!0,abstract:!0,absurd:!0,abuse:!0,access:!0,accident:!0,account:!0,accuse:!0,achieve:!0,acid:!0,acoustic:!0,acquire:!0,across:!0,act:!0,action:!0,actor:!0,actress:!0,actual:!0,adapt:!0,add:!0,addict:!0,address:!0,adjust:!0,admit:!0,adult:!0,advance:!0,advice:!0,aerobic:!0,affair:!0,afford:!0,afraid:!0,again:!0,age:!0,agent:!0,agree:!0,ahead:!0,aim:!0,air:!0,airport:!0,aisle:!0,alarm:!0,album:!0,alcohol:!0,alert:!0,alien:!0,all:!0,alley:!0,allow:!0,almost:!0,alone:!0,alpha:!0,already:!0,also:!0,alter:!0,always:!0,amateur:!0,amazing:!0,among:!0,amount:!0,amused:!0,analyst:!0,anchor:!0,ancient:!0,anger:!0,angle:!0,angry:!0,animal:!0,ankle:!0,announce:!0,annual:!0,another:!0,answer:!0,antenna:!0,antique:!0,anxiety:!0,any:!0,apart:!0,apology:!0,appear:!0,apple:!0,approve:!0,april:!0,arch:!0,arctic:!0,area:!0,arena:!0,argue:!0,arm:!0,armed:!0,armor:!0,army:!0,around:!0,arrange:!0,arrest:!0,arrive:!0,arrow:!0,art:!0,artefact:!0,artist:!0,artwork:!0,ask:!0,aspect:!0,assault:!0,asset:!0,assist:!0,assume:!0,asthma:!0,athlete:!0,atom:!0,attack:!0,attend:!0,attitude:!0,attract:!0,auction:!0,audit:!0,august:!0,aunt:!0,author:!0,auto:!0,autumn:!0,average:!0,avocado:!0,avoid:!0,awake:!0,aware:!0,away:!0,awesome:!0,awful:!0,awkward:!0,axis:!0,baby:!0,bachelor:!0,bacon:!0,badge:!0,bag:!0,balance:!0,balcony:!0,ball:!0,bamboo:!0,banana:!0,banner:!0,bar:!0,barely:!0,bargain:!0,barrel:!0,base:!0,basic:!0,basket:!0,battle:!0,beach:!0,bean:!0,beauty:!0,because:!0,become:!0,beef:!0,before:!0,begin:!0,behave:!0,behind:!0,believe:!0,below:!0,belt:!0,bench:!0,benefit:!0,best:!0,betray:!0,better:!0,between:!0,beyond:!0,bicycle:!0,bid:!0,bike:!0,bind:!0,biology:!0,bird:!0,birth:!0,bitter:!0,black:!0,blade:!0,blame:!0,blanket:!0,blast:!0,bleak:!0,bless:!0,blind:!0,blood:!0,blossom:!0,blouse:!0,blue:!0,blur:!0,blush:!0,board:!0,boat:!0,body:!0,boil:!0,bomb:!0,bone:!0,bonus:!0,book:!0,boost:!0,border:!0,boring:!0,borrow:!0,boss:!0,bottom:!0,bounce:!0,box:!0,boy:!0,bracket:!0,brain:!0,brand:!0,brass:!0,brave:!0,bread:!0,breeze:!0,brick:!0,bridge:!0,brief:!0,bright:!0,bring:!0,brisk:!0,broccoli:!0,broken:!0,bronze:!0,broom:!0,brother:!0,brown:!0,brush:!0,bubble:!0,buddy:!0,budget:!0,buffalo:!0,build:!0,bulb:!0,bulk:!0,bullet:!0,bundle:!0,bunker:!0,burden:!0,burger:!0,burst:!0,bus:!0,business:!0,busy:!0,butter:!0,buyer:!0,buzz:!0,cabbage:!0,cabin:!0,cable:!0,cactus:!0,cage:!0,cake:!0,call:!0,calm:!0,camera:!0,camp:!0,can:!0,canal:!0,cancel:!0,candy:!0,cannon:!0,canoe:!0,canvas:!0,canyon:!0,capable:!0,capital:!0,captain:!0,car:!0,carbon:!0,card:!0,cargo:!0,carpet:!0,carry:!0,cart:!0,case:!0,cash:!0,casino:!0,castle:!0,casual:!0,cat:!0,catalog:!0,catch:!0,category:!0,cattle:!0,caught:!0,cause:!0,caution:!0,cave:!0,ceiling:!0,celery:!0,cement:!0,census:!0,century:!0,cereal:!0,certain:!0,chair:!0,chalk:!0,champion:!0,change:!0,chaos:!0,chapter:!0,charge:!0,chase:!0,chat:!0,cheap:!0,check:!0,cheese:!0,chef:!0,cherry:!0,chest:!0,chicken:!0,chief:!0,child:!0,chimney:!0,choice:!0,choose:!0,chronic:!0,chuckle:!0,chunk:!0,churn:!0,cigar:!0,cinnamon:!0,circle:!0,citizen:!0,city:!0,civil:!0,claim:!0,clap:!0,clarify:!0,claw:!0,clay:!0,clean:!0,clerk:!0,clever:!0,click:!0,client:!0,cliff:!0,climb:!0,clinic:!0,clip:!0,clock:!0,clog:!0,close:!0,cloth:!0,cloud:!0,clown:!0,club:!0,clump:!0,cluster:!0,clutch:!0,coach:!0,coast:!0,coconut:!0,code:!0,coffee:!0,coil:!0,coin:!0,collect:!0,color:!0,column:!0,combine:!0,come:!0,comfort:!0,comic:!0,common:!0,company:!0,concert:!0,conduct:!0,confirm:!0,congress:!0,connect:!0,consider:!0,control:!0,convince:!0,cook:!0,cool:!0,copper:!0,copy:!0,coral:!0,core:!0,corn:!0,correct:!0,cost:!0,cotton:!0,couch:!0,country:!0,couple:!0,course:!0,cousin:!0,cover:!0,coyote:!0,crack:!0,cradle:!0,craft:!0,cram:!0,crane:!0,crash:!0,crater:!0,crawl:!0,crazy:!0,cream:!0,credit:!0,creek:!0,crew:!0,cricket:!0,crime:!0,crisp:!0,critic:!0,crop:!0,cross:!0,crouch:!0,crowd:!0,crucial:!0,cruel:!0,cruise:!0,crumble:!0,crunch:!0,crush:!0,cry:!0,crystal:!0,cube:!0,culture:!0,cup:!0,cupboard:!0,curious:!0,current:!0,curtain:!0,curve:!0,cushion:!0,custom:!0,cute:!0,cycle:!0,dad:!0,damage:!0,damp:!0,dance:!0,danger:!0,daring:!0,dash:!0,daughter:!0,dawn:!0,day:!0,deal:!0,debate:!0,debris:!0,decade:!0,december:!0,decide:!0,decline:!0,decorate:!0,decrease:!0,deer:!0,defense:!0,define:!0,defy:!0,degree:!0,delay:!0,deliver:!0,demand:!0,demise:!0,denial:!0,dentist:!0,deny:!0,depart:!0,depend:!0,deposit:!0,depth:!0,deputy:!0,derive:!0,describe:!0,desert:!0,design:!0,desk:!0,despair:!0,destroy:!0,detail:!0,detect:!0,develop:!0,device:!0,devote:!0,diagram:!0,dial:!0,diamond:!0,diary:!0,dice:!0,diesel:!0,diet:!0,differ:!0,digital:!0,dignity:!0,dilemma:!0,dinner:!0,dinosaur:!0,direct:!0,dirt:!0,disagree:!0,discover:!0,disease:!0,dish:!0,dismiss:!0,disorder:!0,display:!0,distance:!0,divert:!0,divide:!0,divorce:!0,dizzy:!0,doctor:!0,document:!0,dog:!0,doll:!0,dolphin:!0,domain:!0,donate:!0,donkey:!0,donor:!0,door:!0,dose:!0,double:!0,dove:!0,draft:!0,dragon:!0,drama:!0,drastic:!0,draw:!0,dream:!0,dress:!0,drift:!0,drill:!0,drink:!0,drip:!0,drive:!0,drop:!0,drum:!0,dry:!0,duck:!0,dumb:!0,dune:!0,during:!0,dust:!0,dutch:!0,duty:!0,dwarf:!0,dynamic:!0,eager:!0,eagle:!0,early:!0,earn:!0,earth:!0,easily:!0,east:!0,easy:!0,echo:!0,ecology:!0,economy:!0,edge:!0,edit:!0,educate:!0,effort:!0,egg:!0,eight:!0,either:!0,elbow:!0,elder:!0,electric:!0,elegant:!0,element:!0,elephant:!0,elevator:!0,elite:!0,else:!0,embark:!0,embody:!0,embrace:!0,emerge:!0,emotion:!0,employ:!0,empower:!0,empty:!0,enable:!0,enact:!0,end:!0,endless:!0,endorse:!0,enemy:!0,energy:!0,enforce:!0,engage:!0,engine:!0,enhance:!0,enjoy:!0,enlist:!0,enough:!0,enrich:!0,enroll:!0,ensure:!0,enter:!0,entire:!0,entry:!0,envelope:!0,episode:!0,equal:!0,equip:!0,era:!0,erase:!0,erode:!0,erosion:!0,error:!0,erupt:!0,escape:!0,essay:!0,essence:!0,estate:!0,eternal:!0,ethics:!0,evidence:!0,evil:!0,evoke:!0,evolve:!0,exact:!0,example:!0,excess:!0,exchange:!0,excite:!0,exclude:!0,excuse:!0,execute:!0,exercise:!0,exhaust:!0,exhibit:!0,exile:!0,exist:!0,exit:!0,exotic:!0,expand:!0,expect:!0,expire:!0,explain:!0,expose:!0,express:!0,extend:!0,extra:!0,eye:!0,eyebrow:!0,fabric:!0,face:!0,faculty:!0,fade:!0,faint:!0,faith:!0,fall:!0,false:!0,fame:!0,family:!0,famous:!0,fan:!0,fancy:!0,fantasy:!0,farm:!0,fashion:!0,fat:!0,fatal:!0,father:!0,fatigue:!0,fault:!0,favorite:!0,feature:!0,february:!0,federal:!0,fee:!0,feed:!0,feel:!0,female:!0,fence:!0,festival:!0,fetch:!0,fever:!0,few:!0,fiber:!0,fiction:!0,field:!0,figure:!0,file:!0,film:!0,filter:!0,final:!0,find:!0,fine:!0,finger:!0,finish:!0,fire:!0,firm:!0,first:!0,fiscal:!0,fish:!0,fit:!0,fitness:!0,fix:!0,flag:!0,flame:!0,flash:!0,flat:!0,flavor:!0,flee:!0,flight:!0,flip:!0,float:!0,flock:!0,floor:!0,flower:!0,fluid:!0,flush:!0,fly:!0,foam:!0,focus:!0,fog:!0,foil:!0,fold:!0,follow:!0,food:!0,foot:!0,force:!0,forest:!0,forget:!0,fork:!0,fortune:!0,forum:!0,forward:!0,fossil:!0,foster:!0,found:!0,fox:!0,fragile:!0,frame:!0,frequent:!0,fresh:!0,friend:!0,fringe:!0,frog:!0,front:!0,frost:!0,frown:!0,frozen:!0,fruit:!0,fuel:!0,fun:!0,funny:!0,furnace:!0,fury:!0,future:!0,gadget:!0,gain:!0,galaxy:!0,gallery:!0,game:!0,gap:!0,garage:!0,garbage:!0,garden:!0,garlic:!0,garment:!0,gas:!0,gasp:!0,gate:!0,gather:!0,gauge:!0,gaze:!0,general:!0,genius:!0,genre:!0,gentle:!0,genuine:!0,gesture:!0,ghost:!0,giant:!0,gift:!0,giggle:!0,ginger:!0,giraffe:!0,girl:!0,give:!0,glad:!0,glance:!0,glare:!0,glass:!0,glide:!0,glimpse:!0,globe:!0,gloom:!0,glory:!0,glove:!0,glow:!0,glue:!0,goat:!0,goddess:!0,gold:!0,good:!0,goose:!0,gorilla:!0,gospel:!0,gossip:!0,govern:!0,gown:!0,grab:!0,grace:!0,grain:!0,grant:!0,grape:!0,grass:!0,gravity:!0,great:!0,green:!0,grid:!0,grief:!0,grit:!0,grocery:!0,group:!0,grow:!0,grunt:!0,guard:!0,guess:!0,guide:!0,guilt:!0,guitar:!0,gun:!0,gym:!0,habit:!0,hair:!0,half:!0,hammer:!0,hamster:!0,hand:!0,happy:!0,harbor:!0,hard:!0,harsh:!0,harvest:!0,hat:!0,have:!0,hawk:!0,hazard:!0,head:!0,health:!0,heart:!0,heavy:!0,hedgehog:!0,height:!0,hello:!0,helmet:!0,help:!0,hen:!0,hero:!0,hidden:!0,high:!0,hill:!0,hint:!0,hip:!0,hire:!0,history:!0,hobby:!0,hockey:!0,hold:!0,hole:!0,holiday:!0,hollow:!0,home:!0,honey:!0,hood:!0,hope:!0,horn:!0,horror:!0,horse:!0,hospital:!0,host:!0,hotel:!0,hour:!0,hover:!0,hub:!0,huge:!0,human:!0,humble:!0,humor:!0,hundred:!0,hungry:!0,hunt:!0,hurdle:!0,hurry:!0,hurt:!0,husband:!0,hybrid:!0,ice:!0,icon:!0,idea:!0,identify:!0,idle:!0,ignore:!0,ill:!0,illegal:!0,illness:!0,image:!0,imitate:!0,immense:!0,immune:!0,impact:!0,impose:!0,improve:!0,impulse:!0,inch:!0,include:!0,income:!0,increase:!0,index:!0,indicate:!0,indoor:!0,industry:!0,infant:!0,inflict:!0,inform:!0,inhale:!0,inherit:!0,initial:!0,inject:!0,injury:!0,inmate:!0,inner:!0,innocent:!0,input:!0,inquiry:!0,insane:!0,insect:!0,inside:!0,inspire:!0,install:!0,intact:!0,interest:!0,into:!0,invest:!0,invite:!0,involve:!0,iron:!0,island:!0,isolate:!0,issue:!0,item:!0,ivory:!0,jacket:!0,jaguar:!0,jar:!0,jazz:!0,jealous:!0,jeans:!0,jelly:!0,jewel:!0,job:!0,join:!0,joke:!0,journey:!0,joy:!0,judge:!0,juice:!0,jump:!0,jungle:!0,junior:!0,junk:!0,just:!0,kangaroo:!0,keen:!0,keep:!0,ketchup:!0,key:!0,kick:!0,kid:!0,kidney:!0,kind:!0,kingdom:!0,kiss:!0,kit:!0,kitchen:!0,kite:!0,kitten:!0,kiwi:!0,knee:!0,knife:!0,knock:!0,know:!0,lab:!0,label:!0,labor:!0,ladder:!0,lady:!0,lake:!0,lamp:!0,language:!0,laptop:!0,large:!0,later:!0,latin:!0,laugh:!0,laundry:!0,lava:!0,law:!0,lawn:!0,lawsuit:!0,layer:!0,lazy:!0,leader:!0,leaf:!0,learn:!0,leave:!0,lecture:!0,left:!0,leg:!0,legal:!0,legend:!0,leisure:!0,lemon:!0,lend:!0,length:!0,lens:!0,leopard:!0,lesson:!0,letter:!0,level:!0,liar:!0,liberty:!0,library:!0,license:!0,life:!0,lift:!0,light:!0,like:!0,limb:!0,limit:!0,link:!0,lion:!0,liquid:!0,list:!0,little:!0,live:!0,lizard:!0,load:!0,loan:!0,lobster:!0,local:!0,lock:!0,logic:!0,lonely:!0,long:!0,loop:!0,lottery:!0,loud:!0,lounge:!0,love:!0,loyal:!0,lucky:!0,luggage:!0,lumber:!0,lunar:!0,lunch:!0,luxury:!0,lyrics:!0,machine:!0,mad:!0,magic:!0,magnet:!0,maid:!0,mail:!0,main:!0,major:!0,make:!0,mammal:!0,man:!0,manage:!0,mandate:!0,mango:!0,mansion:!0,manual:!0,maple:!0,marble:!0,march:!0,margin:!0,marine:!0,market:!0,marriage:!0,mask:!0,mass:!0,master:!0,match:!0,material:!0,math:!0,matrix:!0,matter:!0,maximum:!0,maze:!0,meadow:!0,mean:!0,measure:!0,meat:!0,mechanic:!0,medal:!0,media:!0,melody:!0,melt:!0,member:!0,memory:!0,mention:!0,menu:!0,mercy:!0,merge:!0,merit:!0,merry:!0,mesh:!0,message:!0,metal:!0,method:!0,middle:!0,midnight:!0,milk:!0,million:!0,mimic:!0,mind:!0,minimum:!0,minor:!0,minute:!0,miracle:!0,mirror:!0,misery:!0,miss:!0,mistake:!0,mix:!0,mixed:!0,mixture:!0,mobile:!0,model:!0,modify:!0,mom:!0,moment:!0,monitor:!0,monkey:!0,monster:!0,month:!0,moon:!0,moral:!0,more:!0,morning:!0,mosquito:!0,mother:!0,motion:!0,motor:!0,mountain:!0,mouse:!0,move:!0,movie:!0,much:!0,muffin:!0,mule:!0,multiply:!0,muscle:!0,museum:!0,mushroom:!0,music:!0,must:!0,mutual:!0,myself:!0,mystery:!0,myth:!0,naive:!0,name:!0,napkin:!0,narrow:!0,nasty:!0,nation:!0,nature:!0,near:!0,neck:!0,need:!0,negative:!0,neglect:!0,neither:!0,nephew:!0,nerve:!0,nest:!0,net:!0,network:!0,neutral:!0,never:!0,news:!0,next:!0,nice:!0,night:!0,noble:!0,noise:!0,nominee:!0,noodle:!0,normal:!0,north:!0,nose:!0,notable:!0,note:!0,nothing:!0,notice:!0,novel:!0,now:!0,nuclear:!0,number:!0,nurse:!0,nut:!0,oak:!0,obey:!0,object:!0,oblige:!0,obscure:!0,observe:!0,obtain:!0,obvious:!0,occur:!0,ocean:!0,october:!0,odor:!0,off:!0,offer:!0,office:!0,often:!0,oil:!0,okay:!0,old:!0,olive:!0,olympic:!0,omit:!0,once:!0,one:!0,onion:!0,online:!0,only:!0,open:!0,opera:!0,opinion:!0,oppose:!0,option:!0,orange:!0,orbit:!0,orchard:!0,order:!0,ordinary:!0,organ:!0,orient:!0,original:!0,orphan:!0,ostrich:!0,other:!0,outdoor:!0,outer:!0,output:!0,outside:!0,oval:!0,oven:!0,over:!0,own:!0,owner:!0,oxygen:!0,oyster:!0,ozone:!0,pact:!0,paddle:!0,page:!0,pair:!0,palace:!0,palm:!0,panda:!0,panel:!0,panic:!0,panther:!0,paper:!0,parade:!0,parent:!0,park:!0,parrot:!0,party:!0,pass:!0,patch:!0,path:!0,patient:!0,patrol:!0,pattern:!0,pause:!0,pave:!0,payment:!0,peace:!0,peanut:!0,pear:!0,peasant:!0,pelican:!0,pen:!0,penalty:!0,pencil:!0,people:!0,pepper:!0,perfect:!0,permit:!0,person:!0,pet:!0,phone:!0,photo:!0,phrase:!0,physical:!0,piano:!0,picnic:!0,picture:!0,piece:!0,pig:!0,pigeon:!0,pill:!0,pilot:!0,pink:!0,pioneer:!0,pipe:!0,pistol:!0,pitch:!0,pizza:!0,place:!0,planet:!0,plastic:!0,plate:!0,play:!0,please:!0,pledge:!0,pluck:!0,plug:!0,plunge:!0,poem:!0,poet:!0,point:!0,polar:!0,pole:!0,police:!0,pond:!0,pony:!0,pool:!0,popular:!0,portion:!0,position:!0,possible:!0,post:!0,potato:!0,pottery:!0,poverty:!0,powder:!0,power:!0,practice:!0,praise:!0,predict:!0,prefer:!0,prepare:!0,present:!0,pretty:!0,prevent:!0,price:!0,pride:!0,primary:!0,print:!0,priority:!0,prison:!0,private:!0,prize:!0,problem:!0,process:!0,produce:!0,profit:!0,program:!0,project:!0,promote:!0,proof:!0,property:!0,prosper:!0,protect:!0,proud:!0,provide:!0,public:!0,pudding:!0,pull:!0,pulp:!0,pulse:!0,pumpkin:!0,punch:!0,pupil:!0,puppy:!0,purchase:!0,purity:!0,purpose:!0,purse:!0,push:!0,put:!0,puzzle:!0,pyramid:!0,quality:!0,quantum:!0,quarter:!0,question:!0,quick:!0,quit:!0,quiz:!0,quote:!0,rabbit:!0,raccoon:!0,race:!0,rack:!0,radar:!0,radio:!0,rail:!0,rain:!0,raise:!0,rally:!0,ramp:!0,ranch:!0,random:!0,range:!0,rapid:!0,rare:!0,rate:!0,rather:!0,raven:!0,raw:!0,razor:!0,ready:!0,real:!0,reason:!0,rebel:!0,rebuild:!0,recall:!0,receive:!0,recipe:!0,record:!0,recycle:!0,reduce:!0,reflect:!0,reform:!0,refuse:!0,region:!0,regret:!0,regular:!0,reject:!0,relax:!0,release:!0,relief:!0,rely:!0,remain:!0,remember:!0,remind:!0,remove:!0,render:!0,renew:!0,rent:!0,reopen:!0,repair:!0,repeat:!0,replace:!0,report:!0,require:!0,rescue:!0,resemble:!0,resist:!0,resource:!0,response:!0,result:!0,retire:!0,retreat:!0,return:!0,reunion:!0,reveal:!0,review:!0,reward:!0,rhythm:!0,rib:!0,ribbon:!0,rice:!0,rich:!0,ride:!0,ridge:!0,rifle:!0,right:!0,rigid:!0,ring:!0,riot:!0,ripple:!0,risk:!0,ritual:!0,rival:!0,river:!0,road:!0,roast:!0,robot:!0,robust:!0,rocket:!0,romance:!0,roof:!0,rookie:!0,room:!0,rose:!0,rotate:!0,rough:!0,round:!0,route:!0,royal:!0,rubber:!0,rude:!0,rug:!0,rule:!0,run:!0,runway:!0,rural:!0,sad:!0,saddle:!0,sadness:!0,safe:!0,sail:!0,salad:!0,salmon:!0,salon:!0,salt:!0,salute:!0,same:!0,sample:!0,sand:!0,satisfy:!0,satoshi:!0,sauce:!0,sausage:!0,save:!0,say:!0,scale:!0,scan:!0,scare:!0,scatter:!0,scene:!0,scheme:!0,school:!0,science:!0,scissors:!0,scorpion:!0,scout:!0,scrap:!0,screen:!0,script:!0,scrub:!0,sea:!0,search:!0,season:!0,seat:!0,second:!0,secret:!0,section:!0,security:!0,seed:!0,seek:!0,segment:!0,select:!0,sell:!0,seminar:!0,senior:!0,sense:!0,sentence:!0,series:!0,service:!0,session:!0,settle:!0,setup:!0,seven:!0,shadow:!0,shaft:!0,shallow:!0,share:!0,shed:!0,shell:!0,sheriff:!0,shield:!0,shift:!0,shine:!0,ship:!0,shiver:!0,shock:!0,shoe:!0,shoot:!0,shop:!0,short:!0,shoulder:!0,shove:!0,shrimp:!0,shrug:!0,shuffle:!0,shy:!0,sibling:!0,sick:!0,side:!0,siege:!0,sight:!0,sign:!0,silent:!0,silk:!0,silly:!0,silver:!0,similar:!0,simple:!0,since:!0,sing:!0,siren:!0,sister:!0,situate:!0,six:!0,size:!0,skate:!0,sketch:!0,ski:!0,skill:!0,skin:!0,skirt:!0,skull:!0,slab:!0,slam:!0,sleep:!0,slender:!0,slice:!0,slide:!0,slight:!0,slim:!0,slogan:!0,slot:!0,slow:!0,slush:!0,small:!0,smart:!0,smile:!0,smoke:!0,smooth:!0,snack:!0,snake:!0,snap:!0,sniff:!0,snow:!0,soap:!0,soccer:!0,social:!0,sock:!0,soda:!0,soft:!0,solar:!0,soldier:!0,solid:!0,solution:!0,solve:!0,someone:!0,song:!0,soon:!0,sorry:!0,sort:!0,soul:!0,sound:!0,soup:!0,source:!0,south:!0,space:!0,spare:!0,spatial:!0,spawn:!0,speak:!0,special:!0,speed:!0,spell:!0,spend:!0,sphere:!0,spice:!0,spider:!0,spike:!0,spin:!0,spirit:!0,split:!0,spoil:!0,sponsor:!0,spoon:!0,sport:!0,spot:!0,spray:!0,spread:!0,spring:!0,spy:!0,square:!0,squeeze:!0,squirrel:!0,stable:!0,stadium:!0,staff:!0,stage:!0,stairs:!0,stamp:!0,stand:!0,start:!0,state:!0,stay:!0,steak:!0,steel:!0,stem:!0,step:!0,stereo:!0,stick:!0,still:!0,sting:!0,stock:!0,stomach:!0,stone:!0,stool:!0,story:!0,stove:!0,strategy:!0,street:!0,strike:!0,strong:!0,struggle:!0,student:!0,stuff:!0,stumble:!0,style:!0,subject:!0,submit:!0,subway:!0,success:!0,such:!0,sudden:!0,suffer:!0,sugar:!0,suggest:!0,suit:!0,summer:!0,sun:!0,sunny:!0,sunset:!0,super:!0,supply:!0,supreme:!0,sure:!0,surface:!0,surge:!0,surprise:!0,surround:!0,survey:!0,suspect:!0,sustain:!0,swallow:!0,swamp:!0,swap:!0,swarm:!0,swear:!0,sweet:!0,swift:!0,swim:!0,swing:!0,switch:!0,sword:!0,symbol:!0,symptom:!0,syrup:!0,system:!0,table:!0,tackle:!0,tag:!0,tail:!0,talent:!0,talk:!0,tank:!0,tape:!0,target:!0,task:!0,taste:!0,tattoo:!0,taxi:!0,teach:!0,team:!0,tell:!0,ten:!0,tenant:!0,tennis:!0,tent:!0,term:!0,test:!0,text:!0,thank:!0,that:!0,theme:!0,then:!0,theory:!0,there:!0,they:!0,thing:!0,this:!0,thought:!0,three:!0,thrive:!0,throw:!0,thumb:!0,thunder:!0,ticket:!0,tide:!0,tiger:!0,tilt:!0,timber:!0,time:!0,tiny:!0,tip:!0,tired:!0,tissue:!0,title:!0,toast:!0,tobacco:!0,today:!0,toddler:!0,toe:!0,together:!0,toilet:!0,token:!0,tomato:!0,tomorrow:!0,tone:!0,tongue:!0,tonight:!0,tool:!0,tooth:!0,top:!0,topic:!0,topple:!0,torch:!0,tornado:!0,tortoise:!0,toss:!0,total:!0,tourist:!0,toward:!0,tower:!0,town:!0,toy:!0,track:!0,trade:!0,traffic:!0,tragic:!0,train:!0,transfer:!0,trap:!0,trash:!0,travel:!0,tray:!0,treat:!0,tree:!0,trend:!0,trial:!0,tribe:!0,trick:!0,trigger:!0,trim:!0,trip:!0,trophy:!0,trouble:!0,truck:!0,true:!0,truly:!0,trumpet:!0,trust:!0,truth:!0,try:!0,tube:!0,tuition:!0,tumble:!0,tuna:!0,tunnel:!0,turkey:!0,turn:!0,turtle:!0,twelve:!0,twenty:!0,twice:!0,twin:!0,twist:!0,two:!0,type:!0,typical:!0,ugly:!0,umbrella:!0,unable:!0,unaware:!0,uncle:!0,uncover:!0,under:!0,undo:!0,unfair:!0,unfold:!0,unhappy:!0,uniform:!0,unique:!0,unit:!0,universe:!0,unknown:!0,unlock:!0,until:!0,unusual:!0,unveil:!0,update:!0,upgrade:!0,uphold:!0,upon:!0,upper:!0,upset:!0,urban:!0,urge:!0,usage:!0,use:!0,used:!0,useful:!0,useless:!0,usual:!0,utility:!0,vacant:!0,vacuum:!0,vague:!0,valid:!0,valley:!0,valve:!0,van:!0,vanish:!0,vapor:!0,various:!0,vast:!0,vault:!0,vehicle:!0,velvet:!0,vendor:!0,venture:!0,venue:!0,verb:!0,verify:!0,version:!0,very:!0,vessel:!0,veteran:!0,viable:!0,vibrant:!0,vicious:!0,victory:!0,video:!0,view:!0,village:!0,vintage:!0,violin:!0,virtual:!0,virus:!0,visa:!0,visit:!0,visual:!0,vital:!0,vivid:!0,vocal:!0,voice:!0,void:!0,volcano:!0,volume:!0,vote:!0,voyage:!0,wage:!0,wagon:!0,wait:!0,walk:!0,wall:!0,walnut:!0,want:!0,warfare:!0,warm:!0,warrior:!0,wash:!0,wasp:!0,waste:!0,water:!0,wave:!0,way:!0,wealth:!0,weapon:!0,wear:!0,weasel:!0,weather:!0,web:!0,wedding:!0,weekend:!0,weird:!0,welcome:!0,west:!0,wet:!0,whale:!0,what:!0,wheat:!0,wheel:!0,when:!0,where:!0,whip:!0,whisper:!0,wide:!0,width:!0,wife:!0,wild:!0,will:!0,win:!0,window:!0,wine:!0,wing:!0,wink:!0,winner:!0,winter:!0,wire:!0,wisdom:!0,wise:!0,wish:!0,witness:!0,wolf:!0,woman:!0,wonder:!0,wood:!0,wool:!0,word:!0,work:!0,world:!0,worry:!0,worth:!0,wrap:!0,wreck:!0,wrestle:!0,wrist:!0,write:!0,wrong:!0,yard:!0,year:!0,yellow:!0,you:!0,young:!0,youth:!0,zebra:!0,zero:!0,zone:!0,zoo:!0}},30580:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebounceActionTimer=void 0;const r=i(80075);t.DebounceActionTimer=class{constructor(e,t){this.debounceMs=e,this.handler=t,this.requests=[],this.startTime=0,this.tick=()=>{let e=this.debounceMs<=0;if(this.debounceMs>0&&Date.now()-this.startTime>=this.debounceMs&&(e=!0),e){const e=this.requests.slice(),t=this.handler(e);"object"==typeof t&&"then"in t?Promise.resolve(t).then((t=>{this.handleResponses(e,t)})):this.handleResponses(e,t),this.requests=[]}else this.nextTick(this.tick)},this.handleResponses=(e,t)=>{(0,r.runInAction)((()=>{for(let i=0;i<e.length;i++){const r=e[i],n=t[i];r.action(n)}}));for(const t of e)t.resolver()}}call(e,t){return new Promise((i=>{const r=0===this.requests.length;this.requests.push({args:e,action:t,resolver:i}),r&&this.startTimer()}))}startTimer(){this.startTime=Date.now(),this.nextTick(this.tick)}nextTick(e){this.debounceMs<=0?Promise.resolve().then(e):"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,this.debounceMs)}}},98565:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toGenerator=void 0,t.toGenerator=function*(e){return yield e}},96793:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(98565),t),n(i(30580),t)},97392:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.retryInfinite=t.retry=void 0;const n=i(60194);function s(e,t){return r(this,void 0,void 0,(function*(){let i=0;for(;;)try{const t=e();return yield t}catch(e){if(i>=t.maxRetries)throw e;t.onFailed&&t.onFailed(e);let r=t.waitMsAfterError||0;r>0&&(null!=t.maxWaitMsAfterError&&t.maxWaitMsAfterError>0&&(r=Math.pow(2,i)*r,r=Math.min(r,t.maxWaitMsAfterError)),yield(0,n.sleep)(r)),i++}}))}t.retry=s,t.retryInfinite=function(e,t){return s(e,Object.assign(Object.assign({},t),{maxRetries:Number.MAX_SAFE_INTEGER}))}},60194:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=void 0,t.sleep=function(e){return new Promise((t=>setTimeout(t,e)))}},20939:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Debouncer=void 0,t.Debouncer=class{static promise(e){let t;return(...r)=>i(this,void 0,void 0,(function*(){if(t)return t;try{return t=e.apply(this,r),yield t}finally{t=void 0}}))}}},88408:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(20939),t)},90812:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseAccount=void 0;const n=i(16261),s=i(96618);class o{static fetchFromRest(e,t,i=!1){return r(this,void 0,void 0,(function*(){const r=yield(0,s.simpleFetch)(e,`/cosmos/auth/v1beta1/accounts/${t}`,{validateStatus:function(e){return e>=200&&e<300||404===e}});return o.fromProtoJSON(r.data,i?t:"")}))}static fromProtoJSON(e,t=""){if(!e.account){if(!t)throw new Error(`Account's address is unknown: ${JSON.stringify(e)}`);return new o("",t,new n.Int(0),new n.Int(0))}let i=e.account;const r=i["@type"]||"",s=i.BaseAccount||i.baseAccount||i.base_account;s&&(i=s);const a=i.account;a&&(i=a);let c=i.BaseVestingAccount||i.baseVestingAccount||i.base_vesting_account;for(;c;){i=c;const e=i.BaseAccount||i.baseAccount||i.base_account;e&&(i=e),c=i.BaseVestingAccount||i.baseVestingAccount||i.base_vesting_account}let u=i.address;if(!u){if(!t)throw new Error(`Account's address is unknown: ${JSON.stringify(e)}`);u=t}const d=i.account_number,l=i.sequence;return new o(r,u,new n.Int(d||"0"),new n.Int(l||"0"))}constructor(e,t,i,r){this.type=e,this.address=t,this.accountNumber=i,this.sequence=r}getType(){return this.type}getAddress(){return this.address}getAccountNumber(){return this.accountNumber}getSequence(){return this.sequence}}t.BaseAccount=o},82050:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyADR36Amino=t.verifyADR36AminoSignDoc=t.makeADR36AminoSignDoc=t.checkAndValidateADR36AminoSignDoc=void 0;const r=i(72565),n=i(44688),s=i(48834),o=i(81204);function a(e,t){if(!(e&&e.msgs&&Array.isArray(e.msgs)&&1===e.msgs.length&&"sign/MsgSignData"===e.msgs[0].type))return!1;if(""!==e.chain_id)throw new Error("Chain id should be empty string for ADR-36 signing");if(""!==e.memo)throw new Error("Memo should be empty string for ADR-36 signing");if("0"!==e.account_number)throw new Error('Account number should be "0" for ADR-36 signing');if("0"!==e.sequence)throw new Error('Sequence should be "0" for ADR-36 signing');if("0"!==e.fee.gas)throw new Error('Gas should be "0" for ADR-36 signing');if(0!==e.fee.amount.length)throw new Error("Fee amount should be empty array for ADR-36 signing");const i=e.msgs[0];if("sign/MsgSignData"!==i.type)throw new Error(`Invalid type of ADR-36 sign msg: ${i.type}`);if(!i.value)throw new Error("Empty value in the msg");const r=i.value.signer;if(!r)throw new Error("Empty signer in the ADR-36 msg");n.Bech32Address.validate(r,t);const o=i.value.data;if(!o)throw new Error("Empty data in the ADR-36 msg");const a=s.Buffer.from(o,"base64");if(a.toString("base64")!==o)throw new Error("Data is not encoded by base64");if(0===a.length)throw new Error("Empty data in the ADR-36 msg");return!0}function c(e,t){return{chain_id:"",account_number:"0",sequence:"0",fee:{gas:"0",amount:[]},msgs:[{type:"sign/MsgSignData",value:{signer:e,data:t=s.Buffer.from(t).toString("base64")}}],memo:""}}function u(e,t,i,s,c="secp256k1"){if(!a(t,e))throw new Error("Invalid sign doc for ADR-36");const u=new o.PubKeySecp256k1(i);if(("ethsecp256k1"===c?new n.Bech32Address(u.getEthAddress()).toBech32(e):new n.Bech32Address(u.getCosmosAddress()).toBech32(e))!==t.msgs[0].value.signer)throw new Error("Unmatched signer");const d=(0,r.serializeSignDoc)(t);return u.verifyDigest32("ethsecp256k1"===c?o.Hash.keccak256(d):o.Hash.sha256(d),s)}t.checkAndValidateADR36AminoSignDoc=a,t.makeADR36AminoSignDoc=c,t.verifyADR36AminoSignDoc=u,t.verifyADR36Amino=function(e,t,i,r,n,s="secp256k1"){return u(e,c(t,i),r,n,s)}},46855:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(82050),t)},44688:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Bech32Address=void 0;const o=s(i(21273)),a=i(48834),c=i(99687);class u{static shortenAddress(e,t){if(t>=e.length)return e;const i=e.indexOf("1"),r=e.slice(0,i),n=e.slice(i+1);if(t-=r.length,t-=3,(t-=1)<=0)return"";const s=Math.floor(n.length/2);let o=n.slice(0,s),a=n.slice(s);for(;t<o.length+a.length;)(o.length+a.length)%2==1&&o.length>0?o=o.slice(0,o.length-1):a=a.slice(1);return r+"1"+o+"..."+a}static fromBech32(e,t,i){const r=o.default.decode(e,i);if(t&&r.prefix!==t)throw new Error("Unmatched prefix");return new u(new Uint8Array((0,o.fromWords)(r.words)))}static validate(e,t,i){const{prefix:r}=o.default.decode(e,i);if(t&&t!==r)throw new Error(`Unexpected prefix (expected: ${t}, actual: ${r})`)}static defaultBech32Config(e,t="val",i="cons",r="pub",n="oper"){return{bech32PrefixAccAddr:e,bech32PrefixAccPub:e+r,bech32PrefixValAddr:e+t+n,bech32PrefixValPub:e+t+n+r,bech32PrefixConsAddr:e+t+i,bech32PrefixConsPub:e+t+i+r}}constructor(e){this.address=e}toBech32(e,t){const i=o.default.toWords(this.address);return o.default.encode(e,i,t)}toHex(e=!0){const t=a.Buffer.from(this.address).toString("hex");if(0===t.length)throw new Error("Empty address");return e?(0,c.getAddress)("0x"+t):"0x"+t}}t.Bech32Address=u},17335:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChainIdHelper=void 0;class i{static parse(e){if("injective-777"===e||"injective-888"===e)return{identifier:e,version:0};const t=e.split(i.VersionFormatRegExp).filter(Boolean);return 2!==t.length?{identifier:e,version:0}:{identifier:t[0],version:parseInt(t[1])}}static hasChainVersion(e){return i.parse(e).identifier!==e}}t.ChainIdHelper=i,i.VersionFormatRegExp=/(.+)-([\d]+)/},47203:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EthermintChainIdHelper=void 0;const r=i(17335);t.EthermintChainIdHelper=class{static parse(e){const t=r.ChainIdHelper.parse(e);if(e.startsWith("injective"))return["injective-777","injective-888"].includes(e)?Object.assign({ethChainId:5},t):Object.assign({ethChainId:1},t);const i=e.match("^([a-z]{1,})_{1}([1-9][0-9]*)-{1}([1-9][0-9]*)$");if(!i||4!==i.length||""===i[1]||Number.isNaN(parseFloat(i[2]))||!Number.isInteger(parseFloat(i[2])))throw new Error(`Invalid chainId for ethermint: ${e}`);return Object.assign(Object.assign({},t),{ethChainId:parseFloat(i[2])})}}},61622:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(17335),t),n(i(47203),t)},75263:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(90812),t),n(i(44688),t),n(i(61622),t),n(i(62683),t),n(i(12408),t),n(i(46855),t),n(i(72565),t)},8614:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeSignDoc=t.encodeSecp256k1Signature=t.encodeSecp256k1Pubkey=void 0;const r=i(48834),n=i(45137);function s(e){if(33!==e.length||2!==e[0]&&3!==e[0])throw new Error("Public key must be compressed secp256k1, i.e. 33 bytes starting with 0x02 or 0x03");return{type:"tendermint/PubKeySecp256k1",value:r.Buffer.from(e).toString("base64")}}t.encodeSecp256k1Pubkey=s,t.encodeSecp256k1Signature=function(e,t){if(64!==t.length)throw new Error("Signature must be 64 bytes long. Cosmos SDK uses a 2x32 byte fixed length encoding for the secp256k1 signature integers r and s.");return{pub_key:s(e),signature:r.Buffer.from(t).toString("base64")}},t.serializeSignDoc=function(e){return r.Buffer.from((0,n.escapeHTML)((0,n.sortedJsonByKeyStringify)(e)))}},72565:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(8614),t)},17467:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProtoCodec=t.ProtoCodec=void 0;const s=i(37956),o=i(30194),a=i(46312),c=i(95827),u=i(3954),d=i(93245),l=i(69769),h=i(84566),g=i(60924),f=i(48533),p=i(89891),y=i(71649),v=i(75092),m=i(51115),w=i(48834);n(i(48533),t);class b{constructor(){this.typeUrlMap=new Map}unpackAnyFactory(e){if(this.typeUrlMap.has(e))return this.typeUrlMap.get(e)}unpackAny(e){const t=this.unpackAnyFactory(e.typeUrl);if(!t)return new f.UnknownMessage(e.typeUrl,e.value);const i=t.decode(e.value);return Object.assign(Object.assign({},e),{unpacked:i})}unpackedAnyToJSONRecursive(e){if(e instanceof f.UnknownMessage)return e.toJSON();const t=this.unpackAnyFactory(e.typeUrl);if(t&&"unpacked"in e&&e.unpacked){const i=e=>{const t="object"==typeof e&&!(e instanceof f.UnknownMessage)&&"typeUrl"in e&&e.typeUrl&&"string"==typeof e.typeUrl&&"value"in e&&e.value&&"string"==typeof e.value;if(t)try{w.Buffer.from(e.value,"base64")}catch(e){return!1}return t},r=e=>{const t=this.unpackAnyFactory(e.typeUrl),i=w.Buffer.from(e.value,"base64");if(!t)return new f.UnknownMessage(e.typeUrl,i).toJSON();const r=t.decode(i);return{typeUrl:e.typeUrl,value:t.toJSON(r)}},n=e=>{if(Array.isArray(e))for(let t=0;t<e.length;t++){const s=e[t];i(s)?e[t]=r(s):"object"==typeof s&&(e[t]=n(s))}else for(const t in e){const s=e[t];i(s)?e[t]=r(s):"object"==typeof s&&(e[t]=n(s))}return e};let s=t.toJSON(e.unpacked);if(s&&"object"==typeof s)return s=n(s),{typeUrl:e.typeUrl,value:s}}return new f.UnknownMessage(e.typeUrl,e.value).toJSON()}registerAny(e,t){this.typeUrlMap.set(e,t)}}t.ProtoCodec=b,t.defaultProtoCodec=new b,t.defaultProtoCodec.registerAny("/agoric.swingset.MsgWalletSpendAction",s.MsgWalletSpendAction),t.defaultProtoCodec.registerAny("/agoric.swingset.MsgProvision",s.MsgProvision),t.defaultProtoCodec.registerAny("/cosmos.bank.v1beta1.MsgSend",o.MsgSend),t.defaultProtoCodec.registerAny("/cosmos.bank.v1beta1.MsgMultiSend",o.MsgMultiSend),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgDelegate",a.MsgDelegate),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgUndelegate",a.MsgUndelegate),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgBeginRedelegate",a.MsgBeginRedelegate),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgUnbondValidator",a.MsgUnbondValidator),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgCancelUnbondingDelegation",a.MsgCancelUnbondingDelegation),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgTokenizeShares",a.MsgTokenizeShares),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgRedeemTokensForShares",a.MsgRedeemTokensForShares),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgTransferTokenizeShareRecord",a.MsgTransferTokenizeShareRecord),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgDisableTokenizeShares",a.MsgDisableTokenizeShares),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgEnableTokenizeShares",a.MsgEnableTokenizeShares),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgValidatorBond",a.MsgValidatorBond),t.defaultProtoCodec.registerAny("/cosmwasm.wasm.v1.MsgExecuteContract",l.MsgExecuteContract),t.defaultProtoCodec.registerAny("/cosmwasm.wasm.v1.MsgInstantiateContract",l.MsgInstantiateContract),t.defaultProtoCodec.registerAny("/cosmos.distribution.v1beta1.MsgWithdrawDelegatorReward",d.MsgWithdrawDelegatorReward),t.defaultProtoCodec.registerAny("/cosmos.distribution.v1beta1.MsgSetWithdrawAddress",d.MsgSetWithdrawAddress),t.defaultProtoCodec.registerAny("/ibc.applications.transfer.v1.MsgTransfer",h.MsgTransfer),t.defaultProtoCodec.registerAny("/ibc.applications.fee.v1.MsgPayPacketFee",g.MsgPayPacketFee),t.defaultProtoCodec.registerAny("/ibc.applications.fee.v1.MsgPayPacketFeeAsync",g.MsgPayPacketFeeAsync),t.defaultProtoCodec.registerAny("/ibc.applications.fee.v1.MsgRegisterPayee",g.MsgRegisterPayee),t.defaultProtoCodec.registerAny("/ibc.applications.fee.v1.MsgRegisterCounterpartyPayee",g.MsgRegisterCounterpartyPayee),t.defaultProtoCodec.registerAny("/cosmos.gov.v1beta1.MsgVote",u.MsgVote),t.defaultProtoCodec.registerAny("/cosmos.authz.v1beta1.MsgGrant",c.MsgGrant),t.defaultProtoCodec.registerAny("/cosmos.authz.v1beta1.GenericAuthorization",p.GenericAuthorization),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.StakeAuthorization",y.StakeAuthorization),t.defaultProtoCodec.registerAny("/cosmos.bank.v1beta1.SendAuthorization",v.SendAuthorization),t.defaultProtoCodec.registerAny("/cosmos.authz.v1beta1.MsgRevoke",c.MsgRevoke),t.defaultProtoCodec.registerAny("/cosmos.authz.v1beta1.MsgExec",c.MsgExec),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgLiquidStake",m.MsgLiquidStake),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgLSMLiquidStake",m.MsgLSMLiquidStake),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgRedeemStake",m.MsgRedeemStake),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgRegisterHostZone",m.MsgRegisterHostZone),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgClaimUndelegatedTokens",m.MsgClaimUndelegatedTokens),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgRebalanceValidators",m.MsgRebalanceValidators),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgAddValidators",m.MsgAddValidators),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgChangeValidatorWeight",m.MsgChangeValidatorWeight),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgDeleteValidator",m.MsgDeleteValidator),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgRestoreInterchainAccount",m.MsgRestoreInterchainAccount),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgUpdateValidatorSharesExchRate",m.MsgUpdateValidatorSharesExchRate),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgCalibrateDelegation",m.MsgCalibrateDelegation),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgClearBalance",m.MsgClearBalance),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgUndelegateHost",m.MsgUndelegateHost),t.defaultProtoCodec.registerAny("/stride.stakeibc.MsgUpdateInnerRedemptionRateBounds",m.MsgUpdateInnerRedemptionRateBounds)},48533:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownMessage=void 0;const r=i(48834);t.UnknownMessage=class{constructor(e,t){this._typeUrl=e,this._value=t}get typeUrl(){return this._typeUrl}get value(){return this._value}toJSON(){return{typeUrl:this._typeUrl,value:r.Buffer.from(this._value).toString("base64")}}}},78738:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtoSignDocDecoder=void 0;const r=i(12136),n=i(17467),s=i(87514),o=i(45137);class a{static decode(e){return new a(r.SignDoc.decode(e))}constructor(e,t=n.defaultProtoCodec){this.signDoc=e,this.protoCodec=t}get txBody(){return this._txBody||(this._txBody=r.TxBody.decode(this.signDoc.bodyBytes)),this._txBody}get txMsgs(){const e=[];for(const t of this.txBody.messages)e.push(this.protoCodec.unpackAny(t));return e}get authInfo(){if(!this._authInfo)if("authInfoBytes"in this.signDoc)this._authInfo=r.AuthInfo.decode(this.signDoc.authInfoBytes);else{const e=this.signDoc;this._authInfo=r.AuthInfo.fromPartial({signerInfos:[{publicKey:e.publicKey,modeInfo:{single:{mode:s.SignMode.SIGN_MODE_DIRECT}},sequence:e.sequence}],fee:{amount:[],gasLimit:"1",payer:"",granter:""}})}return this._authInfo}get chainId(){return this.signDoc.chainId}get accountNumber(){return this.signDoc.accountNumber.toString()}toBytes(){return"authInfoBytes"in this.signDoc?r.SignDoc.encode(this.signDoc).finish():r.SignDocDirectAux.encode(this.signDoc).finish()}toJSON(){if("authInfoBytes"in this.signDoc)return(0,o.sortObjectByKey)({txBody:Object.assign(Object.assign({},r.TxBody.toJSON(this.txBody)),{messages:this.txMsgs.map((e=>this.protoCodec.unpackedAnyToJSONRecursive(e)))}),authInfo:r.AuthInfo.toJSON(this.authInfo),chainId:this.chainId,accountNumber:this.accountNumber});const e=r.SignDocDirectAux.toJSON(this.signDoc);return e.bodyBytes&&delete e.bodyBytes,(0,o.sortObjectByKey)(Object.assign(Object.assign({},e),{txBody:Object.assign(Object.assign({},r.TxBody.toJSON(this.txBody)),{messages:this.txMsgs.map((e=>this.protoCodec.unpackedAnyToJSONRecursive(e)))})}))}}t.ProtoSignDocDecoder=a},12408:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(17467),t),n(i(78738),t),n(i(82142),t)},82142:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignDocWrapper=void 0;const r=i(78738),n=i(12136),s=i(46855);class o{constructor(e){this.signDoc=e,this.isDirectAux=!1,"msgs"in e?this.mode="amino":(this.mode="direct",this.isDirectAux=!("authInfoBytes"in e)),"amino"===this.mode?this.isADR36SignDoc=(0,s.checkAndValidateADR36AminoSignDoc)(this.aminoSignDoc):this.isADR36SignDoc=!1}static fromAminoSignDoc(e){return new o(e)}static fromDirectSignDoc(e){return new o(e)}static fromDirectAuxSignDoc(e){return new o(e)}static fromDirectSignDocBytes(e){return new o(n.SignDoc.decode(e))}static fromDirectAuxSignDocBytes(e){return new o(n.SignDocDirectAux.decode(e))}clone(){return new o(this.signDoc)}get protoSignDoc(){if("amino"===this.mode)throw new Error("Sign doc is encoded as Amino Json");if("msgs"in this.signDoc)throw new Error("Unexpected error");return this._protoSignDoc||(this._protoSignDoc=new r.ProtoSignDocDecoder(this.signDoc)),this._protoSignDoc}get aminoSignDoc(){if("direct"===this.mode)throw new Error("Sign doc is encoded as Protobuf");if(!("msgs"in this.signDoc))throw new Error("Unexpected error");return this.signDoc}get chainId(){return"direct"===this.mode?this.protoSignDoc.chainId:this.aminoSignDoc.chain_id}get memo(){return"direct"===this.mode?this.protoSignDoc.txBody.memo:this.aminoSignDoc.memo}get fees(){var e,t;if("direct"===this.mode){const i=[];for(const r of null!==(t=null===(e=this.protoSignDoc.authInfo.fee)||void 0===e?void 0:e.amount)&&void 0!==t?t:[]){if(null==r.denom||null==r.amount)throw new Error("Invalid fee");i.push({denom:r.denom,amount:r.amount})}return i}return this.aminoSignDoc.fee.amount}get payer(){var e;return"direct"===this.mode?null===(e=this.protoSignDoc.authInfo.fee)||void 0===e?void 0:e.payer:this.aminoSignDoc.fee.payer}get granter(){var e;return"direct"===this.mode?null===(e=this.protoSignDoc.authInfo.fee)||void 0===e?void 0:e.granter:this.aminoSignDoc.fee.granter}get gas(){var e;return"direct"===this.mode?(null===(e=this.protoSignDoc.authInfo.fee)||void 0===e?void 0:e.gasLimit)?parseInt(this.protoSignDoc.authInfo.fee.gasLimit):0:parseInt(this.aminoSignDoc.fee.gas)}}t.SignDocWrapper=o},62683:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TendermintTxTracer=t.WsReadyState=void 0;const n=i(48834);var s;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED",e[e.NONE=4]="NONE"}(s=t.WsReadyState||(t.WsReadyState={})),t.TendermintTxTracer=class{constructor(e,t,i={}){this.url=e,this.wsEndpoint=t,this.options=i,this.newBlockSubscribes=[],this.txSubscribes=new Map,this.pendingQueries=new Map,this.listeners={},this.onOpen=e=>{var t;this.newBlockSubscribes.length>0&&this.sendSubscribeBlockRpc();for(const[e,t]of this.txSubscribes)this.sendSubscribeTxRpc(e,t.params);for(const[e,t]of this.pendingQueries)this.sendQueryRpc(e,t.method,t.params);for(const i of null!==(t=this.listeners.open)&&void 0!==t?t:[])i(e)},this.onMessage=e=>{var t,i,r,n,s,o;for(const i of null!==(t=this.listeners.message)&&void 0!==t?t:[])i(e);if(e.data)try{const t=JSON.parse(e.data);if((null==t?void 0:t.id)&&this.pendingQueries.has(t.id)&&(t.error?this.pendingQueries.get(t.id).rejector(new Error(t.error.data||t.error.message)):(null===(i=t.result)||void 0===i?void 0:i.tx_result)?this.pendingQueries.get(t.id).resolver(t.result.tx_result):this.pendingQueries.get(t.id).resolver(t.result),this.pendingQueries.delete(t.id)),"tendermint/event/NewBlock"===(null===(n=null===(r=null==t?void 0:t.result)||void 0===r?void 0:r.data)||void 0===n?void 0:n.type))for(const e of this.newBlockSubscribes)e.handler(t.result.data.value);"tendermint/event/Tx"===(null===(o=null===(s=null==t?void 0:t.result)||void 0===s?void 0:s.data)||void 0===o?void 0:o.type)&&(null==t?void 0:t.id)&&this.txSubscribes.has(t.id)&&(t.error?this.txSubscribes.get(t.id).rejector(new Error(t.error.data||t.error.message)):this.txSubscribes.get(t.id).resolver(t.result.data.value.TxResult.result),this.txSubscribes.delete(t.id))}catch(e){console.log(`Tendermint websocket jsonrpc response is not JSON: ${e.message||e.toString()}`)}},this.onClose=e=>{var t;for(const i of null!==(t=this.listeners.close)&&void 0!==t?t:[])i(e)},this.onError=e=>{var t;for(const i of null!==(t=this.listeners.error)&&void 0!==t?t:[])i(e);this.close()},this.ws=this.options.wsObject?new this.options.wsObject(this.getWsEndpoint()):new WebSocket(this.getWsEndpoint()),this.ws.onopen=this.onOpen,this.ws.onmessage=this.onMessage,this.ws.onclose=this.onClose,this.ws.onerror=this.onError}getWsEndpoint(){let e=this.url;if(e.startsWith("http")&&(e=e.replace("http","ws")),!e.endsWith(this.wsEndpoint)){const t=this.wsEndpoint.startsWith("/")?this.wsEndpoint:"/"+this.wsEndpoint;e=e.endsWith("/")?e+t.slice(1):e+t}return e}close(){this.ws.close()}get readyState(){switch(this.ws.readyState){case 0:return s.CONNECTING;case 1:return s.OPEN;case 2:return s.CLOSING;case 3:return s.CLOSED;default:return s.NONE}}addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}subscribeBlock(e){return this.newBlockSubscribes.push({handler:e}),1===this.newBlockSubscribes.length&&this.sendSubscribeBlockRpc(),()=>{this.newBlockSubscribes=this.newBlockSubscribes.filter((t=>t.handler!==e))}}sendSubscribeBlockRpc(){this.readyState===s.OPEN&&this.ws.send(JSON.stringify({jsonrpc:"2.0",method:"subscribe",params:["tm.event='NewBlock'"],id:1}))}traceTx(e){let t=!1;return new Promise((i=>{this.queryTx(e).then((t=>{e instanceof Uint8Array?i(t):"0"===(null==t?void 0:t.total_count)||i(t)})).catch((()=>{})),(()=>{r(this,void 0,void 0,(function*(){for(;!t&&this.readyState!==s.CLOSED&&this.readyState!==s.CLOSING;)yield new Promise((e=>setTimeout(e,1e4))),this.queryTx(e).then((t=>{e instanceof Uint8Array?i(t):"0"===(null==t?void 0:t.total_count)||i(t)})).catch((()=>{}))}))})(),this.subscribeTx(e).then(i)})).then((e=>(t=!0,new Promise((t=>{setTimeout((()=>t(e)),100)})))))}subscribeTx(e){if(e instanceof Uint8Array){const t=this.createRandomId(),i={query:`tm.event='Tx' AND tx.hash='${n.Buffer.from(e).toString("hex").toUpperCase()}'`};return new Promise(((e,r)=>{this.txSubscribes.set(t,{params:i,resolver:e,rejector:r}),this.sendSubscribeTxRpc(t,i)}))}{const t=this.createRandomId(),i={query:"tm.event='Tx' and "+Object.keys(e).map((t=>({key:t,value:e[t]}))).map((e=>`${e.key}=${"string"==typeof e.value?`'${e.value}'`:e.value}`)).join(" and "),page:"1",per_page:"1",order_by:"asc"};return new Promise(((e,r)=>{this.txSubscribes.set(t,{params:i,resolver:e,rejector:r}),this.sendSubscribeTxRpc(t,i)}))}}sendSubscribeTxRpc(e,t){this.readyState===s.OPEN&&this.ws.send(JSON.stringify({jsonrpc:"2.0",method:"subscribe",params:t,id:e}))}queryTx(e){if(e instanceof Uint8Array)return this.query("tx",{hash:n.Buffer.from(e).toString("base64"),prove:!1});{const t={query:Object.keys(e).map((t=>({key:t,value:e[t]}))).map((e=>`${e.key}=${"string"==typeof e.value?`'${e.value}'`:e.value}`)).join(" and "),page:"1",per_page:"1",order_by:"asc"};return this.query("tx_search",t)}}query(e,t){const i=this.createRandomId();return new Promise(((r,n)=>{this.pendingQueries.set(i,{method:e,params:t,resolver:r,rejector:n}),this.sendQueryRpc(i,e,t)}))}sendQueryRpc(e,t,i){this.readyState===s.OPEN&&this.ws.send(JSON.stringify({jsonrpc:"2.0",method:t,params:i,id:e}))}createRandomId(){return parseInt(Array.from({length:6}).map((()=>Math.floor(100*Math.random()))).join(""))}}},99687:(e,t,i)=>{"use strict";i.r(t),i.d(t,{getAddress:()=>W,getContractAddress:()=>X,getCreate2Address:()=>Y,getIcapAddress:()=>J,isAddress:()=>z});let r=!1,n=!1;const s={debug:1,default:2,info:2,warning:3,error:4,off:5};let o=s.default,a=null;const c=function(){try{const e=[];if(["NFD","NFC","NFKD","NFKC"].forEach((t=>{try{if("test"!=="test".normalize(t))throw new Error("bad normalize")}catch(i){e.push(t)}})),e.length)throw new Error("missing "+e.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(e){return e.message}return null}();var u,d;!function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR",e.OFF="OFF"}(u||(u={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.NOT_IMPLEMENTED="NOT_IMPLEMENTED",e.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.TIMEOUT="TIMEOUT",e.BUFFER_OVERRUN="BUFFER_OVERRUN",e.NUMERIC_FAULT="NUMERIC_FAULT",e.MISSING_NEW="MISSING_NEW",e.INVALID_ARGUMENT="INVALID_ARGUMENT",e.MISSING_ARGUMENT="MISSING_ARGUMENT",e.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",e.CALL_EXCEPTION="CALL_EXCEPTION",e.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",e.NONCE_EXPIRED="NONCE_EXPIRED",e.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",e.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",e.TRANSACTION_REPLACED="TRANSACTION_REPLACED"}(d||(d={}));const l="0123456789abcdef";class h{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const i=e.toLowerCase();null==s[i]&&this.throwArgumentError("invalid log level name","logLevel",e),o>s[i]||console.log.apply(console,t)}debug(...e){this._log(h.levels.DEBUG,e)}info(...e){this._log(h.levels.INFO,e)}warn(...e){this._log(h.levels.WARNING,e)}makeError(e,t,i){if(n)return this.makeError("censored error",t,{});t||(t=h.errors.UNKNOWN_ERROR),i||(i={});const r=[];Object.keys(i).forEach((e=>{const t=i[e];try{if(t instanceof Uint8Array){let i="";for(let e=0;e<t.length;e++)i+=l[t[e]>>4],i+=l[15&t[e]];r.push(e+"=Uint8Array(0x"+i+")")}else r.push(e+"="+JSON.stringify(t))}catch(t){r.push(e+"="+JSON.stringify(i[e].toString()))}})),r.push(`code=${t}`),r.push(`version=${this.version}`);const s=e;let o="";switch(t){case d.NUMERIC_FAULT:{o="NUMERIC_FAULT";const t=e;switch(t){case"overflow":case"underflow":case"division-by-zero":o+="-"+t;break;case"negative-power":case"negative-width":o+="-unsupported";break;case"unbound-bitwise-result":o+="-unbound-result"}break}case d.CALL_EXCEPTION:case d.INSUFFICIENT_FUNDS:case d.MISSING_NEW:case d.NONCE_EXPIRED:case d.REPLACEMENT_UNDERPRICED:case d.TRANSACTION_REPLACED:case d.UNPREDICTABLE_GAS_LIMIT:o=t}o&&(e+=" [ See: https://links.ethers.org/v5-errors-"+o+" ]"),r.length&&(e+=" ("+r.join(", ")+")");const a=new Error(e);return a.reason=s,a.code=t,Object.keys(i).forEach((function(e){a[e]=i[e]})),a}throwError(e,t,i){throw this.makeError(e,t,i)}throwArgumentError(e,t,i){return this.throwError(e,h.errors.INVALID_ARGUMENT,{argument:t,value:i})}assert(e,t,i,r){e||this.throwError(t,i,r)}assertArgument(e,t,i,r){e||this.throwArgumentError(t,i,r)}checkNormalize(e){null==e&&(e="platform missing String.prototype.normalize"),c&&this.throwError("platform missing String.prototype.normalize",h.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:c})}checkSafeUint53(e,t){"number"==typeof e&&(null==t&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,h.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,h.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,i){i=i?": "+i:"",e<t&&this.throwError("missing argument"+i,h.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+i,h.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){e!==Object&&null!=e||this.throwError("missing new",h.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",h.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):e!==Object&&null!=e||this.throwError("missing new",h.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return a||(a=new h("logger/5.6.0")),a}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",h.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),r){if(!e)return;this.globalLogger().throwError("error censorship permanent",h.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}n=!!e,r=!!t}static setLogLevel(e){const t=s[e.toLowerCase()];null!=t?o=t:h.globalLogger().warn("invalid log level - "+e)}static from(e){return new h(e)}}h.errors=d,h.levels=u;const g=new h("bytes/5.6.1");function f(e){return!!e.toHexString}function p(e){return e.slice||(e.slice=function(){const t=Array.prototype.slice.call(arguments);return p(new Uint8Array(Array.prototype.slice.apply(e,t)))}),e}function y(e){return"number"==typeof e&&e==e&&e%1==0}function v(e){if(null==e)return!1;if(e.constructor===Uint8Array)return!0;if("string"==typeof e)return!1;if(!y(e.length)||e.length<0)return!1;for(let t=0;t<e.length;t++){const i=e[t];if(!y(i)||i<0||i>=256)return!1}return!0}function m(e,t){if(t||(t={}),"number"==typeof e){g.checkSafeUint53(e,"invalid arrayify value");const t=[];for(;e;)t.unshift(255&e),e=parseInt(String(e/256));return 0===t.length&&t.push(0),p(new Uint8Array(t))}if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),f(e)&&(e=e.toHexString()),w(e)){let i=e.substring(2);i.length%2&&("left"===t.hexPad?i="0"+i:"right"===t.hexPad?i+="0":g.throwArgumentError("hex data is odd-length","value",e));const r=[];for(let e=0;e<i.length;e+=2)r.push(parseInt(i.substring(e,e+2),16));return p(new Uint8Array(r))}return v(e)?p(new Uint8Array(e)):g.throwArgumentError("invalid arrayify value","value",e)}function w(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/)||t&&e.length!==2+2*t)}const b="0123456789abcdef";function I(e,t){if(t||(t={}),"number"==typeof e){g.checkSafeUint53(e,"invalid hexlify value");let t="";for(;e;)t=b[15&e]+t,e=Math.floor(e/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if("bigint"==typeof e)return(e=e.toString(16)).length%2?"0x0"+e:"0x"+e;if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),f(e))return e.toHexString();if(w(e))return e.length%2&&("left"===t.hexPad?e="0x0"+e.substring(2):"right"===t.hexPad?e+="0":g.throwArgumentError("hex data is odd-length","value",e)),e.toLowerCase();if(v(e)){let t="0x";for(let i=0;i<e.length;i++){let r=e[i];t+=b[(240&r)>>4]+b[15&r]}return t}return g.throwArgumentError("invalid hexlify value","value",e)}function S(e){if("string"!=typeof e)e=I(e);else if(!w(e)||e.length%2)return null;return(e.length-2)/2}function M(e,t,i){return"string"!=typeof e?e=I(e):(!w(e)||e.length%2)&&g.throwArgumentError("invalid hexData","value",e),t=2+2*t,null!=i?"0x"+e.substring(t,2+2*i):"0x"+e.substring(t)}var k=i(62197),_=i.n(k)().BN;const O=new h("bignumber/5.6.0"),E={},C=9007199254740991;let P=!1;class R{constructor(e,t){O.checkNew(new.target,R),e!==E&&O.throwError("cannot call constructor directly; use BigNumber.from",h.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return x(T(this).fromTwos(e))}toTwos(e){return x(T(this).toTwos(e))}abs(){return"-"===this._hex[0]?R.from(this._hex.substring(1)):this}add(e){return x(T(this).add(T(e)))}sub(e){return x(T(this).sub(T(e)))}div(e){return R.from(e).isZero()&&j("division-by-zero","div"),x(T(this).div(T(e)))}mul(e){return x(T(this).mul(T(e)))}mod(e){const t=T(e);return t.isNeg()&&j("division-by-zero","mod"),x(T(this).umod(t))}pow(e){const t=T(e);return t.isNeg()&&j("negative-power","pow"),x(T(this).pow(t))}and(e){const t=T(e);return(this.isNegative()||t.isNeg())&&j("unbound-bitwise-result","and"),x(T(this).and(t))}or(e){const t=T(e);return(this.isNegative()||t.isNeg())&&j("unbound-bitwise-result","or"),x(T(this).or(t))}xor(e){const t=T(e);return(this.isNegative()||t.isNeg())&&j("unbound-bitwise-result","xor"),x(T(this).xor(t))}mask(e){return(this.isNegative()||e<0)&&j("negative-width","mask"),x(T(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&j("negative-width","shl"),x(T(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&j("negative-width","shr"),x(T(this).shrn(e))}eq(e){return T(this).eq(T(e))}lt(e){return T(this).lt(T(e))}lte(e){return T(this).lte(T(e))}gt(e){return T(this).gt(T(e))}gte(e){return T(this).gte(T(e))}isNegative(){return"-"===this._hex[0]}isZero(){return T(this).isZero()}toNumber(){try{return T(this).toNumber()}catch(e){j("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch(e){}return O.throwError("this platform does not support BigInt",h.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(10===arguments[0]?P||(P=!0,O.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):16===arguments[0]?O.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",h.errors.UNEXPECTED_ARGUMENT,{}):O.throwError("BigNumber.toString does not accept parameters",h.errors.UNEXPECTED_ARGUMENT,{})),T(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof R)return e;if("string"==typeof e)return e.match(/^-?0x[0-9a-f]+$/i)?new R(E,A(e)):e.match(/^-?[0-9]+$/)?new R(E,A(new _(e))):O.throwArgumentError("invalid BigNumber string","value",e);if("number"==typeof e)return e%1&&j("underflow","BigNumber.from",e),(e>=C||e<=-C)&&j("overflow","BigNumber.from",e),R.from(String(e));const t=e;if("bigint"==typeof t)return R.from(t.toString());if(v(t))return R.from(I(t));if(t)if(t.toHexString){const e=t.toHexString();if("string"==typeof e)return R.from(e)}else{let e=t._hex;if(null==e&&"BigNumber"===t.type&&(e=t.hex),"string"==typeof e&&(w(e)||"-"===e[0]&&w(e.substring(1))))return R.from(e)}return O.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!(!e||!e._isBigNumber)}}function A(e){if("string"!=typeof e)return A(e.toString(16));if("-"===e[0])return"-"===(e=e.substring(1))[0]&&O.throwArgumentError("invalid hex","value",e),"0x00"===(e=A(e))?e:"-"+e;if("0x"!==e.substring(0,2)&&(e="0x"+e),"0x"===e)return"0x00";for(e.length%2&&(e="0x0"+e.substring(2));e.length>4&&"0x00"===e.substring(0,4);)e="0x"+e.substring(4);return e}function x(e){return R.from(A(e))}function T(e){const t=R.from(e).toHexString();return"-"===t[0]?new _("-"+t.substring(3),16):new _(t.substring(2),16)}function j(e,t,i){const r={fault:e,operation:t};return null!=i&&(r.value=i),O.throwError(e,h.errors.NUMERIC_FAULT,r)}var B=i(83669),K=i.n(B);function D(e){return"0x"+K().keccak_256(m(e))}const U=new h("rlp/5.6.0");function N(e){const t=[];for(;e;)t.unshift(255&e),e>>=8;return t}function H(e){if(Array.isArray(e)){let t=[];if(e.forEach((function(e){t=t.concat(H(e))})),t.length<=55)return t.unshift(192+t.length),t;const i=N(t.length);return i.unshift(247+i.length),i.concat(t)}var t;w(t=e)&&!(t.length%2)||v(t)||U.throwArgumentError("RLP object must be BytesLike","object",e);const i=Array.prototype.slice.call(m(e));if(1===i.length&&i[0]<=127)return i;if(i.length<=55)return i.unshift(128+i.length),i;const r=N(i.length);return r.unshift(183+r.length),r.concat(i)}const V=new h("address/5.6.0");function F(e){w(e,20)||V.throwArgumentError("invalid address","address",e);const t=(e=e.toLowerCase()).substring(2).split(""),i=new Uint8Array(40);for(let e=0;e<40;e++)i[e]=t[e].charCodeAt(0);const r=m(D(i));for(let e=0;e<40;e+=2)r[e>>1]>>4>=8&&(t[e]=t[e].toUpperCase()),(15&r[e>>1])>=8&&(t[e+1]=t[e+1].toUpperCase());return"0x"+t.join("")}const L={};for(let e=0;e<10;e++)L[String(e)]=String(e);for(let e=0;e<26;e++)L[String.fromCharCode(65+e)]=String(10+e);const q=Math.floor((G=9007199254740991,Math.log10?Math.log10(G):Math.log(G)/Math.LN10));var G;function $(e){let t=(e=(e=e.toUpperCase()).substring(4)+e.substring(0,2)+"00").split("").map((e=>L[e])).join("");for(;t.length>=q;){let e=t.substring(0,q);t=parseInt(e,10)%97+t.substring(e.length)}let i=String(98-parseInt(t,10)%97);for(;i.length<2;)i="0"+i;return i}function W(e){let t=null;if("string"!=typeof e&&V.throwArgumentError("invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/))"0x"!==e.substring(0,2)&&(e="0x"+e),t=F(e),e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&t!==e&&V.throwArgumentError("bad address checksum","address",e);else if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(e.substring(2,4)!==$(e)&&V.throwArgumentError("bad icap checksum","address",e),i=e.substring(4),t=new _(i,36).toString(16);t.length<40;)t="0"+t;t=F("0x"+t)}else V.throwArgumentError("invalid address","address",e);var i;return t}function z(e){try{return W(e),!0}catch(e){}return!1}function J(e){let t=(i=W(e).substring(2),new _(i,16).toString(36)).toUpperCase();for(var i;t.length<30;)t="0"+t;return"XE"+$("XE00"+t)+t}function X(e){let t=null;try{t=W(e.from)}catch(t){V.throwArgumentError("missing from address","transaction",e)}return W(M(D(I(H([t,function(e){let t=m(e);if(0===t.length)return t;let i=0;for(;i<t.length&&0===t[i];)i++;return i&&(t=t.slice(i)),t}(m(R.from(e.nonce).toHexString()))]))),12))}function Y(e,t,i){return 32!==S(t)&&V.throwArgumentError("salt must be 32 bytes","salt",t),32!==S(i)&&V.throwArgumentError("initCodeHash must be 32 bytes","initCodeHash",i),W(M(D(function(e){const t=e.map((e=>m(e))),i=t.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(i);return t.reduce(((e,t)=>(r.set(t,e),e+t.length)),0),p(r)}(["0xff",W(e),t,i])),12))}},24192:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hash=void 0;const r=i(9065),n=i(94509),s=i(48834);t.Hash=class{static sha256(e){return new Uint8Array((new r.sha256).update(e).digest())}static keccak256(e){return s.Buffer.from((0,n.keccak256)(e).replace("0x",""),"hex")}static truncHashPortion(e,t=e.length,i=0){return e.substring(0,t)+""+e.substring(e.length-i,e.length)}}},81204:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(97038),t),n(i(38602),t),n(i(24192),t)},38602:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PubKeySecp256k1=t.PrivKeySecp256k1=void 0;const n=i(87554),s=r(i(36023)),o=i(48834),a=i(24192);class c{static generateRandomKey(){const e=new n.ec("secp256k1");return new c(o.Buffer.from(e.genKeyPair().getPrivate().toArray()))}constructor(e){this.privKey=e}toBytes(){return new Uint8Array(this.privKey)}getPubKey(){const e=new n.ec("secp256k1").keyFromPrivate(this.privKey);return new u(new Uint8Array(e.getPublic().encodeCompressed("array")))}signDigest32(e){if(32!==e.length)throw new Error(`Invalid length of digest to sign: ${e.length}`);const t=new n.ec("secp256k1").keyFromPrivate(this.privKey).sign(e,{canonical:!0});return{r:new Uint8Array(t.r.toArray("be",32)),s:new Uint8Array(t.s.toArray("be",32)),v:t.recoveryParam}}}t.PrivKeySecp256k1=c;class u{constructor(e){if(this.pubKey=e,33!==e.length&&65!==e.length)throw new Error(`Invalid length of public key: ${e.length}`)}toBytes(e){if(e&&65===this.pubKey.length)return this.pubKey;if(!e&&33===this.pubKey.length)return this.pubKey;const t=this.toKeyPair();return e?new Uint8Array(o.Buffer.from(t.getPublic().encode("hex",!1),"hex")):new Uint8Array(o.Buffer.from(t.getPublic().encodeCompressed("hex"),"hex"))}getAddress(){return this.getCosmosAddress()}getCosmosAddress(){let e=s.default.SHA256(s.default.lib.WordArray.create(this.toBytes(!1))).toString();return e=s.default.RIPEMD160(s.default.enc.Hex.parse(e)).toString(),new Uint8Array(o.Buffer.from(e,"hex"))}getEthAddress(){return a.Hash.keccak256(this.toBytes(!0).slice(1)).slice(-20)}toKeyPair(){return new n.ec("secp256k1").keyFromPublic(o.Buffer.from(this.pubKey).toString("hex"),"hex")}verifyDigest32(e,t){if(32!==e.length)throw new Error(`Invalid length of digest to verify: ${e.length}`);if(64!==t.length)throw new Error(`Invalid length of signature: ${t.length}`);const i=new n.ec("secp256k1"),r=t.slice(0,32),s=t.slice(32);return i.verify(e,{r:o.Buffer.from(r).toString("hex"),s:o.Buffer.from(s).toString("hex")},this.toKeyPair())}}t.PubKeySecp256k1=u},97038:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Mnemonic=void 0;const n=i(36832),s=i(14132),o=i(44075),a=i(48834);class c{static generateWallet(e,t="m/44'/118'/0'/0/0",i="",n=256){return r(this,void 0,void 0,(function*(){const r=yield c.generateSeed(e,n);return{privKey:c.generateWalletFromMnemonic(r,t,i),mnemonic:r}}))}static validateMnemonic(e){return n.validateMnemonic(e)}static generateSeed(e,t=128){return r(this,void 0,void 0,(function*(){if(t%32!=0)throw new TypeError("invalid entropy");let i=new Uint8Array(t/8);return i=yield e(i),n.entropyToMnemonic(a.Buffer.from(i).toString("hex"))}))}static generateWalletFromMnemonic(e,t="m/44'/118'/0'/0/0",i=""){const r=n.mnemonicToSeedSync(e,i),o=s.fromSeed(r).derivePath(t).privateKey;if(!o)throw new Error("null hd key");return o}static generateMasterSeedFromMnemonic(e,t=""){const i=n.mnemonicToSeedSync(e,t),r=s.fromSeed(i);return a.Buffer.from(o.decode(r.toBase58()))}static generatePrivateKeyFromMasterSeed(e,t="m/44'/118'/0'/0/0"){const i=s.fromBase58(o.encode(e)).derivePath(t).privateKey;if(!i)throw new Error("null hd key");return i}}t.Mnemonic=c},29005:()=>{},45179:()=>{}}]);